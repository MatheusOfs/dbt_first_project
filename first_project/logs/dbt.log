

============================== 2022-06-07 15:21:49.813272 | ebed2130-d19d-45c5-9e46-df39cf093613 ==============================
15:21:49.813280 [info ] [MainThread]: Running with dbt=1.1.0
15:21:49.813576 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
15:21:49.813662 [debug] [MainThread]: Tracking: tracking
15:21:49.817653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a6ad45b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a6ad49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a6ad4790>]}
15:21:49.860603 [debug] [MainThread]: Executing "git --help"
15:21:49.867392 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
15:21:49.867686 [debug] [MainThread]: STDERR: "b''"
15:21:49.870442 [debug] [MainThread]: Acquiring new postgres connection "debug"
15:21:49.870838 [debug] [MainThread]: Using postgres connection "debug"
15:21:49.870916 [debug] [MainThread]: On debug: select 1 as id
15:21:49.870976 [debug] [MainThread]: Opening a new connection, currently in state init
15:21:49.903627 [debug] [MainThread]: SQL status: SELECT 1 in 0.03 seconds
15:21:49.904591 [debug] [MainThread]: On debug: Close
15:21:49.904921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a525a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a5243df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13a52433d0>]}
15:21:50.867189 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-07 15:23:29.586333 | 53016816-5a5e-4be8-816a-639ae01ddbfd ==============================
15:23:29.586428 [info ] [MainThread]: Running with dbt=1.1.0
15:23:29.587177 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:23:29.587377 [debug] [MainThread]: Tracking: tracking
15:23:29.597037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932a320670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932a320520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932a320190>]}
15:23:29.605995 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
15:23:29.606213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '53016816-5a5e-4be8-816a-639ae01ddbfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932a320100>]}
15:23:29.635564 [debug] [MainThread]: Parsing macros/catalog.sql
15:23:29.637927 [debug] [MainThread]: Parsing macros/relations.sql
15:23:29.638703 [debug] [MainThread]: Parsing macros/adapters.sql
15:23:29.650931 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
15:23:29.651928 [debug] [MainThread]: Parsing macros/materializations/configs.sql
15:23:29.653286 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
15:23:29.655385 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
15:23:29.660919 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
15:23:29.669407 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
15:23:29.678387 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
15:23:29.681019 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
15:23:29.681903 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
15:23:29.682636 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
15:23:29.684001 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
15:23:29.685558 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
15:23:29.689519 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
15:23:29.693648 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
15:23:29.695293 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
15:23:29.704644 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
15:23:29.708050 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
15:23:29.709067 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
15:23:29.711578 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
15:23:29.712613 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
15:23:29.719677 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
15:23:29.729045 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
15:23:29.735200 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
15:23:29.736266 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
15:23:29.737714 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
15:23:29.738592 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
15:23:29.739419 [debug] [MainThread]: Parsing macros/adapters/columns.sql
15:23:29.744916 [debug] [MainThread]: Parsing macros/adapters/relation.sql
15:23:29.750162 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
15:23:29.751793 [debug] [MainThread]: Parsing macros/adapters/schema.sql
15:23:29.753175 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
15:23:29.754695 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
15:23:29.758650 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
15:23:29.761155 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
15:23:29.761662 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
15:23:29.762187 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
15:23:29.762628 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
15:23:29.763432 [debug] [MainThread]: Parsing macros/etc/datetime.sql
15:23:29.768083 [debug] [MainThread]: Parsing macros/etc/statement.sql
15:23:29.770651 [debug] [MainThread]: Parsing tests/generic/builtin.sql
15:23:29.893026 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
15:23:29.900147 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
15:23:29.927541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53016816-5a5e-4be8-816a-639ae01ddbfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932c16c340>]}
15:23:29.930509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53016816-5a5e-4be8-816a-639ae01ddbfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932a1ea280>]}
15:23:29.930780 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:23:29.930973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53016816-5a5e-4be8-816a-639ae01ddbfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932edbb7f0>]}
15:23:29.931826 [info ] [MainThread]: 
15:23:29.932198 [debug] [MainThread]: Acquiring new postgres connection "master"
15:23:29.933281 [debug] [ThreadPool]: Acquiring new postgres connection "list_first_project"
15:23:29.939271 [debug] [ThreadPool]: Using postgres connection "list_first_project"
15:23:29.939464 [debug] [ThreadPool]: On list_first_project: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_first_project"} */

    select distinct nspname from pg_namespace
  
15:23:29.939562 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:23:29.949695 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
15:23:29.950677 [debug] [ThreadPool]: On list_first_project: Close
15:23:29.957210 [debug] [ThreadPool]: Acquiring new postgres connection "list_first_project_public"
15:23:29.966871 [debug] [ThreadPool]: Using postgres connection "list_first_project_public"
15:23:29.968066 [debug] [ThreadPool]: On list_first_project_public: BEGIN
15:23:29.968284 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:23:29.973915 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:23:29.974127 [debug] [ThreadPool]: Using postgres connection "list_first_project_public"
15:23:29.974201 [debug] [ThreadPool]: On list_first_project_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_first_project_public"} */
select
      'first_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'first_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:23:29.975478 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
15:23:29.976280 [debug] [ThreadPool]: On list_first_project_public: ROLLBACK
15:23:29.976491 [debug] [ThreadPool]: On list_first_project_public: Close
15:23:29.979385 [debug] [MainThread]: Using postgres connection "master"
15:23:29.979801 [debug] [MainThread]: On master: BEGIN
15:23:29.979929 [debug] [MainThread]: Opening a new connection, currently in state init
15:23:29.983989 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:23:29.984163 [debug] [MainThread]: Using postgres connection "master"
15:23:29.984230 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:23:29.991432 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
15:23:29.992280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53016816-5a5e-4be8-816a-639ae01ddbfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932a291e50>]}
15:23:29.992489 [debug] [MainThread]: On master: ROLLBACK
15:23:29.992658 [debug] [MainThread]: Using postgres connection "master"
15:23:29.992731 [debug] [MainThread]: On master: BEGIN
15:23:29.992879 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:23:29.992955 [debug] [MainThread]: On master: COMMIT
15:23:29.993012 [debug] [MainThread]: Using postgres connection "master"
15:23:29.993119 [debug] [MainThread]: On master: COMMIT
15:23:29.993242 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:23:29.993324 [debug] [MainThread]: On master: Close
15:23:29.993608 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
15:23:29.993755 [info ] [MainThread]: 
15:23:29.998376 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
15:23:29.998640 [info ] [Thread-1  ]: 1 of 2 START table model public.my_first_dbt_model ............................. [RUN]
15:23:29.998946 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
15:23:29.999041 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
15:23:29.999115 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
15:23:30.000570 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
15:23:30.000818 [debug] [Thread-1  ]: finished collecting timing info
15:23:30.000903 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
15:23:30.027089 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
15:23:30.027450 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:23:30.027550 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
15:23:30.027608 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:23:30.040828 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:23:30.041307 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:23:30.041441 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "first_project"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:23:30.048784 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
15:23:30.053458 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:23:30.053617 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "first_project"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:23:30.054201 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:23:30.055528 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:23:30.061953 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "first_project"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:23:30.063032 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:23:30.069851 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
15:23:30.070026 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:23:30.070094 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
15:23:30.071309 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:23:30.074638 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:23:30.074758 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "first_project"."public"."my_first_dbt_model__dbt_backup" cascade
15:23:30.078715 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:23:30.079899 [debug] [Thread-1  ]: finished collecting timing info
15:23:30.080075 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
15:23:30.082060 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53016816-5a5e-4be8-816a-639ae01ddbfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93284e3160>]}
15:23:30.082417 [info ] [Thread-1  ]: 1 of 2 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
15:23:30.082690 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
15:23:30.083064 [debug] [Thread-3  ]: Began running node model.first_project.my_second_dbt_model
15:23:30.083255 [info ] [Thread-3  ]: 2 of 2 START view model public.my_second_dbt_model ............................. [RUN]
15:23:30.083515 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
15:23:30.083587 [debug] [Thread-3  ]: Began compiling node model.first_project.my_second_dbt_model
15:23:30.083654 [debug] [Thread-3  ]: Compiling model.first_project.my_second_dbt_model
15:23:30.085220 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
15:23:30.085422 [debug] [Thread-3  ]: finished collecting timing info
15:23:30.085501 [debug] [Thread-3  ]: Began executing node model.first_project.my_second_dbt_model
15:23:30.095674 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
15:23:30.096069 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:23:30.096155 [debug] [Thread-3  ]: On model.first_project.my_second_dbt_model: BEGIN
15:23:30.096239 [debug] [Thread-3  ]: Opening a new connection, currently in state init
15:23:30.107019 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
15:23:30.107250 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:23:30.107346 [debug] [Thread-3  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "first_project"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "first_project"."public"."my_first_dbt_model"
where id = 1
  );
15:23:30.111783 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
15:23:30.118362 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:23:30.118530 [debug] [Thread-3  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "first_project"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:23:30.118967 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
15:23:30.119806 [debug] [Thread-3  ]: On model.first_project.my_second_dbt_model: COMMIT
15:23:30.119886 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:23:30.119959 [debug] [Thread-3  ]: On model.first_project.my_second_dbt_model: COMMIT
15:23:30.121602 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
15:23:30.122733 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:23:30.122829 [debug] [Thread-3  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "first_project"."public"."my_second_dbt_model__dbt_backup" cascade
15:23:30.123082 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
15:23:30.123859 [debug] [Thread-3  ]: finished collecting timing info
15:23:30.123991 [debug] [Thread-3  ]: On model.first_project.my_second_dbt_model: Close
15:23:30.125429 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53016816-5a5e-4be8-816a-639ae01ddbfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9328540fa0>]}
15:23:30.125651 [info ] [Thread-3  ]: 2 of 2 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
15:23:30.125893 [debug] [Thread-3  ]: Finished running node model.first_project.my_second_dbt_model
15:23:30.127222 [debug] [MainThread]: Acquiring new postgres connection "master"
15:23:30.127354 [debug] [MainThread]: Using postgres connection "master"
15:23:30.127424 [debug] [MainThread]: On master: BEGIN
15:23:30.127477 [debug] [MainThread]: Opening a new connection, currently in state closed
15:23:30.131785 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:23:30.131980 [debug] [MainThread]: On master: COMMIT
15:23:30.132045 [debug] [MainThread]: Using postgres connection "master"
15:23:30.132104 [debug] [MainThread]: On master: COMMIT
15:23:30.133150 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:23:30.133326 [debug] [MainThread]: On master: Close
15:23:30.133629 [info ] [MainThread]: 
15:23:30.133781 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0.20s.
15:23:30.133906 [debug] [MainThread]: Connection 'master' was properly closed.
15:23:30.133960 [debug] [MainThread]: Connection 'list_first_project' was properly closed.
15:23:30.134007 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
15:23:30.134053 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
15:23:30.136660 [info ] [MainThread]: 
15:23:30.136829 [info ] [MainThread]: [32mCompleted successfully[0m
15:23:30.136998 [info ] [MainThread]: 
15:23:30.137158 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
15:23:30.137394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932edbbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f932a312460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9329db6f10>]}


============================== 2022-06-07 15:28:02.237578 | 57a9e41d-a611-49e9-9df7-b6c95150e972 ==============================
15:28:02.237593 [info ] [MainThread]: Running with dbt=1.1.0
15:28:02.238010 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:28:02.238119 [debug] [MainThread]: Tracking: tracking
15:28:02.240575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba1c679a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba1c67d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba1c672e0>]}
15:28:02.259130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
15:28:02.259428 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/customers.sql
15:28:02.271636 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
15:28:02.291032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57a9e41d-a611-49e9-9df7-b6c95150e972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba16b70d0>]}
15:28:02.294387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57a9e41d-a611-49e9-9df7-b6c95150e972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba1b45e20>]}
15:28:02.294644 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:28:02.295174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57a9e41d-a611-49e9-9df7-b6c95150e972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba1b45dc0>]}
15:28:02.297188 [info ] [MainThread]: 
15:28:02.297626 [debug] [MainThread]: Acquiring new postgres connection "master"
15:28:02.298292 [debug] [ThreadPool]: Acquiring new postgres connection "list_first_project"
15:28:02.306722 [debug] [ThreadPool]: Using postgres connection "list_first_project"
15:28:02.306918 [debug] [ThreadPool]: On list_first_project: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_first_project"} */

    select distinct nspname from pg_namespace
  
15:28:02.306993 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:28:02.317832 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
15:28:02.318929 [debug] [ThreadPool]: On list_first_project: Close
15:28:02.320242 [debug] [ThreadPool]: Acquiring new postgres connection "list_first_project_public"
15:28:02.326018 [debug] [ThreadPool]: Using postgres connection "list_first_project_public"
15:28:02.326204 [debug] [ThreadPool]: On list_first_project_public: BEGIN
15:28:02.326283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:28:02.331819 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:28:02.332015 [debug] [ThreadPool]: Using postgres connection "list_first_project_public"
15:28:02.333269 [debug] [ThreadPool]: On list_first_project_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_first_project_public"} */
select
      'first_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'first_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:28:02.340265 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
15:28:02.341517 [debug] [ThreadPool]: On list_first_project_public: ROLLBACK
15:28:02.341872 [debug] [ThreadPool]: On list_first_project_public: Close
15:28:02.344962 [debug] [MainThread]: Using postgres connection "master"
15:28:02.345230 [debug] [MainThread]: On master: BEGIN
15:28:02.345311 [debug] [MainThread]: Opening a new connection, currently in state init
15:28:02.373333 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
15:28:02.373546 [debug] [MainThread]: Using postgres connection "master"
15:28:02.373616 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:28:02.377394 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
15:28:02.378253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57a9e41d-a611-49e9-9df7-b6c95150e972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba3e2e790>]}
15:28:02.378478 [debug] [MainThread]: On master: ROLLBACK
15:28:02.378646 [debug] [MainThread]: Using postgres connection "master"
15:28:02.378723 [debug] [MainThread]: On master: BEGIN
15:28:02.378887 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:28:02.378965 [debug] [MainThread]: On master: COMMIT
15:28:02.379023 [debug] [MainThread]: Using postgres connection "master"
15:28:02.379075 [debug] [MainThread]: On master: COMMIT
15:28:02.379179 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:28:02.379270 [debug] [MainThread]: On master: Close
15:28:02.379547 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
15:28:02.379761 [info ] [MainThread]: 
15:28:02.384033 [debug] [Thread-1  ]: Began running node model.first_project.customers
15:28:02.384361 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
15:28:02.384658 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
15:28:02.384750 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
15:28:02.384834 [debug] [Thread-1  ]: Compiling model.first_project.customers
15:28:02.385629 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
15:28:02.385775 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
15:28:02.386029 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
15:28:02.386416 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
15:28:02.386778 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
15:28:02.386911 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
15:28:02.387011 [debug] [Thread-1  ]: finished collecting timing info
15:28:02.388351 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
15:28:02.388487 [debug] [Thread-1  ]: Began executing node model.first_project.customers
15:28:02.399193 [debug] [Thread-2  ]: finished collecting timing info
15:28:02.399399 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
15:28:02.425715 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
15:28:02.420979 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
15:28:02.426231 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:28:02.426471 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
15:28:02.426545 [debug] [Thread-2  ]: Opening a new connection, currently in state init
15:28:02.427434 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:28:02.427534 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
15:28:02.427598 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:28:02.433416 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
15:28:02.433614 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:28:02.433686 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "first_project"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:28:02.434406 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:28:02.434568 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:28:02.434643 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "first_project"."public"."customers__dbt_tmp" as (
    with customers as (
 select
 codigo_cliente as customer_id,
 nome as first_name,
 sobrenome as last_name
 from erp_oltp.public.clientes
)
select * from customers
  );
15:28:02.434837 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
15:28:02.439797 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:28:02.440093 [debug] [Thread-1  ]: Postgres adapter: Postgres error: cross-database references are not implemented: "erp_oltp.public.clientes"
LINE 9:  from erp_oltp.public.clientes
              ^

15:28:02.440224 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "first_project"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:28:02.440370 [debug] [Thread-1  ]: On model.first_project.customers: ROLLBACK
15:28:02.441382 [debug] [Thread-1  ]: finished collecting timing info
15:28:02.441489 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
15:28:02.441625 [debug] [Thread-1  ]: On model.first_project.customers: Close
15:28:02.443095 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:28:02.443274 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "first_project"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:28:02.443495 [debug] [Thread-1  ]: Database Error in model customers (models/erp/customers.sql)
  cross-database references are not implemented: "erp_oltp.public.clientes"
  LINE 9:  from erp_oltp.public.clientes
                ^
  compiled SQL at target/run/first_project/models/erp/customers.sql
15:28:02.444915 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
15:28:02.445141 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a9e41d-a611-49e9-9df7-b6c95150e972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba34803d0>]}
15:28:02.451795 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
15:28:02.453052 [error] [Thread-1  ]: 1 of 3 ERROR creating view model public.customers .............................. [[31mERROR[0m in 0.06s]
15:28:02.453265 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:28:02.453514 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
15:28:02.453727 [debug] [Thread-1  ]: Finished running node model.first_project.customers
15:28:02.454534 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
15:28:02.457705 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:28:02.457858 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "first_project"."public"."my_first_dbt_model__dbt_backup" cascade
15:28:02.459902 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
15:28:02.460770 [debug] [Thread-2  ]: finished collecting timing info
15:28:02.460907 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
15:28:02.461345 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a9e41d-a611-49e9-9df7-b6c95150e972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba1639640>]}
15:28:02.461595 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
15:28:02.461854 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
15:28:02.463175 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
15:28:02.463331 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
15:28:02.463588 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
15:28:02.463665 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
15:28:02.463728 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
15:28:02.465646 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
15:28:02.465981 [debug] [Thread-4  ]: finished collecting timing info
15:28:02.466598 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
15:28:02.468092 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
15:28:02.468411 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:28:02.468497 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
15:28:02.468558 [debug] [Thread-4  ]: Opening a new connection, currently in state init
15:28:02.475460 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
15:28:02.475734 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:28:02.475816 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "first_project"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "first_project"."public"."my_first_dbt_model"
where id = 1
  );
15:28:02.476747 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
15:28:02.478264 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:28:02.478369 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "first_project"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:28:02.478761 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
15:28:02.479611 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
15:28:02.479704 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:28:02.479764 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
15:28:02.480791 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
15:28:02.482072 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:28:02.484456 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "first_project"."public"."my_second_dbt_model__dbt_backup" cascade
15:28:02.484881 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
15:28:02.485978 [debug] [Thread-4  ]: finished collecting timing info
15:28:02.486176 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
15:28:02.492205 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a9e41d-a611-49e9-9df7-b6c95150e972', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba1c59550>]}
15:28:02.492556 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
15:28:02.493408 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
15:28:02.495938 [debug] [MainThread]: Acquiring new postgres connection "master"
15:28:02.496089 [debug] [MainThread]: Using postgres connection "master"
15:28:02.496168 [debug] [MainThread]: On master: BEGIN
15:28:02.496229 [debug] [MainThread]: Opening a new connection, currently in state closed
15:28:02.500708 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:28:02.500877 [debug] [MainThread]: On master: COMMIT
15:28:02.500964 [debug] [MainThread]: Using postgres connection "master"
15:28:02.501020 [debug] [MainThread]: On master: COMMIT
15:28:02.501228 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:28:02.501335 [debug] [MainThread]: On master: Close
15:28:02.501635 [info ] [MainThread]: 
15:28:02.501776 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0.20s.
15:28:02.501878 [debug] [MainThread]: Connection 'master' was properly closed.
15:28:02.501948 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
15:28:02.501998 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
15:28:02.502046 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
15:28:02.506440 [info ] [MainThread]: 
15:28:02.506677 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:28:02.506978 [info ] [MainThread]: 
15:28:02.507112 [error] [MainThread]: [33mDatabase Error in model customers (models/erp/customers.sql)[0m
15:28:02.507211 [error] [MainThread]:   cross-database references are not implemented: "erp_oltp.public.clientes"
15:28:02.507312 [error] [MainThread]:   LINE 9:  from erp_oltp.public.clientes
15:28:02.507407 [error] [MainThread]:                 ^
15:28:02.507495 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/customers.sql
15:28:02.507592 [info ] [MainThread]: 
15:28:02.507692 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
15:28:02.507885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba3dc1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba3dbc1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feba3a58670>]}


============================== 2022-06-07 15:32:54.970756 | baeaa50c-994f-43e2-ab34-207829d723e8 ==============================
15:32:54.970767 [info ] [MainThread]: Running with dbt=1.1.0
15:32:54.971272 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:32:54.971390 [debug] [MainThread]: Tracking: tracking
15:32:54.973646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b88d3a460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b88d3a820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b88d3a910>]}
15:32:54.984596 [info ] [MainThread]: Unable to do partial parsing because profile has changed
15:32:54.984892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'baeaa50c-994f-43e2-ab34-207829d723e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b88cf5700>]}
15:32:54.990887 [debug] [MainThread]: Parsing macros/catalog.sql
15:32:54.993130 [debug] [MainThread]: Parsing macros/relations.sql
15:32:54.994098 [debug] [MainThread]: Parsing macros/adapters.sql
15:32:55.009718 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
15:32:55.010857 [debug] [MainThread]: Parsing macros/materializations/configs.sql
15:32:55.012257 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
15:32:55.014644 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
15:32:55.021315 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
15:32:55.030218 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
15:32:55.039415 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
15:32:55.042082 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
15:32:55.043014 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
15:32:55.043794 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
15:32:55.045233 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
15:32:55.046867 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
15:32:55.051293 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
15:32:55.055504 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
15:32:55.057287 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
15:32:55.080354 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
15:32:55.084151 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
15:32:55.085383 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
15:32:55.096033 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
15:32:55.099339 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
15:32:55.119702 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
15:32:55.150602 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
15:32:55.156633 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
15:32:55.165402 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
15:32:55.174616 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
15:32:55.182985 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
15:32:55.186375 [debug] [MainThread]: Parsing macros/adapters/columns.sql
15:32:55.191945 [debug] [MainThread]: Parsing macros/adapters/relation.sql
15:32:55.206486 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
15:32:55.223156 [debug] [MainThread]: Parsing macros/adapters/schema.sql
15:32:55.225793 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
15:32:55.227631 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
15:32:55.231775 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
15:32:55.249676 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
15:32:55.251096 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
15:32:55.253786 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
15:32:55.254230 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
15:32:55.255003 [debug] [MainThread]: Parsing macros/etc/datetime.sql
15:32:55.265714 [debug] [MainThread]: Parsing macros/etc/statement.sql
15:32:55.268286 [debug] [MainThread]: Parsing tests/generic/builtin.sql
15:32:55.396614 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
15:32:55.404563 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
15:32:55.406093 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
15:32:55.435017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'baeaa50c-994f-43e2-ab34-207829d723e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b88c29e80>]}
15:32:55.437790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'baeaa50c-994f-43e2-ab34-207829d723e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b88790f10>]}
15:32:55.438038 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:32:55.438199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baeaa50c-994f-43e2-ab34-207829d723e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b88c29fa0>]}
15:32:55.439058 [info ] [MainThread]: 
15:32:55.439370 [debug] [MainThread]: Acquiring new postgres connection "master"
15:32:55.440212 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
15:32:55.446957 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
15:32:55.447124 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
15:32:55.447192 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:32:55.454056 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
15:32:55.454934 [debug] [ThreadPool]: On list_erp_oltp: Close
15:32:55.455939 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
15:32:55.459895 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
15:32:55.460001 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
15:32:55.460069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:32:55.477739 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
15:32:55.477994 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
15:32:55.478064 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:32:55.480071 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
15:32:55.481198 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
15:32:55.481636 [debug] [ThreadPool]: On list_erp_oltp_public: Close
15:32:55.485602 [debug] [MainThread]: Using postgres connection "master"
15:32:55.485845 [debug] [MainThread]: On master: BEGIN
15:32:55.485937 [debug] [MainThread]: Opening a new connection, currently in state init
15:32:55.489965 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:32:55.490101 [debug] [MainThread]: Using postgres connection "master"
15:32:55.490162 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:32:55.497965 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
15:32:55.498946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baeaa50c-994f-43e2-ab34-207829d723e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b8b95a550>]}
15:32:55.499209 [debug] [MainThread]: On master: ROLLBACK
15:32:55.499750 [debug] [MainThread]: Using postgres connection "master"
15:32:55.499860 [debug] [MainThread]: On master: BEGIN
15:32:55.500089 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:32:55.500186 [debug] [MainThread]: On master: COMMIT
15:32:55.500246 [debug] [MainThread]: Using postgres connection "master"
15:32:55.500300 [debug] [MainThread]: On master: COMMIT
15:32:55.500407 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:32:55.500485 [debug] [MainThread]: On master: Close
15:32:55.500753 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
15:32:55.500918 [info ] [MainThread]: 
15:32:55.505544 [debug] [Thread-1  ]: Began running node model.first_project.customers
15:32:55.505751 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
15:32:55.506043 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
15:32:55.506137 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
15:32:55.506210 [debug] [Thread-1  ]: Compiling model.first_project.customers
15:32:55.507259 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
15:32:55.507498 [debug] [Thread-1  ]: finished collecting timing info
15:32:55.507599 [debug] [Thread-1  ]: Began executing node model.first_project.customers
15:32:55.519708 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
15:32:55.520074 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
15:32:55.520496 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
15:32:55.520628 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
15:32:55.520726 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
15:32:55.522353 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
15:32:55.522643 [debug] [Thread-2  ]: finished collecting timing info
15:32:55.522730 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
15:32:55.536393 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
15:32:55.548205 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:32:55.547536 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
15:32:55.548392 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
15:32:55.548758 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:32:55.549780 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:32:55.549878 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
15:32:55.549941 [debug] [Thread-2  ]: Opening a new connection, currently in state init
15:32:55.553100 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:32:55.553211 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:32:55.553270 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
 select
 codigo_cliente as customer_id,
 nome as first_name,
 sobrenome as last_name
 from erp_oltp.public.clientes
)
select * from customers
  );
15:32:55.555978 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
15:32:55.556092 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:32:55.556167 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:32:55.556238 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:32:55.560601 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:32:55.560729 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
15:32:55.560828 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
15:32:55.563493 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:32:55.563751 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:32:55.563867 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:32:55.565301 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:32:55.565514 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
15:32:55.565760 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
15:32:55.565860 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:32:55.567024 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:32:55.570891 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
15:32:55.571060 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:32:55.571164 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:32:55.571367 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
15:32:55.571476 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
15:32:55.575390 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
15:32:55.575516 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:32:55.575607 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:32:55.578123 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:32:55.578341 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
15:32:55.578455 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
15:32:55.579546 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
15:32:55.580805 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:32:55.580960 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
15:32:55.581069 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:32:55.581837 [debug] [Thread-1  ]: finished collecting timing info
15:32:55.581944 [debug] [Thread-1  ]: On model.first_project.customers: Close
15:32:55.583154 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
15:32:55.583477 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baeaa50c-994f-43e2-ab34-207829d723e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b88c3a130>]}
15:32:55.584228 [debug] [Thread-2  ]: finished collecting timing info
15:32:55.584533 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.08s]
15:32:55.584643 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
15:32:55.584888 [debug] [Thread-1  ]: Finished running node model.first_project.customers
15:32:55.586378 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baeaa50c-994f-43e2-ab34-207829d723e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b8875edc0>]}
15:32:55.586603 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.07s]
15:32:55.586851 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
15:32:55.587184 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
15:32:55.587384 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
15:32:55.587605 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
15:32:55.587677 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
15:32:55.587744 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
15:32:55.588977 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
15:32:55.589273 [debug] [Thread-4  ]: finished collecting timing info
15:32:55.589370 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
15:32:55.590603 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
15:32:55.590802 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:32:55.590895 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
15:32:55.590968 [debug] [Thread-4  ]: Opening a new connection, currently in state init
15:32:55.594595 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
15:32:55.594700 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:32:55.594762 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
15:32:55.595564 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
15:32:55.597826 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:32:55.597932 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:32:55.598347 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
15:32:55.599145 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
15:32:55.599233 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:32:55.599303 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
15:32:55.605194 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
15:32:55.606412 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:32:55.606537 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
15:32:55.607112 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
15:32:55.607931 [debug] [Thread-4  ]: finished collecting timing info
15:32:55.608060 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
15:32:55.608495 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'baeaa50c-994f-43e2-ab34-207829d723e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b88727070>]}
15:32:55.608762 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
15:32:55.609063 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
15:32:55.611191 [debug] [MainThread]: Acquiring new postgres connection "master"
15:32:55.611333 [debug] [MainThread]: Using postgres connection "master"
15:32:55.611424 [debug] [MainThread]: On master: BEGIN
15:32:55.611547 [debug] [MainThread]: Opening a new connection, currently in state closed
15:32:55.619563 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:32:55.619774 [debug] [MainThread]: On master: COMMIT
15:32:55.619849 [debug] [MainThread]: Using postgres connection "master"
15:32:55.619910 [debug] [MainThread]: On master: COMMIT
15:32:55.620160 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:32:55.620288 [debug] [MainThread]: On master: Close
15:32:55.620627 [info ] [MainThread]: 
15:32:55.620795 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0.18s.
15:32:55.620910 [debug] [MainThread]: Connection 'master' was properly closed.
15:32:55.620963 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
15:32:55.621014 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
15:32:55.621085 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
15:32:55.629417 [info ] [MainThread]: 
15:32:55.629652 [info ] [MainThread]: [32mCompleted successfully[0m
15:32:55.629816 [info ] [MainThread]: 
15:32:55.629961 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
15:32:55.630140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b88727130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b88727040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b88ca7940>]}


============================== 2022-06-07 15:34:24.999297 | b118a6f4-6b49-4509-96f3-baf5e948908d ==============================
15:34:24.999309 [info ] [MainThread]: Running with dbt=1.1.0
15:34:24.999657 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:34:24.999762 [debug] [MainThread]: Tracking: tracking
15:34:25.002434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8118e17310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8118e17520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8118e17e20>]}
15:34:25.023275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:34:25.023720 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
15:34:25.033414 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
15:34:25.058501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b118a6f4-6b49-4509-96f3-baf5e948908d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811886a0d0>]}
15:34:25.063503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b118a6f4-6b49-4509-96f3-baf5e948908d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8118cf7fa0>]}
15:34:25.063923 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:34:25.064106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b118a6f4-6b49-4509-96f3-baf5e948908d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8118d86b50>]}
15:34:25.065165 [info ] [MainThread]: 
15:34:25.065507 [debug] [MainThread]: Acquiring new postgres connection "master"
15:34:25.066325 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
15:34:25.072106 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
15:34:25.072222 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
15:34:25.072294 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:34:25.077864 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
15:34:25.079097 [debug] [ThreadPool]: On list_erp_oltp: Close
15:34:25.081497 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
15:34:25.096263 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
15:34:25.096455 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
15:34:25.096527 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:34:25.115264 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
15:34:25.115471 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
15:34:25.115541 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:34:25.117106 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
15:34:25.118082 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
15:34:25.120375 [debug] [ThreadPool]: On list_erp_oltp_public: Close
15:34:25.154740 [debug] [MainThread]: Using postgres connection "master"
15:34:25.154907 [debug] [MainThread]: On master: BEGIN
15:34:25.155091 [debug] [MainThread]: Opening a new connection, currently in state init
15:34:25.159517 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:34:25.159681 [debug] [MainThread]: Using postgres connection "master"
15:34:25.159751 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:34:25.168601 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
15:34:25.170224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b118a6f4-6b49-4509-96f3-baf5e948908d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8118e17cd0>]}
15:34:25.170519 [debug] [MainThread]: On master: ROLLBACK
15:34:25.170755 [debug] [MainThread]: Using postgres connection "master"
15:34:25.170851 [debug] [MainThread]: On master: BEGIN
15:34:25.171101 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:34:25.171221 [debug] [MainThread]: On master: COMMIT
15:34:25.171292 [debug] [MainThread]: Using postgres connection "master"
15:34:25.171369 [debug] [MainThread]: On master: COMMIT
15:34:25.171495 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:34:25.171597 [debug] [MainThread]: On master: Close
15:34:25.172666 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
15:34:25.172842 [info ] [MainThread]: 
15:34:25.192119 [debug] [Thread-1  ]: Began running node model.first_project.customers
15:34:25.192437 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
15:34:25.192846 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
15:34:25.192944 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
15:34:25.193042 [debug] [Thread-1  ]: Compiling model.first_project.customers
15:34:25.194011 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
15:34:25.194442 [debug] [Thread-1  ]: finished collecting timing info
15:34:25.194574 [debug] [Thread-1  ]: Began executing node model.first_project.customers
15:34:25.201939 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
15:34:25.202116 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
15:34:25.202422 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
15:34:25.202496 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
15:34:25.202555 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
15:34:25.203698 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
15:34:25.203936 [debug] [Thread-2  ]: finished collecting timing info
15:34:25.204031 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
15:34:25.220469 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
15:34:25.225908 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:34:25.226063 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
15:34:25.226129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:34:25.225569 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
15:34:25.226851 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:34:25.226995 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
15:34:25.227068 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:34:25.231579 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
15:34:25.231768 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:34:25.231871 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:34:25.231976 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:34:25.232049 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:34:25.232127 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
 select
 codigo_cliente as customer_id,
 nome as first_name,
 sobrenome as last_name,
 codigo_regiao as region_code
 from erp_oltp.public.clientes
)
select * from customers
  );
15:34:25.233480 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
15:34:25.237473 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:34:25.237585 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:34:25.237826 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
15:34:25.239057 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:34:25.239146 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:34:25.239380 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
15:34:25.247726 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
15:34:25.247945 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:34:25.248048 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
15:34:25.249919 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
15:34:25.251444 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:34:25.251546 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
15:34:25.253436 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:34:25.255434 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:34:25.255578 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
15:34:25.256509 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:34:25.258491 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
15:34:25.258629 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:34:25.258777 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
15:34:25.258875 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
15:34:25.263728 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:34:25.263913 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
15:34:25.265706 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
15:34:25.266689 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:34:25.266834 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
15:34:25.267575 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
15:34:25.272071 [debug] [Thread-2  ]: finished collecting timing info
15:34:25.272182 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
15:34:25.272906 [debug] [Thread-1  ]: finished collecting timing info
15:34:25.272998 [debug] [Thread-1  ]: On model.first_project.customers: Close
15:34:25.275354 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b118a6f4-6b49-4509-96f3-baf5e948908d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8118d86070>]}
15:34:25.275594 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.08s]
15:34:25.275828 [debug] [Thread-1  ]: Finished running node model.first_project.customers
15:34:25.272311 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
15:34:25.277486 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b118a6f4-6b49-4509-96f3-baf5e948908d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81187ccfa0>]}
15:34:25.277828 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
15:34:25.278095 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
15:34:25.278631 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
15:34:25.278768 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
15:34:25.278991 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
15:34:25.279056 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
15:34:25.279138 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
15:34:25.280484 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
15:34:25.280738 [debug] [Thread-4  ]: finished collecting timing info
15:34:25.280865 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
15:34:25.282253 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
15:34:25.282454 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:34:25.282564 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
15:34:25.282621 [debug] [Thread-4  ]: Opening a new connection, currently in state init
15:34:25.286223 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
15:34:25.286329 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:34:25.286389 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
15:34:25.287228 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
15:34:25.288574 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:34:25.288657 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:34:25.293902 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
15:34:25.295156 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
15:34:25.295291 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:34:25.295361 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
15:34:25.296518 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
15:34:25.297816 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:34:25.297935 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
15:34:25.298194 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
15:34:25.298919 [debug] [Thread-4  ]: finished collecting timing info
15:34:25.299031 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
15:34:25.299396 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b118a6f4-6b49-4509-96f3-baf5e948908d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81187f59d0>]}
15:34:25.299630 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
15:34:25.299863 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
15:34:25.300972 [debug] [MainThread]: Acquiring new postgres connection "master"
15:34:25.301081 [debug] [MainThread]: Using postgres connection "master"
15:34:25.301191 [debug] [MainThread]: On master: BEGIN
15:34:25.301250 [debug] [MainThread]: Opening a new connection, currently in state closed
15:34:25.304789 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:34:25.304925 [debug] [MainThread]: On master: COMMIT
15:34:25.304993 [debug] [MainThread]: Using postgres connection "master"
15:34:25.305057 [debug] [MainThread]: On master: COMMIT
15:34:25.305234 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:34:25.305339 [debug] [MainThread]: On master: Close
15:34:25.305605 [info ] [MainThread]: 
15:34:25.305739 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0.24s.
15:34:25.305851 [debug] [MainThread]: Connection 'master' was properly closed.
15:34:25.305905 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
15:34:25.305952 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
15:34:25.306001 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
15:34:25.308480 [info ] [MainThread]: 
15:34:25.308656 [info ] [MainThread]: [32mCompleted successfully[0m
15:34:25.308789 [info ] [MainThread]: 
15:34:25.308887 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
15:34:25.309139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8118d869a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811aefe2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811ac089a0>]}


============================== 2022-06-07 15:35:17.768442 | 39e665e9-775d-48f4-9c1b-0422ad6f1f57 ==============================
15:35:17.768454 [info ] [MainThread]: Running with dbt=1.1.0
15:35:17.768893 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:35:17.768982 [debug] [MainThread]: Tracking: tracking
15:35:17.771289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c73c27be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c73c27520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c73c27190>]}
15:35:17.786681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:35:17.787038 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
15:35:17.794982 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
15:35:17.807692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39e665e9-775d-48f4-9c1b-0422ad6f1f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c7367a0d0>]}
15:35:17.811108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39e665e9-775d-48f4-9c1b-0422ad6f1f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c73b05ee0>]}
15:35:17.811359 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:35:17.811510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39e665e9-775d-48f4-9c1b-0422ad6f1f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c73b96dc0>]}
15:35:17.812443 [info ] [MainThread]: 
15:35:17.812756 [debug] [MainThread]: Acquiring new postgres connection "master"
15:35:17.813405 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
15:35:17.819392 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
15:35:17.819562 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
15:35:17.819635 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:35:17.824677 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
15:35:17.825828 [debug] [ThreadPool]: On list_erp_oltp: Close
15:35:17.826982 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
15:35:17.831157 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
15:35:17.831316 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
15:35:17.831388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:35:17.835457 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
15:35:17.835588 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
15:35:17.835659 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:35:17.837057 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
15:35:17.837959 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
15:35:17.838124 [debug] [ThreadPool]: On list_erp_oltp_public: Close
15:35:17.867693 [debug] [MainThread]: Using postgres connection "master"
15:35:17.867847 [debug] [MainThread]: On master: BEGIN
15:35:17.867905 [debug] [MainThread]: Opening a new connection, currently in state init
15:35:17.873259 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:35:17.873437 [debug] [MainThread]: Using postgres connection "master"
15:35:17.873519 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:35:17.881846 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
15:35:17.882741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39e665e9-775d-48f4-9c1b-0422ad6f1f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c73c27160>]}
15:35:17.882959 [debug] [MainThread]: On master: ROLLBACK
15:35:17.883294 [debug] [MainThread]: Using postgres connection "master"
15:35:17.883394 [debug] [MainThread]: On master: BEGIN
15:35:17.883885 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:35:17.883988 [debug] [MainThread]: On master: COMMIT
15:35:17.884063 [debug] [MainThread]: Using postgres connection "master"
15:35:17.884119 [debug] [MainThread]: On master: COMMIT
15:35:17.884381 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:35:17.884494 [debug] [MainThread]: On master: Close
15:35:17.884797 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
15:35:17.884948 [info ] [MainThread]: 
15:35:17.889274 [debug] [Thread-1  ]: Began running node model.first_project.customers
15:35:17.889478 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
15:35:17.889727 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
15:35:17.889803 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
15:35:17.889872 [debug] [Thread-1  ]: Compiling model.first_project.customers
15:35:17.890604 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
15:35:17.890820 [debug] [Thread-1  ]: finished collecting timing info
15:35:17.890941 [debug] [Thread-1  ]: Began executing node model.first_project.customers
15:35:17.898184 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
15:35:17.898351 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
15:35:17.898624 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
15:35:17.898707 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
15:35:17.898792 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
15:35:17.900001 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
15:35:17.900210 [debug] [Thread-2  ]: finished collecting timing info
15:35:17.900332 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
15:35:17.936406 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
15:35:17.942037 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
15:35:17.943996 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:35:17.944130 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
15:35:17.944196 [debug] [Thread-2  ]: Opening a new connection, currently in state init
15:35:17.944437 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:35:17.944979 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
15:35:17.945047 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:35:17.948051 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
15:35:17.948242 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:35:17.948321 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:35:17.948471 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:35:17.948639 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:35:17.948913 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
 select
 codigo_cliente as customer_id,
 nome as first_name,
 sobrenome as last_name,
 codigo_regiao as region_code
 from erp_oltp.public.clientes
)
select * from customers,
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
15:35:17.949171 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "("
LINE 13: orders as (
                   ^

15:35:17.949265 [debug] [Thread-1  ]: On model.first_project.customers: ROLLBACK
15:35:17.949481 [debug] [Thread-1  ]: finished collecting timing info
15:35:17.949572 [debug] [Thread-1  ]: On model.first_project.customers: Close
15:35:17.949671 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
15:35:17.949984 [debug] [Thread-1  ]: Database Error in model customers (models/erp/customers.sql)
  syntax error at or near "("
  LINE 13: orders as (
                     ^
  compiled SQL at target/run/first_project/models/erp/customers.sql
15:35:17.955568 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39e665e9-775d-48f4-9c1b-0422ad6f1f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c705b0760>]}
15:35:17.955810 [error] [Thread-1  ]: 1 of 3 ERROR creating view model public.customers .............................. [[31mERROR[0m in 0.07s]
15:35:17.956047 [debug] [Thread-1  ]: Finished running node model.first_project.customers
15:35:17.956299 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:35:17.956482 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:35:17.956900 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
15:35:17.958142 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:35:17.958251 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:35:17.958475 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
15:35:17.964544 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
15:35:17.964685 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:35:17.964749 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
15:35:17.965620 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
15:35:17.974071 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:35:17.974296 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
15:35:17.976813 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
15:35:17.977700 [debug] [Thread-2  ]: finished collecting timing info
15:35:17.977825 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
15:35:17.978134 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39e665e9-775d-48f4-9c1b-0422ad6f1f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c73605f70>]}
15:35:17.978354 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
15:35:17.978590 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
15:35:17.979034 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
15:35:17.979178 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
15:35:17.979405 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
15:35:17.979475 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
15:35:17.979581 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
15:35:17.982176 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
15:35:17.982483 [debug] [Thread-4  ]: finished collecting timing info
15:35:17.982576 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
15:35:17.984031 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
15:35:17.984426 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:35:17.984580 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
15:35:17.984660 [debug] [Thread-4  ]: Opening a new connection, currently in state init
15:35:17.989706 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
15:35:17.989890 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:35:17.989964 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
15:35:17.990936 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
15:35:17.992409 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:35:17.992573 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:35:17.999422 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
15:35:18.000551 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
15:35:18.000700 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:35:18.000766 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
15:35:18.002928 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
15:35:18.004143 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:35:18.004262 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
15:35:18.004497 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
15:35:18.005201 [debug] [Thread-4  ]: finished collecting timing info
15:35:18.005331 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
15:35:18.006889 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39e665e9-775d-48f4-9c1b-0422ad6f1f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c705c0d30>]}
15:35:18.007162 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
15:35:18.007401 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
15:35:18.008634 [debug] [MainThread]: Acquiring new postgres connection "master"
15:35:18.008749 [debug] [MainThread]: Using postgres connection "master"
15:35:18.008810 [debug] [MainThread]: On master: BEGIN
15:35:18.008875 [debug] [MainThread]: Opening a new connection, currently in state closed
15:35:18.018509 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:35:18.018714 [debug] [MainThread]: On master: COMMIT
15:35:18.018786 [debug] [MainThread]: Using postgres connection "master"
15:35:18.018848 [debug] [MainThread]: On master: COMMIT
15:35:18.019125 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:35:18.019243 [debug] [MainThread]: On master: Close
15:35:18.019570 [info ] [MainThread]: 
15:35:18.019741 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0.21s.
15:35:18.019854 [debug] [MainThread]: Connection 'master' was properly closed.
15:35:18.019909 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
15:35:18.019990 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
15:35:18.020041 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
15:35:18.029352 [info ] [MainThread]: 
15:35:18.029607 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:35:18.029742 [info ] [MainThread]: 
15:35:18.029844 [error] [MainThread]: [33mDatabase Error in model customers (models/erp/customers.sql)[0m
15:35:18.029946 [error] [MainThread]:   syntax error at or near "("
15:35:18.030052 [error] [MainThread]:   LINE 13: orders as (
15:35:18.030203 [error] [MainThread]:                      ^
15:35:18.030303 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/customers.sql
15:35:18.030408 [info ] [MainThread]: 
15:35:18.030522 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
15:35:18.030708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c75a09580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c75d0deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c705b0790>]}


============================== 2022-06-07 15:35:47.055140 | 2652dcb8-728f-473e-89be-9726b5a5248d ==============================
15:35:47.055160 [info ] [MainThread]: Running with dbt=1.1.0
15:35:47.055774 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:35:47.055914 [debug] [MainThread]: Tracking: tracking
15:35:47.064930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84e72e7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84e72e520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84e72e2b0>]}
15:35:47.109935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:35:47.110319 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
15:35:47.125697 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
15:35:47.164445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2652dcb8-728f-473e-89be-9726b5a5248d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84e1810d0>]}
15:35:47.167548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2652dcb8-728f-473e-89be-9726b5a5248d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84e60dfa0>]}
15:35:47.181470 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:35:47.181719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2652dcb8-728f-473e-89be-9726b5a5248d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84e69ab50>]}
15:35:47.182686 [info ] [MainThread]: 
15:35:47.183008 [debug] [MainThread]: Acquiring new postgres connection "master"
15:35:47.200080 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
15:35:47.234590 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
15:35:47.234808 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
15:35:47.234888 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:35:47.259563 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.02 seconds
15:35:47.260603 [debug] [ThreadPool]: On list_erp_oltp: Close
15:35:47.271661 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
15:35:47.288838 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
15:35:47.289021 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
15:35:47.289126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:35:47.299641 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:35:47.299819 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
15:35:47.299884 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:35:47.301360 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
15:35:47.302317 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
15:35:47.302689 [debug] [ThreadPool]: On list_erp_oltp_public: Close
15:35:47.338857 [debug] [MainThread]: Using postgres connection "master"
15:35:47.339008 [debug] [MainThread]: On master: BEGIN
15:35:47.339068 [debug] [MainThread]: Opening a new connection, currently in state init
15:35:47.342789 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:35:47.342912 [debug] [MainThread]: Using postgres connection "master"
15:35:47.342974 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:35:47.350233 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
15:35:47.351017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2652dcb8-728f-473e-89be-9726b5a5248d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84e72ecd0>]}
15:35:47.351221 [debug] [MainThread]: On master: ROLLBACK
15:35:47.351505 [debug] [MainThread]: Using postgres connection "master"
15:35:47.351598 [debug] [MainThread]: On master: BEGIN
15:35:47.352007 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:35:47.352118 [debug] [MainThread]: On master: COMMIT
15:35:47.352192 [debug] [MainThread]: Using postgres connection "master"
15:35:47.352247 [debug] [MainThread]: On master: COMMIT
15:35:47.353184 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:35:47.353286 [debug] [MainThread]: On master: Close
15:35:47.353538 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
15:35:47.353686 [info ] [MainThread]: 
15:35:47.358140 [debug] [Thread-1  ]: Began running node model.first_project.customers
15:35:47.358321 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
15:35:47.358579 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
15:35:47.358659 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
15:35:47.358737 [debug] [Thread-1  ]: Compiling model.first_project.customers
15:35:47.359441 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
15:35:47.359650 [debug] [Thread-1  ]: finished collecting timing info
15:35:47.359792 [debug] [Thread-1  ]: Began executing node model.first_project.customers
15:35:47.370973 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
15:35:47.371436 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
15:35:47.371746 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
15:35:47.371822 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
15:35:47.371887 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
15:35:47.373428 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
15:35:47.382912 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
15:35:47.383269 [debug] [Thread-2  ]: finished collecting timing info
15:35:47.383499 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
15:35:47.400731 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
15:35:47.401662 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:35:47.401899 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
15:35:47.403093 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:35:47.402002 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:35:47.403325 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
15:35:47.403413 [debug] [Thread-2  ]: Opening a new connection, currently in state init
15:35:47.407135 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
15:35:47.407274 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:35:47.407339 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
 select
 codigo_cliente as customer_id,
 nome as first_name,
 sobrenome as last_name,
 codigo_regiao as region_code
 from erp_oltp.public.clientes
)
select * from customers
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
15:35:47.407650 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 13: orders as (
                ^

15:35:47.407773 [debug] [Thread-1  ]: On model.first_project.customers: ROLLBACK
15:35:47.408020 [debug] [Thread-1  ]: finished collecting timing info
15:35:47.408189 [debug] [Thread-1  ]: On model.first_project.customers: Close
15:35:47.408652 [debug] [Thread-1  ]: Database Error in model customers (models/erp/customers.sql)
  syntax error at or near "as"
  LINE 13: orders as (
                  ^
  compiled SQL at target/run/first_project/models/erp/customers.sql
15:35:47.408909 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2652dcb8-728f-473e-89be-9726b5a5248d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84c0bf6d0>]}
15:35:47.409204 [error] [Thread-1  ]: 1 of 3 ERROR creating view model public.customers .............................. [[31mERROR[0m in 0.05s]
15:35:47.409581 [debug] [Thread-1  ]: Finished running node model.first_project.customers
15:35:47.409687 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
15:35:47.409983 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:35:47.410054 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:35:47.410947 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
15:35:47.417699 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:35:47.417880 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:35:47.418253 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
15:35:47.419654 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:35:47.419779 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:35:47.420136 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
15:35:47.426385 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
15:35:47.426594 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:35:47.426663 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
15:35:47.432021 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
15:35:47.436122 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:35:47.436297 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
15:35:47.438025 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
15:35:47.438702 [debug] [Thread-2  ]: finished collecting timing info
15:35:47.438808 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
15:35:47.439235 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2652dcb8-728f-473e-89be-9726b5a5248d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84e0ff250>]}
15:35:47.439451 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.07s]
15:35:47.439689 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
15:35:47.440132 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
15:35:47.440287 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
15:35:47.440529 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
15:35:47.440609 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
15:35:47.440676 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
15:35:47.442238 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
15:35:47.442544 [debug] [Thread-4  ]: finished collecting timing info
15:35:47.442703 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
15:35:47.444617 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
15:35:47.445028 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:35:47.445179 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
15:35:47.445241 [debug] [Thread-4  ]: Opening a new connection, currently in state init
15:35:47.450205 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
15:35:47.450394 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:35:47.450460 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
15:35:47.457372 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
15:35:47.459692 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:35:47.459862 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:35:47.460407 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
15:35:47.461187 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
15:35:47.461269 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:35:47.461325 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
15:35:47.463187 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
15:35:47.464102 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:35:47.464181 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
15:35:47.464491 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
15:35:47.465105 [debug] [Thread-4  ]: finished collecting timing info
15:35:47.465204 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
15:35:47.465557 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2652dcb8-728f-473e-89be-9726b5a5248d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff84c0d0490>]}
15:35:47.465779 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
15:35:47.466009 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
15:35:47.466977 [debug] [MainThread]: Acquiring new postgres connection "master"
15:35:47.467082 [debug] [MainThread]: Using postgres connection "master"
15:35:47.467142 [debug] [MainThread]: On master: BEGIN
15:35:47.467197 [debug] [MainThread]: Opening a new connection, currently in state closed
15:35:47.471569 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:35:47.471687 [debug] [MainThread]: On master: COMMIT
15:35:47.471750 [debug] [MainThread]: Using postgres connection "master"
15:35:47.471803 [debug] [MainThread]: On master: COMMIT
15:35:47.472027 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:35:47.472149 [debug] [MainThread]: On master: Close
15:35:47.472406 [info ] [MainThread]: 
15:35:47.472548 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0.29s.
15:35:47.472653 [debug] [MainThread]: Connection 'master' was properly closed.
15:35:47.472706 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
15:35:47.472755 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
15:35:47.472802 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
15:35:47.476113 [info ] [MainThread]: 
15:35:47.476974 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:35:47.479537 [info ] [MainThread]: 
15:35:47.479694 [error] [MainThread]: [33mDatabase Error in model customers (models/erp/customers.sql)[0m
15:35:47.479807 [error] [MainThread]:   syntax error at or near "as"
15:35:47.479909 [error] [MainThread]:   LINE 13: orders as (
15:35:47.480007 [error] [MainThread]:                   ^
15:35:47.480161 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/customers.sql
15:35:47.480292 [info ] [MainThread]: 
15:35:47.485432 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
15:35:47.485774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85051f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85051f9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff850804ca0>]}


============================== 2022-06-07 15:36:13.344172 | 043822f3-692c-42f2-a1c9-0e284fce994c ==============================
15:36:13.344184 [info ] [MainThread]: Running with dbt=1.1.0
15:36:13.344675 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:36:13.344758 [debug] [MainThread]: Tracking: tracking
15:36:13.347031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f648fe36700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f648fe36730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f648fe360a0>]}
15:36:13.364917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:36:13.365305 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
15:36:13.373587 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
15:36:13.392992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '043822f3-692c-42f2-a1c9-0e284fce994c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f648f88d0d0>]}
15:36:13.396099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '043822f3-692c-42f2-a1c9-0e284fce994c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f648fe2ba60>]}
15:36:13.396343 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:36:13.396496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '043822f3-692c-42f2-a1c9-0e284fce994c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f648fd19fa0>]}
15:36:13.397394 [info ] [MainThread]: 
15:36:13.397682 [debug] [MainThread]: Acquiring new postgres connection "master"
15:36:13.398339 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
15:36:13.413625 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
15:36:13.413807 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
15:36:13.414000 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:36:13.419547 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
15:36:13.420427 [debug] [ThreadPool]: On list_erp_oltp: Close
15:36:13.421336 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
15:36:13.426585 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
15:36:13.426743 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
15:36:13.426805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:36:13.431510 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
15:36:13.431638 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
15:36:13.431702 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:36:13.433280 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
15:36:13.434122 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
15:36:13.434350 [debug] [ThreadPool]: On list_erp_oltp_public: Close
15:36:13.457944 [debug] [MainThread]: Using postgres connection "master"
15:36:13.458111 [debug] [MainThread]: On master: BEGIN
15:36:13.458176 [debug] [MainThread]: Opening a new connection, currently in state init
15:36:13.462051 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:36:13.462195 [debug] [MainThread]: Using postgres connection "master"
15:36:13.462286 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:36:13.469985 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
15:36:13.470927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '043822f3-692c-42f2-a1c9-0e284fce994c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6491c255b0>]}
15:36:13.471204 [debug] [MainThread]: On master: ROLLBACK
15:36:13.471473 [debug] [MainThread]: Using postgres connection "master"
15:36:13.471557 [debug] [MainThread]: On master: BEGIN
15:36:13.471722 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:36:13.471802 [debug] [MainThread]: On master: COMMIT
15:36:13.471874 [debug] [MainThread]: Using postgres connection "master"
15:36:13.471932 [debug] [MainThread]: On master: COMMIT
15:36:13.472069 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:36:13.472196 [debug] [MainThread]: On master: Close
15:36:13.472471 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
15:36:13.472624 [info ] [MainThread]: 
15:36:13.477145 [debug] [Thread-1  ]: Began running node model.first_project.customers
15:36:13.477341 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
15:36:13.477598 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
15:36:13.477690 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
15:36:13.477763 [debug] [Thread-1  ]: Compiling model.first_project.customers
15:36:13.478499 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
15:36:13.478735 [debug] [Thread-1  ]: finished collecting timing info
15:36:13.478881 [debug] [Thread-1  ]: Began executing node model.first_project.customers
15:36:13.491544 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
15:36:13.497178 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
15:36:13.497656 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
15:36:13.497772 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
15:36:13.497865 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
15:36:13.499149 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
15:36:13.500736 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
15:36:13.501106 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:36:13.501270 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
15:36:13.501354 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:36:13.503812 [debug] [Thread-2  ]: finished collecting timing info
15:36:13.504011 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
15:36:13.521065 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
15:36:13.521262 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:36:13.521330 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
 select
 codigo_cliente as customer_id,
 nome as first_name,
 sobrenome as last_name,
 codigo_regiao as region_code
 from erp_oltp.public.clientes
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
15:36:13.523497 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
15:36:13.524067 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:36:13.524204 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
15:36:13.524286 [debug] [Thread-2  ]: Opening a new connection, currently in state init
15:36:13.526108 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
15:36:13.530464 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:36:13.530643 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
15:36:13.530991 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:36:13.532124 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:36:13.532212 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
15:36:13.532501 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:36:13.535755 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
15:36:13.535858 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:36:13.535927 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
15:36:13.536233 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
15:36:13.536394 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:36:13.536466 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:36:13.537079 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:36:13.539600 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:36:13.539701 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
15:36:13.539778 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
15:36:13.541563 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:36:13.541736 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:36:13.541851 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:36:13.542583 [debug] [Thread-1  ]: finished collecting timing info
15:36:13.542699 [debug] [Thread-1  ]: On model.first_project.customers: Close
15:36:13.543087 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
15:36:13.544305 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:36:13.545043 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:36:13.545329 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '043822f3-692c-42f2-a1c9-0e284fce994c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f648c7e4640>]}
15:36:13.545706 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.07s]
15:36:13.545949 [debug] [Thread-1  ]: Finished running node model.first_project.customers
15:36:13.546144 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
15:36:13.548970 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
15:36:13.549096 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:36:13.549166 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
15:36:13.550217 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
15:36:13.551094 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:36:13.551185 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
15:36:13.553209 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
15:36:13.553807 [debug] [Thread-2  ]: finished collecting timing info
15:36:13.553914 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
15:36:13.555376 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '043822f3-692c-42f2-a1c9-0e284fce994c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f648c7eedc0>]}
15:36:13.555583 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.06s]
15:36:13.555860 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
15:36:13.556329 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
15:36:13.556479 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
15:36:13.556720 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
15:36:13.556824 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
15:36:13.556897 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
15:36:13.558112 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
15:36:13.558331 [debug] [Thread-4  ]: finished collecting timing info
15:36:13.558416 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
15:36:13.559660 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
15:36:13.559890 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:36:13.559987 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
15:36:13.560043 [debug] [Thread-4  ]: Opening a new connection, currently in state init
15:36:13.564062 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
15:36:13.564189 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:36:13.564253 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
15:36:13.565056 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
15:36:13.567673 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:36:13.567770 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:36:13.568004 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
15:36:13.568716 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
15:36:13.568803 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:36:13.575011 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
15:36:13.576514 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
15:36:13.578088 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:36:13.578280 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
15:36:13.578628 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
15:36:13.583991 [debug] [Thread-4  ]: finished collecting timing info
15:36:13.584210 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
15:36:13.587292 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '043822f3-692c-42f2-a1c9-0e284fce994c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f648c7cea30>]}
15:36:13.589641 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
15:36:13.590335 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
15:36:13.591564 [debug] [MainThread]: Acquiring new postgres connection "master"
15:36:13.591675 [debug] [MainThread]: Using postgres connection "master"
15:36:13.591736 [debug] [MainThread]: On master: BEGIN
15:36:13.591791 [debug] [MainThread]: Opening a new connection, currently in state closed
15:36:13.596419 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:36:13.596526 [debug] [MainThread]: On master: COMMIT
15:36:13.596588 [debug] [MainThread]: Using postgres connection "master"
15:36:13.596644 [debug] [MainThread]: On master: COMMIT
15:36:13.596788 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:36:13.596865 [debug] [MainThread]: On master: Close
15:36:13.597126 [info ] [MainThread]: 
15:36:13.597254 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0.20s.
15:36:13.597350 [debug] [MainThread]: Connection 'master' was properly closed.
15:36:13.597400 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
15:36:13.597447 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
15:36:13.597493 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
15:36:13.599934 [info ] [MainThread]: 
15:36:13.600146 [info ] [MainThread]: [32mCompleted successfully[0m
15:36:13.600300 [info ] [MainThread]: 
15:36:13.600394 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
15:36:13.600537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f648fd19f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6491f20190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6491c2b580>]}


============================== 2022-06-07 15:40:25.696889 | 5422b2d0-7ba5-433b-8d54-d9f3eeb2269c ==============================
15:40:25.696902 [info ] [MainThread]: Running with dbt=1.1.0
15:40:25.697242 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:40:25.697326 [debug] [MainThread]: Tracking: tracking
15:40:25.699389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5162811f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd516281e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd516281af0>]}
15:40:25.709640 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
15:40:25.709859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5422b2d0-7ba5-433b-8d54-d9f3eeb2269c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5162817f0>]}
15:40:25.715183 [debug] [MainThread]: Parsing macros/catalog.sql
15:40:25.717156 [debug] [MainThread]: Parsing macros/relations.sql
15:40:25.717989 [debug] [MainThread]: Parsing macros/adapters.sql
15:40:25.731009 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
15:40:25.732068 [debug] [MainThread]: Parsing macros/materializations/configs.sql
15:40:25.733524 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
15:40:25.735845 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
15:40:25.741845 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
15:40:25.751055 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
15:40:25.760502 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
15:40:25.763212 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
15:40:25.764097 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
15:40:25.764852 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
15:40:25.766248 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
15:40:25.767855 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
15:40:25.772052 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
15:40:25.776172 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
15:40:25.777841 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
15:40:25.787118 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
15:40:25.790595 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
15:40:25.791707 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
15:40:25.794224 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
15:40:25.795258 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
15:40:25.802432 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
15:40:25.811934 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
15:40:25.817934 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
15:40:25.818905 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
15:40:25.820333 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
15:40:25.821383 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
15:40:25.822238 [debug] [MainThread]: Parsing macros/adapters/columns.sql
15:40:25.827633 [debug] [MainThread]: Parsing macros/adapters/relation.sql
15:40:25.833004 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
15:40:25.834681 [debug] [MainThread]: Parsing macros/adapters/schema.sql
15:40:25.835961 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
15:40:25.837476 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
15:40:25.841486 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
15:40:25.844067 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
15:40:25.844550 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
15:40:25.845084 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
15:40:25.845507 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
15:40:25.846273 [debug] [MainThread]: Parsing macros/etc/datetime.sql
15:40:25.851222 [debug] [MainThread]: Parsing macros/etc/statement.sql
15:40:25.853867 [debug] [MainThread]: Parsing tests/generic/builtin.sql
15:40:25.976109 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
15:40:25.983345 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
15:40:25.984841 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
15:40:26.014786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5422b2d0-7ba5-433b-8d54-d9f3eeb2269c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51614ee50>]}
15:40:26.017873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5422b2d0-7ba5-433b-8d54-d9f3eeb2269c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5161bd2e0>]}
15:40:26.018088 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:40:26.018227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5422b2d0-7ba5-433b-8d54-d9f3eeb2269c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51614ee50>]}
15:40:26.020306 [info ] [MainThread]: 
15:40:26.020634 [debug] [MainThread]: Acquiring new postgres connection "master"
15:40:26.021841 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
15:40:26.028530 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
15:40:26.028696 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
15:40:26.028766 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:40:26.035315 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
15:40:26.036273 [debug] [ThreadPool]: On list_erp_oltp: Close
15:40:26.041972 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
15:40:26.050242 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
15:40:26.050597 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
15:40:26.050829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:40:26.060416 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:40:26.060652 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
15:40:26.060733 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:40:26.062122 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
15:40:26.063109 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
15:40:26.064776 [debug] [ThreadPool]: On list_erp_oltp_public: Close
15:40:26.068178 [debug] [MainThread]: Using postgres connection "master"
15:40:26.068542 [debug] [MainThread]: On master: BEGIN
15:40:26.068640 [debug] [MainThread]: Opening a new connection, currently in state init
15:40:26.073378 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:40:26.073537 [debug] [MainThread]: Using postgres connection "master"
15:40:26.073601 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:40:26.081708 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
15:40:26.082718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5422b2d0-7ba5-433b-8d54-d9f3eeb2269c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd517a95c40>]}
15:40:26.083008 [debug] [MainThread]: On master: ROLLBACK
15:40:26.097328 [debug] [MainThread]: Using postgres connection "master"
15:40:26.097528 [debug] [MainThread]: On master: BEGIN
15:40:26.097800 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:40:26.097906 [debug] [MainThread]: On master: COMMIT
15:40:26.097969 [debug] [MainThread]: Using postgres connection "master"
15:40:26.098024 [debug] [MainThread]: On master: COMMIT
15:40:26.098135 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:40:26.098224 [debug] [MainThread]: On master: Close
15:40:26.098654 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
15:40:26.098829 [info ] [MainThread]: 
15:40:26.127035 [debug] [Thread-1  ]: Began running node model.first_project.customers
15:40:26.127278 [info ] [Thread-1  ]: 1 of 3 START table model public.customers ...................................... [RUN]
15:40:26.127566 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
15:40:26.127661 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
15:40:26.127755 [debug] [Thread-1  ]: Compiling model.first_project.customers
15:40:26.128843 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
15:40:26.129089 [debug] [Thread-1  ]: finished collecting timing info
15:40:26.129409 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
15:40:26.129631 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
15:40:26.129885 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
15:40:26.129964 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
15:40:26.130028 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
15:40:26.131273 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
15:40:26.131475 [debug] [Thread-2  ]: finished collecting timing info
15:40:26.131553 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
15:40:26.129511 [debug] [Thread-1  ]: Began executing node model.first_project.customers
15:40:26.203302 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
15:40:26.204355 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
15:40:26.209543 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:40:26.209728 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
15:40:26.209797 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:40:26.213260 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:40:26.213435 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
15:40:26.213504 [debug] [Thread-2  ]: Opening a new connection, currently in state init
15:40:26.225414 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
15:40:26.225606 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:40:26.225675 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select
 codigo_cliente as customer_id,
 nome as first_name,
 sobrenome as last_name,
 codigo_regiao as region_code
 from erp_oltp.public.clientes
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
15:40:26.227346 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
15:40:26.231387 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:40:26.231527 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
15:40:26.234212 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:40:26.236386 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:40:26.237294 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
15:40:26.237425 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
15:40:26.237534 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:40:26.237594 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:40:26.237896 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:40:26.249084 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.01 seconds
15:40:26.250836 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:40:26.250977 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:40:26.261694 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
15:40:26.263226 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:40:26.263340 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:40:26.256502 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
15:40:26.263652 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:40:26.263797 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
15:40:26.264983 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
15:40:26.265104 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:40:26.265170 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
15:40:26.263867 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
15:40:26.269064 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
15:40:26.272544 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:40:26.272802 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
15:40:26.272716 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
15:40:26.273756 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:40:26.274515 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
15:40:26.274379 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
15:40:26.275944 [debug] [Thread-2  ]: finished collecting timing info
15:40:26.281175 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
15:40:26.281706 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5422b2d0-7ba5-433b-8d54-d9f3eeb2269c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51615ccd0>]}
15:40:26.281987 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.15s]
15:40:26.276056 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
15:40:26.282951 [debug] [Thread-1  ]: finished collecting timing info
15:40:26.283067 [debug] [Thread-1  ]: On model.first_project.customers: Close
15:40:26.284637 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5422b2d0-7ba5-433b-8d54-d9f3eeb2269c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51449ddf0>]}
15:40:26.284840 [info ] [Thread-1  ]: 1 of 3 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.16s]
15:40:26.285050 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
15:40:26.285328 [debug] [Thread-1  ]: Finished running node model.first_project.customers
15:40:26.285895 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
15:40:26.286067 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
15:40:26.286308 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
15:40:26.286423 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
15:40:26.286498 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
15:40:26.287763 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
15:40:26.288018 [debug] [Thread-4  ]: finished collecting timing info
15:40:26.288152 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
15:40:26.341545 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
15:40:26.342038 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:40:26.342214 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
15:40:26.342283 [debug] [Thread-4  ]: Opening a new connection, currently in state init
15:40:26.359093 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
15:40:26.359288 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:40:26.359366 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
15:40:26.360320 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
15:40:26.361977 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:40:26.362097 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:40:26.362423 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
15:40:26.363172 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
15:40:26.363272 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:40:26.363348 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
15:40:26.365602 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
15:40:26.366607 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:40:26.366693 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
15:40:26.366976 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
15:40:26.367617 [debug] [Thread-4  ]: finished collecting timing info
15:40:26.367734 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
15:40:26.368038 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5422b2d0-7ba5-433b-8d54-d9f3eeb2269c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd515d1e250>]}
15:40:26.368288 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.08s]
15:40:26.368515 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
15:40:26.370224 [debug] [MainThread]: Acquiring new postgres connection "master"
15:40:26.370348 [debug] [MainThread]: Using postgres connection "master"
15:40:26.370408 [debug] [MainThread]: On master: BEGIN
15:40:26.370463 [debug] [MainThread]: Opening a new connection, currently in state closed
15:40:26.374240 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:40:26.374365 [debug] [MainThread]: On master: COMMIT
15:40:26.374440 [debug] [MainThread]: Using postgres connection "master"
15:40:26.374495 [debug] [MainThread]: On master: COMMIT
15:40:26.374624 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:40:26.374749 [debug] [MainThread]: On master: Close
15:40:26.375008 [info ] [MainThread]: 
15:40:26.375152 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0.35s.
15:40:26.375274 [debug] [MainThread]: Connection 'master' was properly closed.
15:40:26.375331 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
15:40:26.375377 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
15:40:26.375424 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
15:40:26.378021 [info ] [MainThread]: 
15:40:26.378187 [info ] [MainThread]: [32mCompleted successfully[0m
15:40:26.378311 [info ] [MainThread]: 
15:40:26.378402 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
15:40:26.378551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd515d1ed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd517a955b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd51620d1f0>]}


============================== 2022-06-07 15:41:46.899358 | 89e8ea6b-672c-4e29-9cbb-f812f5da429c ==============================
15:41:46.899369 [info ] [MainThread]: Running with dbt=1.1.0
15:41:46.899780 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:41:46.899871 [debug] [MainThread]: Tracking: tracking
15:41:46.902361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f94f69d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f94f6070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f94f6190>]}
15:41:46.918794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
15:41:46.919101 [debug] [MainThread]: Partial parsing: added file: first_project://models/customers2.sql
15:41:46.928701 [debug] [MainThread]: 1699: static parser successfully parsed customers2.sql
15:41:46.941306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89e8ea6b-672c-4e29-9cbb-f812f5da429c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f8f4b0d0>]}
15:41:46.944498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89e8ea6b-672c-4e29-9cbb-f812f5da429c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f93d9eb0>]}
15:41:46.944845 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:41:46.945152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89e8ea6b-672c-4e29-9cbb-f812f5da429c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f94fcd30>]}
15:41:46.946304 [info ] [MainThread]: 
15:41:46.946686 [debug] [MainThread]: Acquiring new postgres connection "master"
15:41:46.947649 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
15:41:46.954705 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
15:41:46.954857 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
15:41:46.954938 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:41:46.965151 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
15:41:46.970381 [debug] [ThreadPool]: On list_erp_oltp: Close
15:41:46.972839 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
15:41:46.976508 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
15:41:46.976614 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
15:41:46.976673 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:41:46.981347 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
15:41:46.981617 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
15:41:46.981696 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:41:46.983386 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
15:41:46.984283 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
15:41:46.984566 [debug] [ThreadPool]: On list_erp_oltp_public: Close
15:41:47.009164 [debug] [MainThread]: Using postgres connection "master"
15:41:47.009320 [debug] [MainThread]: On master: BEGIN
15:41:47.009380 [debug] [MainThread]: Opening a new connection, currently in state init
15:41:47.014557 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:41:47.014751 [debug] [MainThread]: Using postgres connection "master"
15:41:47.014820 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:41:47.025383 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
15:41:47.026204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89e8ea6b-672c-4e29-9cbb-f812f5da429c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f94d3c10>]}
15:41:47.026468 [debug] [MainThread]: On master: ROLLBACK
15:41:47.026739 [debug] [MainThread]: Using postgres connection "master"
15:41:47.026825 [debug] [MainThread]: On master: BEGIN
15:41:47.027175 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:41:47.027261 [debug] [MainThread]: On master: COMMIT
15:41:47.027353 [debug] [MainThread]: Using postgres connection "master"
15:41:47.027420 [debug] [MainThread]: On master: COMMIT
15:41:47.027598 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:41:47.027684 [debug] [MainThread]: On master: Close
15:41:47.027943 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
15:41:47.028073 [info ] [MainThread]: 
15:41:47.030534 [debug] [Thread-1  ]: Began running node model.first_project.customers
15:41:47.030742 [info ] [Thread-1  ]: 1 of 4 START table model public.customers ...................................... [RUN]
15:41:47.031014 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
15:41:47.031095 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
15:41:47.031164 [debug] [Thread-1  ]: Compiling model.first_project.customers
15:41:47.031899 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
15:41:47.032148 [debug] [Thread-1  ]: finished collecting timing info
15:41:47.032252 [debug] [Thread-1  ]: Began executing node model.first_project.customers
15:41:47.038994 [debug] [Thread-2  ]: Began running node model.first_project.customers2
15:41:47.039154 [info ] [Thread-2  ]: 2 of 4 START table model public.customers2 ..................................... [RUN]
15:41:47.039401 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers2"
15:41:47.039485 [debug] [Thread-2  ]: Began compiling node model.first_project.customers2
15:41:47.039550 [debug] [Thread-2  ]: Compiling model.first_project.customers2
15:41:47.040740 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers2"
15:41:47.040911 [debug] [Thread-3  ]: Began running node model.first_project.my_first_dbt_model
15:41:47.041107 [info ] [Thread-3  ]: 3 of 4 START table model public.my_first_dbt_model ............................. [RUN]
15:41:47.041351 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
15:41:47.041429 [debug] [Thread-3  ]: Began compiling node model.first_project.my_first_dbt_model
15:41:47.041527 [debug] [Thread-3  ]: Compiling model.first_project.my_first_dbt_model
15:41:47.042639 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
15:41:47.042908 [debug] [Thread-2  ]: finished collecting timing info
15:41:47.043053 [debug] [Thread-2  ]: Began executing node model.first_project.customers2
15:41:47.043130 [debug] [Thread-3  ]: finished collecting timing info
15:41:47.058308 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
15:41:47.065017 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:41:47.065277 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
15:41:47.065350 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:41:47.058538 [debug] [Thread-3  ]: Began executing node model.first_project.my_first_dbt_model
15:41:47.070097 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
15:41:47.070583 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.customers2"
15:41:47.070770 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:41:47.076076 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
15:41:47.076417 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:41:47.076572 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: BEGIN
15:41:47.076795 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:41:47.077285 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select
 codigo_cliente as customer_id,
 nome as first_name,
 sobrenome as last_name,
 codigo_regiao as region_code
 from erp_oltp.public.clientes
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
15:41:47.076705 [debug] [Thread-2  ]: On model.first_project.customers2: BEGIN
15:41:47.077153 [debug] [Thread-3  ]: Opening a new connection, currently in state init
15:41:47.077447 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:41:47.080932 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
15:41:47.085637 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:41:47.085824 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
15:41:47.088257 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:41:47.089851 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:41:47.089970 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
15:41:47.090436 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:41:47.090569 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
15:41:47.096187 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
15:41:47.096282 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select
 codigo_cliente as customer_id,
 nome as first_name,
 sobrenome as last_name,
 codigo_regiao as region_code
 from erp_oltp.public.clientes
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
15:41:47.096383 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
15:41:47.103750 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:41:47.103853 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:41:47.104736 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.0 seconds
15:41:47.103506 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
15:41:47.107121 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:41:47.106969 [debug] [Thread-2  ]: SQL status: SELECT 100 in 0.0 seconds
15:41:47.106851 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:41:47.108677 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:41:47.108452 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
15:41:47.108823 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
15:41:47.109018 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
15:41:47.110354 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:41:47.109197 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
15:41:47.110451 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:41:47.111917 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
15:41:47.111552 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
15:41:47.112733 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
15:41:47.113051 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:41:47.112852 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
15:41:47.107208 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
15:41:47.113444 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
15:41:47.113153 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
15:41:47.114446 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
15:41:47.114715 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
15:41:47.114832 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
15:41:47.116983 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:41:47.120402 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:41:47.120526 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
15:41:47.120625 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
15:41:47.122527 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:41:47.123635 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
15:41:47.123482 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
15:41:47.123779 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
15:41:47.120783 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
15:41:47.124882 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
15:41:47.125674 [debug] [Thread-2  ]: finished collecting timing info
15:41:47.125793 [debug] [Thread-2  ]: On model.first_project.customers2: Close
15:41:47.125897 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
15:41:47.126710 [debug] [Thread-3  ]: finished collecting timing info
15:41:47.126818 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: Close
15:41:47.127533 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89e8ea6b-672c-4e29-9cbb-f812f5da429c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f8eecb80>]}
15:41:47.127799 [info ] [Thread-2  ]: 2 of 4 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.09s]
15:41:47.128034 [debug] [Thread-2  ]: Finished running node model.first_project.customers2
15:41:47.128478 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89e8ea6b-672c-4e29-9cbb-f812f5da429c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f8684820>]}
15:41:47.128717 [info ] [Thread-3  ]: 3 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.09s]
15:41:47.125976 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:41:47.129481 [debug] [Thread-1  ]: finished collecting timing info
15:41:47.129777 [debug] [Thread-1  ]: On model.first_project.customers: Close
15:41:47.129699 [debug] [Thread-3  ]: Finished running node model.first_project.my_first_dbt_model
15:41:47.131677 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89e8ea6b-672c-4e29-9cbb-f812f5da429c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f9486100>]}
15:41:47.131853 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
15:41:47.132159 [info ] [Thread-1  ]: 1 of 4 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.10s]
15:41:47.132366 [info ] [Thread-5  ]: 4 of 4 START view model public.my_second_dbt_model ............................. [RUN]
15:41:47.132754 [debug] [Thread-1  ]: Finished running node model.first_project.customers
15:41:47.132976 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
15:41:47.133191 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
15:41:47.133277 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
15:41:47.134792 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
15:41:47.135050 [debug] [Thread-5  ]: finished collecting timing info
15:41:47.135166 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
15:41:47.165641 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
15:41:47.166203 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:41:47.166330 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
15:41:47.166420 [debug] [Thread-5  ]: Opening a new connection, currently in state init
15:41:47.171043 [debug] [Thread-5  ]: SQL status: BEGIN in 0.0 seconds
15:41:47.171240 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:41:47.171313 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
15:41:47.172258 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
15:41:47.173775 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:41:47.173869 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:41:47.174098 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
15:41:47.174813 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
15:41:47.174899 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:41:47.174960 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
15:41:47.176039 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
15:41:47.176921 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:41:47.177000 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
15:41:47.177203 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
15:41:47.177799 [debug] [Thread-5  ]: finished collecting timing info
15:41:47.177903 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
15:41:47.178195 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89e8ea6b-672c-4e29-9cbb-f812f5da429c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99f8648fa0>]}
15:41:47.178414 [info ] [Thread-5  ]: 4 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
15:41:47.178640 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
15:41:47.179656 [debug] [MainThread]: Acquiring new postgres connection "master"
15:41:47.179764 [debug] [MainThread]: Using postgres connection "master"
15:41:47.179828 [debug] [MainThread]: On master: BEGIN
15:41:47.179885 [debug] [MainThread]: Opening a new connection, currently in state closed
15:41:47.185430 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:41:47.185665 [debug] [MainThread]: On master: COMMIT
15:41:47.185735 [debug] [MainThread]: Using postgres connection "master"
15:41:47.185800 [debug] [MainThread]: On master: COMMIT
15:41:47.185995 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:41:47.186110 [debug] [MainThread]: On master: Close
15:41:47.186449 [info ] [MainThread]: 
15:41:47.186618 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0.24s.
15:41:47.186741 [debug] [MainThread]: Connection 'master' was properly closed.
15:41:47.186794 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
15:41:47.186855 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
15:41:47.186904 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
15:41:47.186992 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
15:41:47.190149 [info ] [MainThread]: 
15:41:47.190411 [info ] [MainThread]: [32mCompleted successfully[0m
15:41:47.190548 [info ] [MainThread]: 
15:41:47.190644 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
15:41:47.190834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99fad0e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99fb5e03d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99fb2f0bb0>]}


============================== 2022-06-07 15:42:13.741486 | bad02862-1747-492b-b3d4-9513bec3c9b4 ==============================
15:42:13.741497 [info ] [MainThread]: Running with dbt=1.1.0
15:42:13.741914 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:42:13.742053 [debug] [MainThread]: Tracking: tracking
15:42:13.744312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0104bc0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0104bca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0104bcbe0>]}
15:42:13.765114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:42:13.765321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:42:13.769407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bad02862-1747-492b-b3d4-9513bec3c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0103550d0>]}
15:42:13.774300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bad02862-1747-492b-b3d4-9513bec3c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe010412160>]}
15:42:13.774611 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:42:13.774780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bad02862-1747-492b-b3d4-9513bec3c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe01043ff40>]}
15:42:13.783217 [info ] [MainThread]: 
15:42:13.783730 [debug] [MainThread]: Acquiring new postgres connection "master"
15:42:13.784884 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
15:42:13.790761 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
15:42:13.790947 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
15:42:13.791051 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:42:13.796327 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
15:42:13.797571 [debug] [ThreadPool]: On list_erp_oltp: Close
15:42:13.800420 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
15:42:13.811783 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
15:42:13.812002 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
15:42:13.812073 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:42:13.816392 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
15:42:13.816576 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
15:42:13.816641 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:42:13.818046 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
15:42:13.818987 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
15:42:13.819171 [debug] [ThreadPool]: On list_erp_oltp_public: Close
15:42:13.821944 [debug] [MainThread]: Using postgres connection "master"
15:42:13.822097 [debug] [MainThread]: On master: BEGIN
15:42:13.822190 [debug] [MainThread]: Opening a new connection, currently in state init
15:42:13.826167 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:42:13.826283 [debug] [MainThread]: Using postgres connection "master"
15:42:13.826352 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:42:13.834715 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
15:42:13.835718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bad02862-1747-492b-b3d4-9513bec3c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0104c21c0>]}
15:42:13.835965 [debug] [MainThread]: On master: ROLLBACK
15:42:13.836179 [debug] [MainThread]: Using postgres connection "master"
15:42:13.836274 [debug] [MainThread]: On master: BEGIN
15:42:13.836490 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:42:13.836584 [debug] [MainThread]: On master: COMMIT
15:42:13.836648 [debug] [MainThread]: Using postgres connection "master"
15:42:13.836709 [debug] [MainThread]: On master: COMMIT
15:42:13.836826 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:42:13.836910 [debug] [MainThread]: On master: Close
15:42:13.837252 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
15:42:13.837431 [info ] [MainThread]: 
15:42:13.843103 [debug] [Thread-1  ]: Began running node model.first_project.customers
15:42:13.843378 [info ] [Thread-1  ]: 1 of 4 START table model public.customers ...................................... [RUN]
15:42:13.843660 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
15:42:13.843747 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
15:42:13.843854 [debug] [Thread-1  ]: Compiling model.first_project.customers
15:42:13.844675 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
15:42:13.844907 [debug] [Thread-1  ]: finished collecting timing info
15:42:13.845030 [debug] [Thread-1  ]: Began executing node model.first_project.customers
15:42:13.855063 [debug] [Thread-2  ]: Began running node model.first_project.customers2
15:42:13.855352 [debug] [Thread-3  ]: Began running node model.first_project.my_first_dbt_model
15:42:13.855671 [info ] [Thread-2  ]: 2 of 4 START table model public.customers2 ..................................... [RUN]
15:42:13.905110 [info ] [Thread-3  ]: 3 of 4 START table model public.my_first_dbt_model ............................. [RUN]
15:42:13.907065 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
15:42:13.907145 [debug] [Thread-3  ]: Began compiling node model.first_project.my_first_dbt_model
15:42:13.906766 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers2"
15:42:13.907369 [debug] [Thread-2  ]: Began compiling node model.first_project.customers2
15:42:13.907455 [debug] [Thread-2  ]: Compiling model.first_project.customers2
15:42:13.907210 [debug] [Thread-3  ]: Compiling model.first_project.my_first_dbt_model
15:42:13.908636 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers2"
15:42:13.910295 [debug] [Thread-2  ]: finished collecting timing info
15:42:13.910419 [debug] [Thread-2  ]: Began executing node model.first_project.customers2
15:42:13.909948 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
15:42:13.912200 [debug] [Thread-3  ]: finished collecting timing info
15:42:13.912335 [debug] [Thread-3  ]: Began executing node model.first_project.my_first_dbt_model
15:42:13.911723 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.customers2"
15:42:13.914241 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
15:42:13.913904 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
15:42:13.914787 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:42:13.914871 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: BEGIN
15:42:13.914404 [debug] [Thread-2  ]: On model.first_project.customers2: BEGIN
15:42:13.914932 [debug] [Thread-3  ]: Opening a new connection, currently in state init
15:42:13.906313 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
15:42:13.915079 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:42:13.916914 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:42:13.917018 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
15:42:13.917096 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:42:13.920693 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
15:42:13.920807 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
15:42:13.920868 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select
 codigo_cliente as customer_id,
 nome as first_name,
 sobrenome as last_name,
 codigo_regiao as region_code
 from erp_oltp.public.clientes
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
15:42:13.923543 [debug] [Thread-2  ]: SQL status: SELECT 100 in 0.0 seconds
15:42:13.927303 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
15:42:13.927399 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
15:42:13.927857 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
15:42:13.929050 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
15:42:13.929159 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
15:42:13.929420 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
15:42:13.938402 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
15:42:13.940406 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
15:42:13.941121 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
15:42:13.941254 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:42:13.941480 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:42:13.941607 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
15:42:13.941682 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:42:13.941733 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select
 codigo_cliente as customer_id,
 nome as first_name,
 sobrenome as last_name,
 codigo_regiao as region_code
 from erp_oltp.public.clientes
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
15:42:13.942384 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.0 seconds
15:42:13.943714 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:42:13.943799 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:42:13.941375 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
15:42:13.945566 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
15:42:13.948990 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
15:42:13.949189 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
15:42:13.950796 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
15:42:13.951717 [debug] [Thread-2  ]: finished collecting timing info
15:42:13.951862 [debug] [Thread-2  ]: On model.first_project.customers2: Close
15:42:13.952046 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
15:42:13.953530 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:42:13.953628 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:42:13.953921 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bad02862-1747-492b-b3d4-9513bec3c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0122ab2e0>]}
15:42:13.954052 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.01 seconds
15:42:13.955943 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:42:13.956034 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
15:42:13.954382 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
15:42:13.954677 [info ] [Thread-2  ]: 2 of 4 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.05s]
15:42:13.956913 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
15:42:13.957645 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:42:13.957725 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
15:42:13.957007 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:42:13.958048 [debug] [Thread-2  ]: Finished running node model.first_project.customers2
15:42:13.959450 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:42:13.959733 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
15:42:13.959555 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
15:42:13.960697 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:42:13.960782 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
15:42:13.960878 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:42:13.961791 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
15:42:13.961910 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:42:13.961992 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
15:42:13.962568 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
15:42:13.963268 [debug] [Thread-3  ]: finished collecting timing info
15:42:13.963430 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: Close
15:42:13.964355 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:42:13.965511 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:42:13.965613 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
15:42:13.966841 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bad02862-1747-492b-b3d4-9513bec3c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0104b1460>]}
15:42:13.967096 [info ] [Thread-3  ]: 3 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.06s]
15:42:13.967481 [debug] [Thread-3  ]: Finished running node model.first_project.my_first_dbt_model
15:42:13.968271 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
15:42:13.968460 [info ] [Thread-5  ]: 4 of 4 START view model public.my_second_dbt_model ............................. [RUN]
15:42:13.968760 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
15:42:13.968890 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
15:42:13.968973 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
15:42:13.973043 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
15:42:13.973474 [debug] [Thread-5  ]: finished collecting timing info
15:42:13.973686 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
15:42:13.984084 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
15:42:13.985553 [debug] [Thread-1  ]: finished collecting timing info
15:42:13.985842 [debug] [Thread-1  ]: On model.first_project.customers: Close
15:42:13.986441 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bad02862-1747-492b-b3d4-9513bec3c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe010412100>]}
15:42:13.986722 [info ] [Thread-1  ]: 1 of 4 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.14s]
15:42:13.986973 [debug] [Thread-1  ]: Finished running node model.first_project.customers
15:42:13.990597 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
15:42:13.990885 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:42:13.990985 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
15:42:13.991049 [debug] [Thread-5  ]: Opening a new connection, currently in state init
15:42:13.995852 [debug] [Thread-5  ]: SQL status: BEGIN in 0.0 seconds
15:42:13.995986 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:42:13.996077 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
15:42:13.997651 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
15:42:13.999655 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:42:13.999805 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:42:14.000270 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
15:42:14.001056 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
15:42:14.001206 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:42:14.001269 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
15:42:14.003083 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
15:42:14.004126 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:42:14.004234 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
15:42:14.009735 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.01 seconds
15:42:14.011005 [debug] [Thread-5  ]: finished collecting timing info
15:42:14.011209 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
15:42:14.011724 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bad02862-1747-492b-b3d4-9513bec3c9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00c28c6a0>]}
15:42:14.012019 [info ] [Thread-5  ]: 4 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
15:42:14.013245 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
15:42:14.015009 [debug] [MainThread]: Acquiring new postgres connection "master"
15:42:14.015194 [debug] [MainThread]: Using postgres connection "master"
15:42:14.015261 [debug] [MainThread]: On master: BEGIN
15:42:14.015320 [debug] [MainThread]: Opening a new connection, currently in state closed
15:42:14.022436 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:42:14.022597 [debug] [MainThread]: On master: COMMIT
15:42:14.022663 [debug] [MainThread]: Using postgres connection "master"
15:42:14.022732 [debug] [MainThread]: On master: COMMIT
15:42:14.023061 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:42:14.023165 [debug] [MainThread]: On master: Close
15:42:14.023457 [info ] [MainThread]: 
15:42:14.023595 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0.24s.
15:42:14.023697 [debug] [MainThread]: Connection 'master' was properly closed.
15:42:14.023749 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
15:42:14.023799 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
15:42:14.023848 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
15:42:14.023896 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
15:42:14.026496 [info ] [MainThread]: 
15:42:14.026648 [info ] [MainThread]: [32mCompleted successfully[0m
15:42:14.026782 [info ] [MainThread]: 
15:42:14.026873 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
15:42:14.027049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe010333fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe010333fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe00c272f40>]}


============================== 2022-06-07 15:48:16.620269 | 3293e99c-6123-460c-826f-cd4838fb6324 ==============================
15:48:16.620281 [info ] [MainThread]: Running with dbt=1.1.0
15:48:16.620686 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:48:16.620777 [debug] [MainThread]: Tracking: tracking
15:48:16.623184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b2817f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b28171f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b2817d90>]}
15:48:16.638165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b2817c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b2701400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b2701580>]}


============================== 2022-06-07 15:52:13.638055 | e68ff608-b1a4-46ec-8c59-e37a0f085c85 ==============================
15:52:13.638067 [info ] [MainThread]: Running with dbt=1.1.0
15:52:13.638374 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:52:13.638456 [debug] [MainThread]: Tracking: tracking
15:52:13.640787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704aac45e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704aac41f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704aac4d90>]}
15:52:13.656883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
15:52:13.657173 [debug] [MainThread]: Partial parsing: added file: first_project://models/postgres_sample_source/postgres_sample_source_customers.sql
15:52:13.657355 [debug] [MainThread]: Partial parsing: added file: first_project://models/postgres_sample_source/schema.yml
15:52:13.664936 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
15:52:13.686863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e68ff608-b1a4-46ec-8c59-e37a0f085c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704a94fca0>]}
15:52:13.711299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e68ff608-b1a4-46ec-8c59-e37a0f085c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704cc8ea60>]}
15:52:13.711552 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
15:52:13.711689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e68ff608-b1a4-46ec-8c59-e37a0f085c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704cc8e8b0>]}
15:52:13.712637 [info ] [MainThread]: 
15:52:13.712979 [debug] [MainThread]: Acquiring new postgres connection "master"
15:52:13.713790 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
15:52:13.719420 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
15:52:13.719530 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
15:52:13.719595 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:52:13.733926 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
15:52:13.734860 [debug] [ThreadPool]: On list_erp_oltp: Close
15:52:13.735944 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
15:52:13.739430 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
15:52:13.739596 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
15:52:13.739663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:52:13.745019 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
15:52:13.745254 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
15:52:13.745322 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
15:52:13.747076 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
15:52:13.748065 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
15:52:13.748396 [debug] [ThreadPool]: On list_erp_oltp_public: Close
15:52:13.751183 [debug] [MainThread]: Using postgres connection "master"
15:52:13.751280 [debug] [MainThread]: On master: BEGIN
15:52:13.751339 [debug] [MainThread]: Opening a new connection, currently in state init
15:52:13.762006 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
15:52:13.762216 [debug] [MainThread]: Using postgres connection "master"
15:52:13.762286 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:52:13.771201 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
15:52:13.772232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e68ff608-b1a4-46ec-8c59-e37a0f085c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704c3119d0>]}
15:52:13.772460 [debug] [MainThread]: On master: ROLLBACK
15:52:13.773244 [debug] [MainThread]: Using postgres connection "master"
15:52:13.773355 [debug] [MainThread]: On master: BEGIN
15:52:13.773790 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:52:13.773889 [debug] [MainThread]: On master: COMMIT
15:52:13.773954 [debug] [MainThread]: Using postgres connection "master"
15:52:13.774007 [debug] [MainThread]: On master: COMMIT
15:52:13.774219 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:52:13.774335 [debug] [MainThread]: On master: Close
15:52:13.774621 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
15:52:13.774810 [info ] [MainThread]: 
15:52:13.779108 [debug] [Thread-1  ]: Began running node model.first_project.customers
15:52:13.779315 [info ] [Thread-1  ]: 1 of 5 START table model public.customers ...................................... [RUN]
15:52:13.779578 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
15:52:13.779675 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
15:52:13.779768 [debug] [Thread-1  ]: Compiling model.first_project.customers
15:52:13.780618 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
15:52:13.780894 [debug] [Thread-1  ]: finished collecting timing info
15:52:13.781031 [debug] [Thread-1  ]: Began executing node model.first_project.customers
15:52:13.787038 [debug] [Thread-2  ]: Began running node model.first_project.customers2
15:52:13.787220 [info ] [Thread-2  ]: 2 of 5 START table model public.customers2 ..................................... [RUN]
15:52:13.787393 [debug] [Thread-3  ]: Began running node model.first_project.my_first_dbt_model
15:52:13.787605 [info ] [Thread-3  ]: 3 of 5 START table model public.my_first_dbt_model ............................. [RUN]
15:52:13.787743 [debug] [Thread-4  ]: Began running node model.first_project.postgres_sample_source_customers
15:52:13.787856 [info ] [Thread-4  ]: 4 of 5 START view model public.postgres_sample_source_customers ................ [RUN]
15:52:13.788120 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers2"
15:52:13.793584 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
15:52:13.800015 [debug] [Thread-3  ]: Began compiling node model.first_project.my_first_dbt_model
15:52:13.799712 [debug] [Thread-2  ]: Began compiling node model.first_project.customers2
15:52:13.793756 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
15:52:13.811757 [debug] [Thread-4  ]: Began compiling node model.first_project.postgres_sample_source_customers
15:52:13.811373 [debug] [Thread-2  ]: Compiling model.first_project.customers2
15:52:13.800120 [debug] [Thread-3  ]: Compiling model.first_project.my_first_dbt_model
15:52:13.820083 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
15:52:13.820353 [debug] [Thread-3  ]: finished collecting timing info
15:52:13.818747 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers2"
15:52:13.820516 [debug] [Thread-3  ]: Began executing node model.first_project.my_first_dbt_model
15:52:13.811921 [debug] [Thread-4  ]: Compiling model.first_project.postgres_sample_source_customers
15:52:13.817277 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
15:52:13.823327 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
15:52:13.823549 [debug] [Thread-2  ]: finished collecting timing info
15:52:13.825059 [debug] [Thread-2  ]: Began executing node model.first_project.customers2
15:52:13.826347 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.customers2"
15:52:13.826584 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
15:52:13.824753 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
15:52:13.826683 [debug] [Thread-2  ]: On model.first_project.customers2: BEGIN
15:52:13.827570 [debug] [Thread-2  ]: Opening a new connection, currently in state init
15:52:13.826926 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:52:13.827408 [debug] [Thread-4  ]: finished collecting timing info
15:52:13.827226 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:52:13.827792 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: BEGIN
15:52:13.828295 [debug] [Thread-4  ]: Began executing node model.first_project.postgres_sample_source_customers
15:52:13.828504 [debug] [Thread-3  ]: Opening a new connection, currently in state init
15:52:13.828417 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
15:52:13.839267 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
15:52:13.839869 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
15:52:13.839956 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
15:52:13.840058 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select
 codigo_cliente as customer_id,
 nome as first_name,
 sobrenome as last_name,
 codigo_regiao as region_code
 from erp_oltp.public.clientes
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
15:52:13.840256 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
15:52:13.840348 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: BEGIN
15:52:13.840407 [debug] [Thread-4  ]: Opening a new connection, currently in state init
15:52:13.839507 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:52:13.841829 [debug] [Thread-2  ]: SQL status: SELECT 100 in 0.0 seconds
15:52:13.846352 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
15:52:13.846508 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
15:52:13.846780 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
15:52:13.846970 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
15:52:13.847061 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
15:52:13.847232 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
15:52:13.847360 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:52:13.847419 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
15:52:13.847502 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
15:52:13.848953 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
15:52:13.849089 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
15:52:13.849320 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
15:52:13.850534 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
15:52:13.850916 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
15:52:13.850702 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.0 seconds
15:52:13.852163 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:52:13.852248 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
15:52:13.852341 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
15:52:13.852449 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
15:52:13.856297 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:52:13.856087 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: COMMIT
15:52:13.856377 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select
 codigo_cliente as customer_id,
 nome as first_name,
 sobrenome as last_name,
 codigo_regiao as region_code
 from erp_oltp.public.clientes
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
15:52:13.856438 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
15:52:13.857843 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:52:13.856597 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
15:52:13.857928 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
15:52:13.856484 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
15:52:13.858153 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: COMMIT
15:52:13.861397 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
15:52:13.861698 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
15:52:13.863655 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:52:13.863777 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
15:52:13.861776 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
15:52:13.866129 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
15:52:13.866210 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:52:13.866264 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
15:52:13.865249 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
15:52:13.869087 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
15:52:13.869215 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
15:52:13.869558 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
15:52:13.870907 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:52:13.870992 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
15:52:13.871155 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
15:52:13.873054 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
15:52:13.873184 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
15:52:13.861886 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
15:52:13.873891 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
15:52:13.874331 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:52:13.876109 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
15:52:13.876215 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:52:13.876275 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
15:52:13.876724 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
15:52:13.877619 [debug] [Thread-3  ]: finished collecting timing info
15:52:13.877717 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: Close
15:52:13.877980 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e68ff608-b1a4-46ec-8c59-e37a0f085c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7048489160>]}
15:52:13.878220 [info ] [Thread-3  ]: 3 of 5 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
15:52:13.878452 [debug] [Thread-3  ]: Finished running node model.first_project.my_first_dbt_model
15:52:13.878700 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
15:52:13.878833 [info ] [Thread-6  ]: 5 of 5 START view model public.my_second_dbt_model ............................. [RUN]
15:52:13.879057 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
15:52:13.879167 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
15:52:13.879238 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
15:52:13.880451 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
15:52:13.880694 [debug] [Thread-6  ]: finished collecting timing info
15:52:13.880826 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
15:52:13.883096 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
15:52:13.883410 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:52:13.883529 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
15:52:13.883592 [debug] [Thread-6  ]: Opening a new connection, currently in state init
15:52:13.885354 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
15:52:13.886319 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
15:52:13.886404 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
15:52:13.887147 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.02 seconds
15:52:13.888635 [debug] [Thread-4  ]: finished collecting timing info
15:52:13.888883 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
15:52:13.890994 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
15:52:13.891132 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
15:52:13.888969 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
15:52:13.889215 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: Close
15:52:13.894881 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e68ff608-b1a4-46ec-8c59-e37a0f085c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70483fa910>]}
15:52:13.895118 [info ] [Thread-4  ]: 4 of 5 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.10s]
15:52:13.895349 [debug] [Thread-4  ]: Finished running node model.first_project.postgres_sample_source_customers
15:52:13.894468 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:52:13.896262 [debug] [Thread-1  ]: finished collecting timing info
15:52:13.896374 [debug] [Thread-1  ]: On model.first_project.customers: Close
15:52:13.896624 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e68ff608-b1a4-46ec-8c59-e37a0f085c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704a4faf70>]}
15:52:13.898200 [info ] [Thread-1  ]: 1 of 5 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.12s]
15:52:13.898444 [debug] [Thread-1  ]: Finished running node model.first_project.customers
15:52:13.894315 [debug] [Thread-2  ]: finished collecting timing info
15:52:13.904705 [debug] [Thread-2  ]: On model.first_project.customers2: Close
15:52:13.907295 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e68ff608-b1a4-46ec-8c59-e37a0f085c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704aa542e0>]}
15:52:13.907898 [info ] [Thread-2  ]: 2 of 5 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.12s]
15:52:13.908312 [debug] [Thread-2  ]: Finished running node model.first_project.customers2
15:52:13.912208 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
15:52:13.912422 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:52:13.912540 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
15:52:13.915488 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
15:52:13.917133 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:52:13.917257 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
15:52:13.917522 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
15:52:13.918414 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
15:52:13.918498 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:52:13.918555 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
15:52:13.919590 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
15:52:13.920484 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
15:52:13.920566 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
15:52:13.920743 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
15:52:13.921410 [debug] [Thread-6  ]: finished collecting timing info
15:52:13.921512 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
15:52:13.921783 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e68ff608-b1a4-46ec-8c59-e37a0f085c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704846fca0>]}
15:52:13.922023 [info ] [Thread-6  ]: 5 of 5 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
15:52:13.923051 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
15:52:13.924210 [debug] [MainThread]: Acquiring new postgres connection "master"
15:52:13.924320 [debug] [MainThread]: Using postgres connection "master"
15:52:13.924388 [debug] [MainThread]: On master: BEGIN
15:52:13.924443 [debug] [MainThread]: Opening a new connection, currently in state closed
15:52:13.928377 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:52:13.928508 [debug] [MainThread]: On master: COMMIT
15:52:13.928569 [debug] [MainThread]: Using postgres connection "master"
15:52:13.928624 [debug] [MainThread]: On master: COMMIT
15:52:13.928857 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:52:13.928960 [debug] [MainThread]: On master: Close
15:52:13.929291 [info ] [MainThread]: 
15:52:13.929455 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0.22s.
15:52:13.929563 [debug] [MainThread]: Connection 'master' was properly closed.
15:52:13.929628 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
15:52:13.929723 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
15:52:13.929786 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
15:52:13.929836 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
15:52:13.929886 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
15:52:13.932976 [info ] [MainThread]: 
15:52:13.933308 [info ] [MainThread]: [32mCompleted successfully[0m
15:52:13.933481 [info ] [MainThread]: 
15:52:13.933649 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
15:52:13.933873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704a97d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704a97d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704cc1e370>]}


============================== 2022-06-07 15:54:59.124469 | 95d457ec-2331-4cd7-863a-519b53ff2dc2 ==============================
15:54:59.124485 [info ] [MainThread]: Running with dbt=1.1.0
15:54:59.124933 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:54:59.125038 [debug] [MainThread]: Tracking: tracking
15:54:59.127981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe638620af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe638620e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe638620b20>]}
15:54:59.145165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
15:54:59.145477 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/stag_customers.sql
15:54:59.145634 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
15:54:59.155659 [debug] [MainThread]: 1699: static parser successfully parsed erp/stag_customers.sql
15:54:59.164485 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
15:54:59.165722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe638510c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6384abdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6384dedf0>]}


============================== 2022-06-07 16:03:34.882034 | 3461b054-9093-45c2-895b-989f3b17f560 ==============================
16:03:34.882046 [info ] [MainThread]: Running with dbt=1.1.0
16:03:34.882361 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:03:34.882454 [debug] [MainThread]: Tracking: tracking
16:03:34.885124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f311e7f2160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f311e7f2e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f311e7f2eb0>]}
16:03:34.902719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
16:03:34.903027 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/stg_customers.sql
16:03:34.903225 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
16:03:34.911122 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
16:03:34.920196 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
16:03:34.926639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3461b054-9093-45c2-895b-989f3b17f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f311e2540d0>]}
16:03:34.931585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3461b054-9093-45c2-895b-989f3b17f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f311e6deee0>]}
16:03:34.931984 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
16:03:34.932178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3461b054-9093-45c2-895b-989f3b17f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f311e6de6a0>]}
16:03:34.933338 [info ] [MainThread]: 
16:03:34.933734 [debug] [MainThread]: Acquiring new postgres connection "master"
16:03:34.934602 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:03:34.945670 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:03:34.945975 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:03:34.946065 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:03:34.954548 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:03:34.955522 [debug] [ThreadPool]: On list_erp_oltp: Close
16:03:34.963550 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:03:34.995235 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:03:34.995437 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:03:34.995506 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:03:34.999362 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
16:03:34.999515 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:03:34.999582 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:03:35.000983 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
16:03:35.001881 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:03:35.002042 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:03:35.004696 [debug] [MainThread]: Using postgres connection "master"
16:03:35.004812 [debug] [MainThread]: On master: BEGIN
16:03:35.004882 [debug] [MainThread]: Opening a new connection, currently in state init
16:03:35.008499 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:03:35.008640 [debug] [MainThread]: Using postgres connection "master"
16:03:35.008709 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:03:35.017337 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
16:03:35.018411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3461b054-9093-45c2-895b-989f3b17f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f312094d220>]}
16:03:35.018687 [debug] [MainThread]: On master: ROLLBACK
16:03:35.019006 [debug] [MainThread]: Using postgres connection "master"
16:03:35.019199 [debug] [MainThread]: On master: BEGIN
16:03:35.021178 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:03:35.021310 [debug] [MainThread]: On master: COMMIT
16:03:35.021394 [debug] [MainThread]: Using postgres connection "master"
16:03:35.021453 [debug] [MainThread]: On master: COMMIT
16:03:35.021591 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:03:35.021678 [debug] [MainThread]: On master: Close
16:03:35.021952 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:03:35.022105 [info ] [MainThread]: 
16:03:35.030309 [debug] [Thread-1  ]: Began running node model.first_project.customers2
16:03:35.030571 [info ] [Thread-1  ]: 1 of 6 START table model public.customers2 ..................................... [RUN]
16:03:35.030890 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers2"
16:03:35.030994 [debug] [Thread-1  ]: Began compiling node model.first_project.customers2
16:03:35.031068 [debug] [Thread-1  ]: Compiling model.first_project.customers2
16:03:35.032544 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers2"
16:03:35.032801 [debug] [Thread-1  ]: finished collecting timing info
16:03:35.032889 [debug] [Thread-1  ]: Began executing node model.first_project.customers2
16:03:35.040197 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:03:35.040559 [info ] [Thread-2  ]: 2 of 6 START table model public.my_first_dbt_model ............................. [RUN]
16:03:35.041199 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:03:35.041868 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:03:35.041990 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:03:35.045453 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:03:35.045798 [debug] [Thread-2  ]: finished collecting timing info
16:03:35.049330 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:03:35.056668 [debug] [Thread-3  ]: Began running node model.first_project.postgres_sample_source_customers
16:03:35.057007 [info ] [Thread-3  ]: 3 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
16:03:35.057351 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
16:03:35.065269 [debug] [Thread-3  ]: Began compiling node model.first_project.postgres_sample_source_customers
16:03:35.070784 [debug] [Thread-3  ]: Compiling model.first_project.postgres_sample_source_customers
16:03:35.072717 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
16:03:35.072960 [debug] [Thread-4  ]: Began running node model.first_project.stg_customers
16:03:35.079539 [info ] [Thread-4  ]: 4 of 6 START table model public.stg_customers .................................. [RUN]
16:03:35.079979 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_customers"
16:03:35.080065 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_customers
16:03:35.080135 [debug] [Thread-4  ]: Compiling model.first_project.stg_customers
16:03:35.080972 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_customers"
16:03:35.081277 [debug] [Thread-4  ]: finished collecting timing info
16:03:35.081375 [debug] [Thread-4  ]: Began executing node model.first_project.stg_customers
16:03:35.105200 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_customers"
16:03:35.105529 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
16:03:35.105620 [debug] [Thread-4  ]: On model.first_project.stg_customers: BEGIN
16:03:35.105681 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:03:35.107590 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers2"
16:03:35.114238 [debug] [Thread-3  ]: finished collecting timing info
16:03:35.114521 [debug] [Thread-3  ]: Began executing node model.first_project.postgres_sample_source_customers
16:03:35.132646 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:03:35.132999 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:03:35.133342 [debug] [Thread-1  ]: On model.first_project.customers2: BEGIN
16:03:35.133431 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:03:35.133819 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:03:35.133966 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:03:35.134050 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:03:35.151106 [debug] [Thread-4  ]: SQL status: BEGIN in 0.05 seconds
16:03:35.151350 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
16:03:35.151422 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
 select
 codigo_cliente as customer_id,
 nome as first_name,
 sobrenome as last_name,
 codigo_regiao as region_code
 from erp_oltp.public.clientes
),
select * from customers
  );
16:03:35.151763 [debug] [Thread-4  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 14: select * from customers
         ^

16:03:35.151910 [debug] [Thread-4  ]: On model.first_project.stg_customers: ROLLBACK
16:03:35.152236 [debug] [Thread-4  ]: finished collecting timing info
16:03:35.152338 [debug] [Thread-4  ]: On model.first_project.stg_customers: Close
16:03:35.152615 [debug] [Thread-4  ]: Database Error in model stg_customers (models/erp/stg_customers.sql)
  syntax error at or near "select"
  LINE 14: select * from customers
           ^
  compiled SQL at target/run/first_project/models/erp/stg_customers.sql
16:03:35.152799 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3461b054-9093-45c2-895b-989f3b17f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f311c145220>]}
16:03:35.153079 [error] [Thread-4  ]: 4 of 6 ERROR creating table model public.stg_customers ......................... [[31mERROR[0m in 0.07s]
16:03:35.153387 [debug] [Thread-4  ]: Finished running node model.first_project.stg_customers
16:03:35.153749 [debug] [Thread-6  ]: Began running node model.first_project.customers
16:03:35.153873 [info ] [Thread-6  ]: 5 of 6 SKIP relation public.customers .......................................... [[33mSKIP[0m]
16:03:35.154125 [debug] [Thread-6  ]: Finished running node model.first_project.customers
16:03:35.159057 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
16:03:35.163012 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:03:35.165533 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: BEGIN
16:03:35.165690 [debug] [Thread-3  ]: Opening a new connection, currently in state init
16:03:35.163335 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
16:03:35.166023 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:03:35.166145 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select
 codigo_cliente as customer_id,
 nome as first_name,
 sobrenome as last_name,
 codigo_regiao as region_code
 from erp_oltp.public.clientes
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
16:03:35.173794 [debug] [Thread-2  ]: SQL status: BEGIN in 0.04 seconds
16:03:35.174064 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:03:35.174157 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:03:35.174628 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.01 seconds
16:03:35.179942 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:03:35.180168 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
16:03:35.182096 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.01 seconds
16:03:35.184107 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:03:35.184253 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:03:35.189536 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
16:03:35.191505 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:03:35.191641 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:03:35.191787 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
16:03:35.193183 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:03:35.193344 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
16:03:35.197374 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
16:03:35.205165 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
16:03:35.209981 [debug] [Thread-1  ]: On model.first_project.customers2: COMMIT
16:03:35.210514 [debug] [Thread-3  ]: SQL status: BEGIN in 0.04 seconds
16:03:35.212031 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:03:35.211879 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:03:35.212112 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
16:03:35.211654 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:03:35.213737 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:03:35.212228 [debug] [Thread-1  ]: On model.first_project.customers2: COMMIT
16:03:35.213826 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:03:35.219945 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
16:03:35.221763 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:03:35.221875 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
16:03:35.222320 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
16:03:35.223768 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:03:35.223875 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
16:03:35.224258 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
16:03:35.224988 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
16:03:35.225080 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:03:35.225181 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
16:03:35.225477 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
16:03:35.240707 [debug] [Thread-3  ]: SQL status: COMMIT in 0.02 seconds
16:03:35.242237 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:03:35.242401 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
16:03:35.243257 [debug] [Thread-2  ]: SQL status: COMMIT in 0.02 seconds
16:03:35.244561 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:03:35.244681 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:03:35.245645 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
16:03:35.246041 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:03:35.246936 [debug] [Thread-3  ]: finished collecting timing info
16:03:35.247297 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: Close
16:03:35.247160 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
16:03:35.247067 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
16:03:35.249789 [debug] [Thread-2  ]: finished collecting timing info
16:03:35.249937 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:03:35.250266 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3461b054-9093-45c2-895b-989f3b17f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f311e1e7b80>]}
16:03:35.250496 [info ] [Thread-2  ]: 2 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.21s]
16:03:35.251031 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3461b054-9093-45c2-895b-989f3b17f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f311e685f10>]}
16:03:35.251809 [info ] [Thread-3  ]: 3 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.19s]
16:03:35.251341 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:03:35.251926 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
16:03:35.252432 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
16:03:35.253566 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
16:03:35.253367 [debug] [Thread-1  ]: finished collecting timing info
16:03:35.253895 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:03:35.254125 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
16:03:35.254016 [debug] [Thread-1  ]: On model.first_project.customers2: Close
16:03:35.254208 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
16:03:35.255756 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:03:35.256002 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3461b054-9093-45c2-895b-989f3b17f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f311e6b6460>]}
16:03:35.252572 [debug] [Thread-3  ]: Finished running node model.first_project.postgres_sample_source_customers
16:03:35.257441 [info ] [Thread-1  ]: 1 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.23s]
16:03:35.257849 [debug] [Thread-8  ]: finished collecting timing info
16:03:35.258040 [debug] [Thread-1  ]: Finished running node model.first_project.customers2
16:03:35.258141 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
16:03:35.259656 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:03:35.259971 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:03:35.260068 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
16:03:35.260139 [debug] [Thread-8  ]: Opening a new connection, currently in state init
16:03:35.280573 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
16:03:35.280801 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:03:35.280874 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:03:35.282067 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
16:03:35.284981 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:03:35.285238 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:03:35.285723 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
16:03:35.286601 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
16:03:35.286714 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:03:35.286781 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
16:03:35.289631 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
16:03:35.290827 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:03:35.290964 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:03:35.291265 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
16:03:35.292011 [debug] [Thread-8  ]: finished collecting timing info
16:03:35.292125 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
16:03:35.292494 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3461b054-9093-45c2-895b-989f3b17f560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f311c0f86d0>]}
16:03:35.294807 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
16:03:35.295315 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
16:03:35.296623 [debug] [MainThread]: Acquiring new postgres connection "master"
16:03:35.296773 [debug] [MainThread]: Using postgres connection "master"
16:03:35.296839 [debug] [MainThread]: On master: BEGIN
16:03:35.296897 [debug] [MainThread]: Opening a new connection, currently in state closed
16:03:35.330361 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
16:03:35.330558 [debug] [MainThread]: On master: COMMIT
16:03:35.330629 [debug] [MainThread]: Using postgres connection "master"
16:03:35.330688 [debug] [MainThread]: On master: COMMIT
16:03:35.330831 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:03:35.330925 [debug] [MainThread]: On master: Close
16:03:35.331260 [info ] [MainThread]: 
16:03:35.331417 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0.40s.
16:03:35.331526 [debug] [MainThread]: Connection 'master' was properly closed.
16:03:35.331580 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:03:35.331630 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
16:03:35.331680 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
16:03:35.331732 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
16:03:35.331784 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:03:35.334956 [info ] [MainThread]: 
16:03:35.335225 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
16:03:35.335382 [info ] [MainThread]: 
16:03:35.335510 [error] [MainThread]: [33mDatabase Error in model stg_customers (models/erp/stg_customers.sql)[0m
16:03:35.335640 [error] [MainThread]:   syntax error at or near "select"
16:03:35.335759 [error] [MainThread]:   LINE 14: select * from customers
16:03:35.335875 [error] [MainThread]:            ^
16:03:35.336030 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/stg_customers.sql
16:03:35.336169 [info ] [MainThread]: 
16:03:35.336306 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
16:03:35.336544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3120040a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f311e7ddf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f311c109280>]}


============================== 2022-06-07 16:04:34.818750 | b46b8413-7924-44fc-a7de-1957b5717a5f ==============================
16:04:34.818763 [info ] [MainThread]: Running with dbt=1.1.0
16:04:34.819179 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:04:34.819263 [debug] [MainThread]: Tracking: tracking
16:04:34.831305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e29a1d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e29a1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e29a16d0>]}
16:04:34.851045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
16:04:34.851399 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/stg_customers.sql
16:04:34.859396 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
16:04:34.872737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b46b8413-7924-44fc-a7de-1957b5717a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e23fa0d0>]}
16:04:34.877037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b46b8413-7924-44fc-a7de-1957b5717a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e295b910>]}
16:04:34.877387 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
16:04:34.877555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b46b8413-7924-44fc-a7de-1957b5717a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e288b4f0>]}
16:04:34.878584 [info ] [MainThread]: 
16:04:34.878906 [debug] [MainThread]: Acquiring new postgres connection "master"
16:04:34.879706 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:04:34.886931 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:04:34.887046 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:04:34.887116 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:04:34.903087 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.02 seconds
16:04:34.906425 [debug] [ThreadPool]: On list_erp_oltp: Close
16:04:34.914347 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:04:34.946289 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:04:34.946459 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:04:34.946523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:04:34.950188 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
16:04:34.950333 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:04:34.950395 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:04:34.951660 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
16:04:34.952493 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:04:34.952652 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:04:34.955299 [debug] [MainThread]: Using postgres connection "master"
16:04:34.955397 [debug] [MainThread]: On master: BEGIN
16:04:34.955559 [debug] [MainThread]: Opening a new connection, currently in state init
16:04:34.959569 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:04:34.959768 [debug] [MainThread]: Using postgres connection "master"
16:04:34.959860 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:04:34.968428 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
16:04:34.969498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b46b8413-7924-44fc-a7de-1957b5717a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e4af64f0>]}
16:04:34.969737 [debug] [MainThread]: On master: ROLLBACK
16:04:34.970025 [debug] [MainThread]: Using postgres connection "master"
16:04:34.970135 [debug] [MainThread]: On master: BEGIN
16:04:34.970643 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:04:34.970756 [debug] [MainThread]: On master: COMMIT
16:04:34.970830 [debug] [MainThread]: Using postgres connection "master"
16:04:34.970890 [debug] [MainThread]: On master: COMMIT
16:04:34.971232 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:04:34.971404 [debug] [MainThread]: On master: Close
16:04:34.971979 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:04:34.972224 [info ] [MainThread]: 
16:04:34.977305 [debug] [Thread-1  ]: Began running node model.first_project.customers2
16:04:34.977551 [info ] [Thread-1  ]: 1 of 6 START table model public.customers2 ..................................... [RUN]
16:04:34.977862 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers2"
16:04:34.977960 [debug] [Thread-1  ]: Began compiling node model.first_project.customers2
16:04:34.978038 [debug] [Thread-1  ]: Compiling model.first_project.customers2
16:04:34.979396 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers2"
16:04:34.979693 [debug] [Thread-1  ]: finished collecting timing info
16:04:34.979795 [debug] [Thread-1  ]: Began executing node model.first_project.customers2
16:04:34.990554 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:04:34.990935 [info ] [Thread-2  ]: 2 of 6 START table model public.my_first_dbt_model ............................. [RUN]
16:04:34.991334 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:04:34.991772 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:04:34.991909 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:04:34.993856 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:04:34.994122 [debug] [Thread-3  ]: Began running node model.first_project.postgres_sample_source_customers
16:04:34.994227 [debug] [Thread-4  ]: Began running node model.first_project.stg_customers
16:04:34.994579 [info ] [Thread-4  ]: 4 of 6 START table model public.stg_customers .................................. [RUN]
16:04:34.994391 [info ] [Thread-3  ]: 3 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
16:04:34.994745 [debug] [Thread-2  ]: finished collecting timing info
16:04:35.001347 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_customers"
16:04:35.001686 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
16:04:35.007301 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:04:35.009588 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers2"
16:04:35.009905 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_customers
16:04:35.010056 [debug] [Thread-3  ]: Began compiling node model.first_project.postgres_sample_source_customers
16:04:35.011702 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:04:35.017485 [debug] [Thread-4  ]: Compiling model.first_project.stg_customers
16:04:35.017658 [debug] [Thread-3  ]: Compiling model.first_project.postgres_sample_source_customers
16:04:35.021036 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
16:04:35.018255 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:04:35.021965 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:04:35.022048 [debug] [Thread-2  ]: Opening a new connection, currently in state init
16:04:35.021310 [debug] [Thread-3  ]: finished collecting timing info
16:04:35.022265 [debug] [Thread-3  ]: Began executing node model.first_project.postgres_sample_source_customers
16:04:35.019287 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_customers"
16:04:35.018076 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:04:35.035410 [debug] [Thread-1  ]: On model.first_project.customers2: BEGIN
16:04:35.035685 [debug] [Thread-4  ]: finished collecting timing info
16:04:35.049209 [debug] [Thread-4  ]: Began executing node model.first_project.stg_customers
16:04:35.050908 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_customers"
16:04:35.051194 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
16:04:35.051333 [debug] [Thread-4  ]: On model.first_project.stg_customers: BEGIN
16:04:35.051401 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:04:35.035837 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:04:35.048869 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
16:04:35.052202 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:04:35.052341 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: BEGIN
16:04:35.052402 [debug] [Thread-3  ]: Opening a new connection, currently in state init
16:04:35.056378 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
16:04:35.056534 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:04:35.056633 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:04:35.057706 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
16:04:35.063212 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:04:35.063416 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:04:35.063862 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
16:04:35.063985 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
16:04:35.064131 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
 select
 codigo_cliente as customer_id,
 nome as first_name,
 sobrenome as last_name,
 codigo_regiao as region_code
 from erp_oltp.public.clientes
)
select * from customers
  );
16:04:35.065189 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:04:35.066615 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:04:35.066725 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:04:35.067579 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:04:35.073301 [debug] [Thread-1  ]: SQL status: BEGIN in 0.04 seconds
16:04:35.073483 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:04:35.073551 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select
 codigo_cliente as customer_id,
 nome as first_name,
 sobrenome as last_name,
 codigo_regiao as region_code
 from erp_oltp.public.clientes
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
16:04:35.073661 [debug] [Thread-4  ]: SQL status: SELECT 100 in 0.01 seconds
16:04:35.075630 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
16:04:35.075897 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
16:04:35.080422 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:04:35.080566 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:04:35.080630 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:04:35.080772 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
16:04:35.080923 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:04:35.081008 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
16:04:35.081714 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.01 seconds
16:04:35.083449 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:04:35.083617 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
16:04:35.083729 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
16:04:35.084653 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
16:04:35.084749 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
16:04:35.084843 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
16:04:35.085163 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
16:04:35.088543 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:04:35.088693 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:04:35.088844 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
16:04:35.090700 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:04:35.090847 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
16:04:35.090979 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
16:04:35.093038 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:04:35.093330 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
16:04:35.093255 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
16:04:35.093414 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
16:04:35.095222 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
16:04:35.096470 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
16:04:35.096205 [debug] [Thread-2  ]: finished collecting timing info
16:04:35.096654 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:04:35.096391 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
16:04:35.097917 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:04:35.098003 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
16:04:35.095388 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:04:35.099048 [debug] [Thread-1  ]: On model.first_project.customers2: COMMIT
16:04:35.099342 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b46b8413-7924-44fc-a7de-1957b5717a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e2385b20>]}
16:04:35.099455 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
16:04:35.100498 [debug] [Thread-4  ]: finished collecting timing info
16:04:35.100606 [debug] [Thread-4  ]: On model.first_project.stg_customers: Close
16:04:35.099865 [info ] [Thread-2  ]: 2 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
16:04:35.100932 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:04:35.101345 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
16:04:35.101509 [info ] [Thread-6  ]: 5 of 6 START view model public.my_second_dbt_model ............................. [RUN]
16:04:35.101760 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:04:35.101839 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
16:04:35.101911 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
16:04:35.099532 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
16:04:35.104497 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
16:04:35.103630 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:04:35.099591 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:04:35.105090 [debug] [Thread-1  ]: On model.first_project.customers2: COMMIT
16:04:35.104800 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:04:35.105265 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
16:04:35.104729 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b46b8413-7924-44fc-a7de-1957b5717a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e29a0310>]}
16:04:35.105419 [debug] [Thread-6  ]: finished collecting timing info
16:04:35.105796 [info ] [Thread-4  ]: 4 of 6 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.10s]
16:04:35.106036 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
16:04:35.106282 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
16:04:35.106513 [debug] [Thread-4  ]: Finished running node model.first_project.stg_customers
16:04:35.108243 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:04:35.108398 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
16:04:35.113909 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:04:35.112684 [debug] [Thread-8  ]: Began running node model.first_project.customers
16:04:35.111252 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:04:35.120314 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
16:04:35.120039 [info ] [Thread-8  ]: 6 of 6 START table model public.customers ...................................... [RUN]
16:04:35.120791 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
16:04:35.114433 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
16:04:35.120921 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
16:04:35.121835 [debug] [Thread-8  ]: Compiling model.first_project.customers
16:04:35.123670 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
16:04:35.123970 [debug] [Thread-8  ]: finished collecting timing info
16:04:35.114149 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:04:35.124264 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
16:04:35.124331 [debug] [Thread-6  ]: Opening a new connection, currently in state init
16:04:35.126423 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
16:04:35.124097 [debug] [Thread-8  ]: Began executing node model.first_project.customers
16:04:35.128123 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
16:04:35.132223 [debug] [Thread-3  ]: finished collecting timing info
16:04:35.132444 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: Close
16:04:35.132805 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b46b8413-7924-44fc-a7de-1957b5717a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e0336cd0>]}
16:04:35.134479 [info ] [Thread-3  ]: 3 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.13s]
16:04:35.134821 [debug] [Thread-3  ]: Finished running node model.first_project.postgres_sample_source_customers
16:04:35.128002 [debug] [Thread-1  ]: finished collecting timing info
16:04:35.135122 [debug] [Thread-1  ]: On model.first_project.customers2: Close
16:04:35.136820 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b46b8413-7924-44fc-a7de-1957b5717a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e2379eb0>]}
16:04:35.137060 [info ] [Thread-1  ]: 1 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.16s]
16:04:35.137324 [debug] [Thread-1  ]: Finished running node model.first_project.customers2
16:04:35.131006 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
16:04:35.137800 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
16:04:35.138064 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
16:04:35.138177 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
16:04:35.138474 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:04:35.138317 [debug] [Thread-8  ]: Opening a new connection, currently in state init
16:04:35.138552 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:04:35.139582 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
16:04:35.140983 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:04:35.141114 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:04:35.147138 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.01 seconds
16:04:35.148304 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
16:04:35.148501 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:04:35.148567 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
16:04:35.149149 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
16:04:35.149397 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
16:04:35.149492 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
16:04:35.151787 [debug] [Thread-8  ]: SQL status: SELECT 100 in 0.0 seconds
16:04:35.154128 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
16:04:35.154284 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:04:35.154398 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
16:04:35.155359 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:04:35.155451 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:04:35.155550 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
16:04:35.155675 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
16:04:35.157133 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
16:04:35.157852 [debug] [Thread-6  ]: finished collecting timing info
16:04:35.157998 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:04:35.159962 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
16:04:35.161176 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
16:04:35.159430 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
16:04:35.162573 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b46b8413-7924-44fc-a7de-1957b5717a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e02cedf0>]}
16:04:35.161322 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
16:04:35.164483 [info ] [Thread-6  ]: 5 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
16:04:35.164662 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
16:04:35.165100 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
16:04:35.165541 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
16:04:35.166658 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
16:04:35.166746 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:04:35.167976 [debug] [Thread-8  ]: SQL status: DROP TABLE in 0.0 seconds
16:04:35.168692 [debug] [Thread-8  ]: finished collecting timing info
16:04:35.168796 [debug] [Thread-8  ]: On model.first_project.customers: Close
16:04:35.169108 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b46b8413-7924-44fc-a7de-1957b5717a5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e02c2ac0>]}
16:04:35.169325 [info ] [Thread-8  ]: 6 of 6 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.05s]
16:04:35.169557 [debug] [Thread-8  ]: Finished running node model.first_project.customers
16:04:35.176950 [debug] [MainThread]: Acquiring new postgres connection "master"
16:04:35.177219 [debug] [MainThread]: Using postgres connection "master"
16:04:35.177343 [debug] [MainThread]: On master: BEGIN
16:04:35.177404 [debug] [MainThread]: Opening a new connection, currently in state closed
16:04:35.181418 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:04:35.181589 [debug] [MainThread]: On master: COMMIT
16:04:35.181656 [debug] [MainThread]: Using postgres connection "master"
16:04:35.181715 [debug] [MainThread]: On master: COMMIT
16:04:35.181827 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:04:35.181913 [debug] [MainThread]: On master: Close
16:04:35.182226 [info ] [MainThread]: 
16:04:35.182391 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0.30s.
16:04:35.182506 [debug] [MainThread]: Connection 'master' was properly closed.
16:04:35.182559 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
16:04:35.182608 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:04:35.182656 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
16:04:35.182704 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
16:04:35.182752 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:04:35.182800 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:04:35.185541 [info ] [MainThread]: 
16:04:35.185701 [info ] [MainThread]: [32mCompleted successfully[0m
16:04:35.185847 [info ] [MainThread]: 
16:04:35.185953 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
16:04:35.186139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e23fa310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e2385760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e292c4c0>]}


============================== 2022-06-07 16:05:24.561537 | 3dfdada9-5373-41fb-af65-d8307dfe051e ==============================
16:05:24.561549 [info ] [MainThread]: Running with dbt=1.1.0
16:05:24.561860 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
16:05:24.561952 [debug] [MainThread]: Tracking: tracking
16:05:24.564311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be8d4c100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be8d4c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be8d4cca0>]}
16:05:24.581170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
16:05:24.581354 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
16:05:24.585318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3dfdada9-5373-41fb-af65-d8307dfe051e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be8bec0d0>]}
16:05:24.588699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3dfdada9-5373-41fb-af65-d8307dfe051e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be8c539d0>]}
16:05:24.588934 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
16:05:24.589055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dfdada9-5373-41fb-af65-d8307dfe051e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be8c53a60>]}
16:05:24.589653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be8c53910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be8c538b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0be8c53550>]}


============================== 2022-06-07 16:05:36.671726 | 5945799c-5578-4cda-92a3-d271fda39fa2 ==============================
16:05:36.671737 [info ] [MainThread]: Running with dbt=1.1.0
16:05:36.672137 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
16:05:36.672248 [debug] [MainThread]: Tracking: tracking
16:05:36.674559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c071892e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c071891f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c071895e0>]}
16:05:36.695805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
16:05:36.695989 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
16:05:36.702538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5945799c-5578-4cda-92a3-d271fda39fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c07033f40>]}
16:05:36.706300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5945799c-5578-4cda-92a3-d271fda39fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0707da00>]}
16:05:36.706595 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
16:05:36.712581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5945799c-5578-4cda-92a3-d271fda39fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0707d9d0>]}
16:05:36.714437 [info ] [MainThread]: 
16:05:36.715055 [debug] [MainThread]: Acquiring new postgres connection "master"
16:05:36.716099 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:05:36.722003 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:05:36.723089 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:05:36.723193 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:05:36.733552 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
16:05:36.739067 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:05:36.739429 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:05:36.741709 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
16:05:36.744268 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:05:36.744535 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:05:36.748603 [debug] [MainThread]: Using postgres connection "master"
16:05:36.748796 [debug] [MainThread]: On master: BEGIN
16:05:36.748870 [debug] [MainThread]: Opening a new connection, currently in state init
16:05:36.752428 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:05:36.752556 [debug] [MainThread]: Using postgres connection "master"
16:05:36.752622 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:05:36.762211 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
16:05:36.763529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5945799c-5578-4cda-92a3-d271fda39fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0707d7c0>]}
16:05:36.763819 [debug] [MainThread]: On master: ROLLBACK
16:05:36.764196 [debug] [MainThread]: Using postgres connection "master"
16:05:36.764300 [debug] [MainThread]: On master: BEGIN
16:05:36.764520 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:05:36.764643 [debug] [MainThread]: On master: COMMIT
16:05:36.764709 [debug] [MainThread]: Using postgres connection "master"
16:05:36.764769 [debug] [MainThread]: On master: COMMIT
16:05:36.764886 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:05:36.764969 [debug] [MainThread]: On master: Close
16:05:36.765303 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:05:36.765514 [info ] [MainThread]: 
16:05:36.771119 [debug] [Thread-1  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
16:05:36.771287 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
16:05:36.771426 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
16:05:36.772033 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
16:05:36.772120 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
16:05:36.771710 [info ] [Thread-2  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
16:05:36.772199 [debug] [Thread-1  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
16:05:36.771600 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
16:05:36.771528 [debug] [Thread-3  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
16:05:36.783258 [info ] [Thread-4  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
16:05:36.788393 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
16:05:36.788486 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
16:05:36.783966 [info ] [Thread-3  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
16:05:36.788877 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
16:05:36.788555 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
16:05:36.783708 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
16:05:36.788968 [debug] [Thread-3  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
16:05:36.795072 [debug] [Thread-3  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
16:05:36.797869 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
16:05:36.794863 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
16:05:36.798184 [debug] [Thread-3  ]: finished collecting timing info
16:05:36.798510 [debug] [Thread-3  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
16:05:36.798310 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
16:05:36.794572 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
16:05:36.787881 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
16:05:36.834516 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
16:05:36.834971 [debug] [Thread-4  ]: finished collecting timing info
16:05:36.841000 [debug] [Thread-1  ]: finished collecting timing info
16:05:36.844605 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
16:05:36.841583 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
16:05:36.846633 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
16:05:36.846840 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
16:05:36.846935 [debug] [Thread-4  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
16:05:36.846996 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:05:36.845680 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
16:05:36.847315 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
16:05:36.847411 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
16:05:36.847467 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:05:36.844351 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
16:05:36.847845 [debug] [Thread-3  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
16:05:36.847915 [debug] [Thread-3  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
16:05:36.841365 [debug] [Thread-2  ]: finished collecting timing info
16:05:36.847973 [debug] [Thread-3  ]: Opening a new connection, currently in state init
16:05:36.848076 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
16:05:36.849216 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
16:05:36.849387 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
16:05:36.849456 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
16:05:36.849510 [debug] [Thread-2  ]: Opening a new connection, currently in state init
16:05:36.852666 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
16:05:36.852798 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
16:05:36.852877 [debug] [Thread-4  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
16:05:36.853226 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:05:36.853327 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
16:05:36.853379 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
16:05:36.853916 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
16:05:36.855208 [debug] [Thread-1  ]: finished collecting timing info
16:05:36.855307 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
16:05:36.855615 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
16:05:36.855910 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.08s]
16:05:36.856311 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
16:05:36.856764 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
16:05:36.857568 [debug] [Thread-4  ]: finished collecting timing info
16:05:36.857666 [debug] [Thread-4  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
16:05:36.858022 [debug] [Thread-4  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
16:05:36.858274 [info ] [Thread-4  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.07s]
16:05:36.858494 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
16:05:36.858938 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
16:05:36.859032 [debug] [Thread-3  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
16:05:36.859088 [debug] [Thread-3  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
16:05:36.859696 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
16:05:36.860431 [debug] [Thread-3  ]: finished collecting timing info
16:05:36.860532 [debug] [Thread-3  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
16:05:36.860709 [debug] [Thread-3  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
16:05:36.861009 [info ] [Thread-3  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.07s]
16:05:36.861286 [debug] [Thread-3  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
16:05:36.863775 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
16:05:36.863898 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
16:05:36.863958 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
16:05:36.864417 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
16:05:36.865236 [debug] [Thread-2  ]: finished collecting timing info
16:05:36.865332 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
16:05:36.865553 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
16:05:36.865842 [info ] [Thread-2  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.08s]
16:05:36.866044 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
16:05:36.872275 [debug] [MainThread]: Acquiring new postgres connection "master"
16:05:36.872476 [debug] [MainThread]: Using postgres connection "master"
16:05:36.872542 [debug] [MainThread]: On master: BEGIN
16:05:36.872614 [debug] [MainThread]: Opening a new connection, currently in state closed
16:05:36.878193 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:05:36.878400 [debug] [MainThread]: On master: COMMIT
16:05:36.878496 [debug] [MainThread]: Using postgres connection "master"
16:05:36.878559 [debug] [MainThread]: On master: COMMIT
16:05:36.878686 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:05:36.878781 [debug] [MainThread]: On master: Close
16:05:36.879086 [info ] [MainThread]: 
16:05:36.879235 [info ] [MainThread]: Finished running 4 tests in 0.16s.
16:05:36.879342 [debug] [MainThread]: Connection 'master' was properly closed.
16:05:36.879394 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
16:05:36.879466 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
16:05:36.879516 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
16:05:36.879563 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
16:05:36.885611 [info ] [MainThread]: 
16:05:36.885871 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
16:05:36.886008 [info ] [MainThread]: 
16:05:36.886117 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
16:05:36.886265 [error] [MainThread]:   Got 1 result, configured to fail if != 0
16:05:36.886370 [info ] [MainThread]: 
16:05:36.886468 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
16:05:36.886575 [info ] [MainThread]: 
16:05:36.886673 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
16:05:36.886867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0707d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c06fb0970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c06fc4d90>]}


============================== 2022-06-07 16:05:52.379286 | 1044b3b3-3b6a-4fb6-9ffc-edd4bbb58e28 ==============================
16:05:52.379298 [info ] [MainThread]: Running with dbt=1.1.0
16:05:52.379633 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'write_manifest': False, 'compile': False, 'which': 'parse', 'rpc_method': 'parse', 'indirect_selection': 'eager'}
16:05:52.379721 [debug] [MainThread]: Tracking: tracking
16:05:52.382062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abb377e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abb377d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abb377a60>]}
16:05:52.382434 [info ] [MainThread]: Start parsing.
16:05:52.388537 [info ] [MainThread]: Dependencies loaded
16:05:52.393835 [info ] [MainThread]: ManifestLoader created
16:05:52.399913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
16:05:52.400088 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
16:05:52.400163 [info ] [MainThread]: Manifest loaded
16:05:52.400532 [info ] [MainThread]: Manifest checked
16:05:52.400953 [info ] [MainThread]: Flat graph built
16:05:52.401148 [info ] [MainThread]: Manifest loaded
16:05:52.401442 [info ] [MainThread]: Performance info: target/perf_info.json
16:05:52.401563 [info ] [MainThread]: Done.
16:05:52.401747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abb27d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abb27d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9abb27d4c0>]}


============================== 2022-06-07 16:06:19.452015 | f7eaa6ea-7a4a-4b4f-8c2e-c055355d6051 ==============================
16:06:19.452023 [info ] [MainThread]: Running with dbt=1.1.0
16:06:19.452281 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
16:06:19.452355 [debug] [MainThread]: Tracking: tracking
16:06:19.455614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935ee62070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935ee62160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935ee62100>]}
16:06:19.457760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935ee62400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935ee622b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935ee62280>]}


============================== 2022-06-07 16:06:31.262594 | d8c3deed-d154-424a-8a44-04fbc84a26de ==============================
16:06:31.262605 [info ] [MainThread]: Running with dbt=1.1.0
16:06:31.264853 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
16:06:31.265645 [debug] [MainThread]: Tracking: tracking
16:06:31.286762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d643b9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d643b91f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d643b9d90>]}
16:06:31.321289 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
16:06:31.323332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd8c3deed-d154-424a-8a44-04fbc84a26de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d6437f220>]}
16:06:31.329156 [debug] [MainThread]: Parsing macros/catalog.sql
16:06:31.333367 [debug] [MainThread]: Parsing macros/relations.sql
16:06:31.335284 [debug] [MainThread]: Parsing macros/adapters.sql
16:06:31.375068 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
16:06:31.376189 [debug] [MainThread]: Parsing macros/materializations/configs.sql
16:06:31.377544 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
16:06:31.379710 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
16:06:31.385912 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
16:06:31.396026 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
16:06:31.406629 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
16:06:31.409387 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
16:06:31.410348 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
16:06:31.412079 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
16:06:31.413762 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
16:06:31.415514 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
16:06:31.419603 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
16:06:31.424784 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
16:06:31.426471 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
16:06:31.437393 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
16:06:31.440893 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
16:06:31.441980 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
16:06:31.445530 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
16:06:31.446629 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
16:06:31.454919 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
16:06:31.465699 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
16:06:31.473002 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
16:06:31.474002 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
16:06:31.475474 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
16:06:31.476401 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
16:06:31.477285 [debug] [MainThread]: Parsing macros/adapters/columns.sql
16:06:31.483807 [debug] [MainThread]: Parsing macros/adapters/relation.sql
16:06:31.489205 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
16:06:31.490929 [debug] [MainThread]: Parsing macros/adapters/schema.sql
16:06:31.493241 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
16:06:31.494786 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
16:06:31.499003 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
16:06:31.501645 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
16:06:31.503106 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
16:06:31.503632 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
16:06:31.504054 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
16:06:31.505326 [debug] [MainThread]: Parsing macros/etc/datetime.sql
16:06:31.510156 [debug] [MainThread]: Parsing macros/etc/statement.sql
16:06:31.513705 [debug] [MainThread]: Parsing tests/generic/builtin.sql
16:06:31.656752 [debug] [MainThread]: 1699: static parser successfully parsed customers2.sql
16:06:31.663877 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
16:06:31.665344 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
16:06:31.666694 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
16:06:31.668117 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
16:06:31.669503 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
16:06:31.704804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8c3deed-d154-424a-8a44-04fbc84a26de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d6428ae20>]}
16:06:31.708546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8c3deed-d154-424a-8a44-04fbc84a26de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d6437fa00>]}
16:06:31.708943 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
16:06:31.709303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8c3deed-d154-424a-8a44-04fbc84a26de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d6428adc0>]}
16:06:31.710281 [info ] [MainThread]: 
16:06:31.710615 [debug] [MainThread]: Acquiring new postgres connection "master"
16:06:31.711392 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:06:31.724563 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:06:31.724770 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:06:31.724845 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:06:31.729303 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
16:06:31.729458 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:06:31.729522 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:06:31.730912 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
16:06:31.732072 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:06:31.733339 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:06:31.740990 [debug] [MainThread]: Using postgres connection "master"
16:06:31.741197 [debug] [MainThread]: On master: BEGIN
16:06:31.741269 [debug] [MainThread]: Opening a new connection, currently in state init
16:06:31.752042 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:06:31.752308 [debug] [MainThread]: Using postgres connection "master"
16:06:31.752381 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:06:31.762065 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
16:06:31.763199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8c3deed-d154-424a-8a44-04fbc84a26de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d66fddd30>]}
16:06:31.763445 [debug] [MainThread]: On master: ROLLBACK
16:06:31.763686 [debug] [MainThread]: On master: Close
16:06:31.764048 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:06:31.764306 [info ] [MainThread]: 
16:06:31.770213 [debug] [Thread-1  ]: Began running node model.first_project.customers2
16:06:31.770575 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers2"
16:06:31.770702 [debug] [Thread-1  ]: Began compiling node model.first_project.customers2
16:06:31.770782 [debug] [Thread-1  ]: Compiling model.first_project.customers2
16:06:31.778928 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:06:31.779396 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:06:31.779508 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:06:31.779593 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:06:31.781087 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:06:31.781412 [debug] [Thread-2  ]: finished collecting timing info
16:06:31.781502 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:06:31.781574 [debug] [Thread-2  ]: finished collecting timing info
16:06:31.781858 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:06:31.781947 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
16:06:31.782069 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
16:06:31.782134 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
16:06:31.782189 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
16:06:31.783364 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
16:06:31.783533 [debug] [Thread-2  ]: finished collecting timing info
16:06:31.783646 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
16:06:31.783713 [debug] [Thread-2  ]: finished collecting timing info
16:06:31.783933 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
16:06:31.784022 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
16:06:31.784814 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
16:06:31.784886 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
16:06:31.784963 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
16:06:31.784273 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers2"
16:06:31.786303 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
16:06:31.786749 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
16:06:31.788171 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:06:31.788303 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
16:06:31.787673 [debug] [Thread-1  ]: finished collecting timing info
16:06:31.787880 [debug] [Thread-3  ]: finished collecting timing info
16:06:31.788698 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
16:06:31.787022 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
16:06:31.786933 [debug] [Thread-6  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
16:06:31.789307 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
16:06:31.788396 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
16:06:31.790965 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:06:31.791169 [debug] [Thread-5  ]: finished collecting timing info
16:06:31.789395 [debug] [Thread-6  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
16:06:31.789057 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
16:06:31.791450 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
16:06:31.788548 [debug] [Thread-1  ]: Began executing node model.first_project.customers2
16:06:31.791336 [debug] [Thread-6  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
16:06:31.791535 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
16:06:31.788833 [debug] [Thread-3  ]: finished collecting timing info
16:06:31.791246 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
16:06:31.803034 [debug] [Thread-5  ]: finished collecting timing info
16:06:31.798908 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
16:06:31.802268 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
16:06:31.802693 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
16:06:31.803276 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
16:06:31.791638 [debug] [Thread-1  ]: finished collecting timing info
16:06:31.803976 [debug] [Thread-6  ]: finished collecting timing info
16:06:31.804287 [debug] [Thread-9  ]: Began running node model.first_project.customers
16:06:31.804453 [debug] [Thread-7  ]: finished collecting timing info
16:06:31.805710 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
16:06:31.804983 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
16:06:31.806077 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
16:06:31.806178 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
16:06:31.805538 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers"
16:06:31.804761 [debug] [Thread-1  ]: Finished running node model.first_project.customers2
16:06:31.805279 [debug] [Thread-6  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
16:06:31.806242 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
16:06:31.809228 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
16:06:31.805821 [debug] [Thread-7  ]: finished collecting timing info
16:06:31.806426 [debug] [Thread-9  ]: Began compiling node model.first_project.customers
16:06:31.809701 [debug] [Thread-9  ]: Compiling model.first_project.customers
16:06:31.805124 [debug] [Thread-2  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
16:06:31.806707 [debug] [Thread-6  ]: finished collecting timing info
16:06:31.811660 [debug] [Thread-6  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
16:06:31.810920 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers"
16:06:31.811100 [debug] [Thread-4  ]: finished collecting timing info
16:06:31.812018 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
16:06:31.813063 [debug] [Thread-4  ]: finished collecting timing info
16:06:31.812187 [debug] [Thread-9  ]: finished collecting timing info
16:06:31.813485 [debug] [Thread-9  ]: Began executing node model.first_project.customers
16:06:31.813580 [debug] [Thread-9  ]: finished collecting timing info
16:06:31.811335 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
16:06:31.813927 [debug] [Thread-2  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
16:06:31.814017 [debug] [Thread-2  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
16:06:31.809591 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
16:06:31.813302 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
16:06:31.813763 [debug] [Thread-9  ]: Finished running node model.first_project.customers
16:06:31.815824 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
16:06:31.816454 [debug] [Thread-2  ]: finished collecting timing info
16:06:31.816539 [debug] [Thread-2  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
16:06:31.816606 [debug] [Thread-2  ]: finished collecting timing info
16:06:31.816787 [debug] [Thread-2  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
16:06:31.817961 [debug] [MainThread]: Connection 'master' was properly closed.
16:06:31.818051 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
16:06:31.818135 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
16:06:31.818185 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
16:06:31.818234 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:06:31.818284 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
16:06:31.818330 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
16:06:31.818376 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:06:31.818421 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
16:06:31.820849 [info ] [MainThread]: Done.
16:06:31.821236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d661b95e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d643acaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d6428a7f0>]}


============================== 2022-06-07 16:06:43.122675 | 3d6e550c-2267-4781-85c3-e59543f0448e ==============================
16:06:43.122683 [info ] [MainThread]: Running with dbt=1.1.0
16:06:43.123030 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
16:06:43.123124 [debug] [MainThread]: Tracking: tracking
16:06:43.125817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4dc99670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4dc99940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4dc99700>]}
16:06:43.177073 [debug] [MainThread]: Executing "git --help"
16:06:43.180604 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
16:06:43.180853 [debug] [MainThread]: STDERR: "b''"
16:06:43.191219 [debug] [MainThread]: Acquiring new postgres connection "debug"
16:06:43.191951 [debug] [MainThread]: Using postgres connection "debug"
16:06:43.192080 [debug] [MainThread]: On debug: select 1 as id
16:06:43.192150 [debug] [MainThread]: Opening a new connection, currently in state init
16:06:43.197937 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
16:06:43.198797 [debug] [MainThread]: On debug: Close
16:06:43.199173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4c407df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4c4077c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4c407340>]}
16:06:44.064761 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-07 16:09:08.958511 | dd397333-48f2-432f-8b97-4c613fcc66ca ==============================
16:09:08.958523 [info ] [MainThread]: Running with dbt=1.1.0
16:09:08.958993 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:09:08.959084 [debug] [MainThread]: Tracking: tracking
16:09:08.961490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8bb50730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8bb50250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8bb50610>]}
16:09:08.980328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
16:09:08.980537 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
16:09:08.985060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd397333-48f2-432f-8b97-4c613fcc66ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8b9f6f10>]}
16:09:08.990555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd397333-48f2-432f-8b97-4c613fcc66ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8ba40a00>]}
16:09:08.990878 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
16:09:08.991030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd397333-48f2-432f-8b97-4c613fcc66ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8ba409d0>]}
16:09:08.992072 [info ] [MainThread]: 
16:09:08.992419 [debug] [MainThread]: Acquiring new postgres connection "master"
16:09:08.993171 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:09:08.999648 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:09:08.999808 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:09:08.999883 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:09:09.010088 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:09:09.011114 [debug] [ThreadPool]: On list_erp_oltp: Close
16:09:09.013510 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:09:09.020045 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:09:09.020318 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:09:09.020396 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:09:09.032143 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
16:09:09.032398 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:09:09.032469 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:09:09.034510 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
16:09:09.035718 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:09:09.036505 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:09:09.039647 [debug] [MainThread]: Using postgres connection "master"
16:09:09.039790 [debug] [MainThread]: On master: BEGIN
16:09:09.039856 [debug] [MainThread]: Opening a new connection, currently in state init
16:09:09.045799 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:09:09.046022 [debug] [MainThread]: Using postgres connection "master"
16:09:09.046091 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:09:09.057557 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
16:09:09.058491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd397333-48f2-432f-8b97-4c613fcc66ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8ba40580>]}
16:09:09.058765 [debug] [MainThread]: On master: ROLLBACK
16:09:09.058974 [debug] [MainThread]: Using postgres connection "master"
16:09:09.059056 [debug] [MainThread]: On master: BEGIN
16:09:09.059231 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:09:09.059313 [debug] [MainThread]: On master: COMMIT
16:09:09.059371 [debug] [MainThread]: Using postgres connection "master"
16:09:09.059424 [debug] [MainThread]: On master: COMMIT
16:09:09.059551 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:09:09.059639 [debug] [MainThread]: On master: Close
16:09:09.059905 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:09:09.060105 [info ] [MainThread]: 
16:09:09.102576 [debug] [Thread-1  ]: Began running node model.first_project.customers2
16:09:09.102963 [info ] [Thread-1  ]: 1 of 6 START table model public.customers2 ..................................... [RUN]
16:09:09.103392 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers2"
16:09:09.103518 [debug] [Thread-1  ]: Began compiling node model.first_project.customers2
16:09:09.103626 [debug] [Thread-1  ]: Compiling model.first_project.customers2
16:09:09.105402 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers2"
16:09:09.105779 [debug] [Thread-1  ]: finished collecting timing info
16:09:09.105920 [debug] [Thread-1  ]: Began executing node model.first_project.customers2
16:09:09.111453 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:09:09.111637 [info ] [Thread-2  ]: 2 of 6 START table model public.my_first_dbt_model ............................. [RUN]
16:09:09.111898 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:09:09.112013 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:09:09.112108 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:09:09.113293 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:09:09.113458 [debug] [Thread-3  ]: Began running node model.first_project.postgres_sample_source_customers
16:09:09.113662 [info ] [Thread-3  ]: 3 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
16:09:09.113972 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
16:09:09.114131 [debug] [Thread-3  ]: Began compiling node model.first_project.postgres_sample_source_customers
16:09:09.114214 [debug] [Thread-3  ]: Compiling model.first_project.postgres_sample_source_customers
16:09:09.148501 [debug] [Thread-4  ]: Began running node model.first_project.stg_customers
16:09:09.148793 [info ] [Thread-4  ]: 4 of 6 START table model public.stg_customers .................................. [RUN]
16:09:09.149149 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_customers"
16:09:09.149267 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_customers
16:09:09.149335 [debug] [Thread-4  ]: Compiling model.first_project.stg_customers
16:09:09.149964 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_customers"
16:09:09.150226 [debug] [Thread-4  ]: finished collecting timing info
16:09:09.150391 [debug] [Thread-4  ]: Began executing node model.first_project.stg_customers
16:09:09.162691 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
16:09:09.162950 [debug] [Thread-2  ]: finished collecting timing info
16:09:09.185103 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:09:09.184739 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers2"
16:09:09.183394 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_customers"
16:09:09.186722 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:09:09.187032 [debug] [Thread-3  ]: finished collecting timing info
16:09:09.187477 [debug] [Thread-3  ]: Began executing node model.first_project.postgres_sample_source_customers
16:09:09.192926 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:09:09.193028 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:09:09.193121 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:09:09.193989 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
16:09:09.194070 [debug] [Thread-4  ]: On model.first_project.stg_customers: BEGIN
16:09:09.194127 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:09:09.194652 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:09:09.194767 [debug] [Thread-1  ]: On model.first_project.customers2: BEGIN
16:09:09.194829 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:09:09.202277 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
16:09:09.202779 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:09:09.202873 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: BEGIN
16:09:09.202926 [debug] [Thread-3  ]: Opening a new connection, currently in state init
16:09:09.203353 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:09:09.203486 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:09:09.203578 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select
 codigo_cliente as customer_id,
 nome as first_name,
 sobrenome as last_name,
 codigo_regiao as region_code
 from erp_oltp.public.clientes
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
16:09:09.203781 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
16:09:09.203870 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:09:09.203925 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:09:09.204013 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
16:09:09.204073 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
16:09:09.204121 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
 select
 codigo_cliente as customer_id,
 nome as first_name,
 sobrenome as last_name,
 codigo_regiao as region_code
 from erp_oltp.public.clientes
)
select * from customers
  );
16:09:09.204716 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
16:09:09.208319 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:09:09.208525 [debug] [Thread-4  ]: SQL status: SELECT 100 in 0.0 seconds
16:09:09.208627 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
16:09:09.210228 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
16:09:09.211679 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
16:09:09.208766 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:09:09.211963 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
16:09:09.212068 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
16:09:09.211516 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:09:09.213284 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
16:09:09.213625 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
16:09:09.212154 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:09:09.213459 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
16:09:09.214750 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:09:09.214835 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
16:09:09.212241 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:09:09.220661 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
16:09:09.215045 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:09:09.220884 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
16:09:09.221162 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:09:09.221275 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
16:09:09.222311 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:09:09.224648 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:09:09.224722 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:09:09.224568 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
16:09:09.224338 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:09:09.227616 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:09:09.228238 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
16:09:09.221461 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
16:09:09.228163 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
16:09:09.227961 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
16:09:09.233237 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
16:09:09.231954 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:09:09.234805 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:09:09.235270 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
16:09:09.235011 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:09:09.236359 [debug] [Thread-1  ]: On model.first_project.customers2: COMMIT
16:09:09.236466 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:09:09.228423 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
16:09:09.236534 [debug] [Thread-1  ]: On model.first_project.customers2: COMMIT
16:09:09.235143 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:09:09.238117 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
16:09:09.238417 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
16:09:09.239368 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
16:09:09.239522 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
16:09:09.241934 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:09:09.243116 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
16:09:09.240895 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:09:09.243319 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
16:09:09.239599 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
16:09:09.244981 [debug] [Thread-2  ]: finished collecting timing info
16:09:09.245200 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:09:09.240707 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
16:09:09.245521 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
16:09:09.245870 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd397333-48f2-432f-8b97-4c613fcc66ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8b9d6b20>]}
16:09:09.246194 [info ] [Thread-2  ]: 2 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.13s]
16:09:09.246585 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:09:09.247596 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
16:09:09.247889 [info ] [Thread-6  ]: 5 of 6 START view model public.my_second_dbt_model ............................. [RUN]
16:09:09.248186 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:09:09.248280 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
16:09:09.248349 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
16:09:09.250036 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:09:09.250275 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
16:09:09.251000 [debug] [Thread-4  ]: finished collecting timing info
16:09:09.251222 [debug] [Thread-4  ]: On model.first_project.stg_customers: Close
16:09:09.251552 [debug] [Thread-6  ]: finished collecting timing info
16:09:09.251657 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
16:09:09.251123 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
16:09:09.253059 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:09:09.254438 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:09:09.253839 [debug] [Thread-1  ]: finished collecting timing info
16:09:09.254633 [debug] [Thread-1  ]: On model.first_project.customers2: Close
16:09:09.254976 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd397333-48f2-432f-8b97-4c613fcc66ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8b9d6d60>]}
16:09:09.255234 [info ] [Thread-1  ]: 1 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.15s]
16:09:09.254071 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd397333-48f2-432f-8b97-4c613fcc66ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8b984070>]}
16:09:09.255516 [info ] [Thread-4  ]: 4 of 6 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.11s]
16:09:09.255702 [debug] [Thread-1  ]: Finished running node model.first_project.customers2
16:09:09.255808 [debug] [Thread-4  ]: Finished running node model.first_project.stg_customers
16:09:09.256175 [debug] [Thread-8  ]: Began running node model.first_project.customers
16:09:09.256316 [info ] [Thread-8  ]: 6 of 6 START table model public.customers ...................................... [RUN]
16:09:09.256567 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
16:09:09.256649 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
16:09:09.256716 [debug] [Thread-8  ]: Compiling model.first_project.customers
16:09:09.257981 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
16:09:09.258262 [debug] [Thread-8  ]: finished collecting timing info
16:09:09.258402 [debug] [Thread-8  ]: Began executing node model.first_project.customers
16:09:09.259885 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
16:09:09.260093 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
16:09:09.260165 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
16:09:09.260226 [debug] [Thread-8  ]: Opening a new connection, currently in state init
16:09:09.251328 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
16:09:09.267926 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:09:09.268051 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
16:09:09.271532 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
16:09:09.254524 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
16:09:09.272619 [debug] [Thread-6  ]: Opening a new connection, currently in state init
16:09:09.272479 [debug] [Thread-3  ]: finished collecting timing info
16:09:09.273615 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: Close
16:09:09.274039 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd397333-48f2-432f-8b97-4c613fcc66ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8b97b0a0>]}
16:09:09.274281 [info ] [Thread-3  ]: 3 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.16s]
16:09:09.274512 [debug] [Thread-3  ]: Finished running node model.first_project.postgres_sample_source_customers
16:09:09.279971 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
16:09:09.280175 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
16:09:09.280247 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
16:09:09.288439 [debug] [Thread-8  ]: SQL status: SELECT 100 in 0.01 seconds
16:09:09.290642 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
16:09:09.290826 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:09:09.290953 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
16:09:09.291094 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:09:09.291170 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:09:09.291278 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
16:09:09.292596 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
16:09:09.292696 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:09:09.292804 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
16:09:09.294072 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:09:09.294225 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:09:09.294325 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
16:09:09.295303 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
16:09:09.295398 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
16:09:09.295460 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
16:09:09.295583 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
16:09:09.296511 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
16:09:09.296595 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:09:09.296654 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
16:09:09.296731 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
16:09:09.297740 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
16:09:09.297831 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:09:09.297914 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
16:09:09.299879 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:09:09.299970 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:09:09.300110 [debug] [Thread-8  ]: SQL status: DROP TABLE in 0.0 seconds
16:09:09.300220 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
16:09:09.301338 [debug] [Thread-8  ]: finished collecting timing info
16:09:09.302229 [debug] [Thread-6  ]: finished collecting timing info
16:09:09.303128 [debug] [Thread-8  ]: On model.first_project.customers: Close
16:09:09.303258 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
16:09:09.304918 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd397333-48f2-432f-8b97-4c613fcc66ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d880c2790>]}
16:09:09.305227 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd397333-48f2-432f-8b97-4c613fcc66ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d880cacd0>]}
16:09:09.305465 [info ] [Thread-6  ]: 5 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
16:09:09.305730 [info ] [Thread-8  ]: 6 of 6 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.05s]
16:09:09.306142 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
16:09:09.306446 [debug] [Thread-8  ]: Finished running node model.first_project.customers
16:09:09.307479 [debug] [MainThread]: Acquiring new postgres connection "master"
16:09:09.307590 [debug] [MainThread]: Using postgres connection "master"
16:09:09.307654 [debug] [MainThread]: On master: BEGIN
16:09:09.307710 [debug] [MainThread]: Opening a new connection, currently in state closed
16:09:09.321484 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:09:09.321746 [debug] [MainThread]: On master: COMMIT
16:09:09.321835 [debug] [MainThread]: Using postgres connection "master"
16:09:09.321901 [debug] [MainThread]: On master: COMMIT
16:09:09.322153 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:09:09.322280 [debug] [MainThread]: On master: Close
16:09:09.322678 [info ] [MainThread]: 
16:09:09.322820 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0.33s.
16:09:09.322920 [debug] [MainThread]: Connection 'master' was properly closed.
16:09:09.322970 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:09:09.323017 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
16:09:09.323161 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
16:09:09.323213 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
16:09:09.323261 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:09:09.323309 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:09:09.326214 [info ] [MainThread]: 
16:09:09.326393 [info ] [MainThread]: [32mCompleted successfully[0m
16:09:09.326579 [info ] [MainThread]: 
16:09:09.326710 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
16:09:09.326927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8b984ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8b984c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8b9846a0>]}


============================== 2022-06-07 16:17:41.826814 | 1aeb1e19-807d-4c0f-8407-89a803533b34 ==============================
16:17:41.826825 [info ] [MainThread]: Running with dbt=1.1.0
16:17:41.827197 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:17:41.827307 [debug] [MainThread]: Tracking: tracking
16:17:41.829635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0b90adc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0b90ae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0b90a490>]}
16:17:41.848406 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
16:17:41.848805 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/customers2.sql
16:17:41.848921 [debug] [MainThread]: Partial parsing: deleted file: first_project://models/customers2.sql
16:17:41.849069 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/stg_customers.sql
16:17:41.872030 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers2.sql
16:17:41.879932 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
16:17:41.885839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aeb1e19-807d-4c0f-8407-89a803533b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0b3670d0>]}
16:17:41.889490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aeb1e19-807d-4c0f-8407-89a803533b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0b7e8400>]}
16:17:41.889811 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
16:17:41.890322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aeb1e19-807d-4c0f-8407-89a803533b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0b7f4f40>]}
16:17:41.898444 [info ] [MainThread]: 
16:17:41.899221 [debug] [MainThread]: Acquiring new postgres connection "master"
16:17:41.900275 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:17:41.914787 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:17:41.914974 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:17:41.915039 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:17:41.922212 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:17:41.925033 [debug] [ThreadPool]: On list_erp_oltp: Close
16:17:41.926208 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:17:41.963981 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:17:41.964132 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:17:41.964193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:17:41.968690 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
16:17:41.968855 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:17:41.968923 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:17:41.970671 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
16:17:41.971637 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:17:41.971933 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:17:41.975874 [debug] [MainThread]: Using postgres connection "master"
16:17:41.975981 [debug] [MainThread]: On master: BEGIN
16:17:41.976046 [debug] [MainThread]: Opening a new connection, currently in state init
16:17:41.979736 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:17:41.979841 [debug] [MainThread]: Using postgres connection "master"
16:17:41.979903 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:17:41.987974 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
16:17:41.988780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aeb1e19-807d-4c0f-8407-89a803533b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0b905430>]}
16:17:41.988997 [debug] [MainThread]: On master: ROLLBACK
16:17:41.989301 [debug] [MainThread]: Using postgres connection "master"
16:17:41.989385 [debug] [MainThread]: On master: BEGIN
16:17:41.989530 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:17:41.989599 [debug] [MainThread]: On master: COMMIT
16:17:41.989653 [debug] [MainThread]: Using postgres connection "master"
16:17:41.989700 [debug] [MainThread]: On master: COMMIT
16:17:41.989800 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:17:41.989870 [debug] [MainThread]: On master: Close
16:17:41.990146 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:17:41.990272 [info ] [MainThread]: 
16:17:41.995067 [debug] [Thread-1  ]: Began running node model.first_project.customers2
16:17:41.995262 [info ] [Thread-1  ]: 1 of 6 START table model public.customers2 ..................................... [RUN]
16:17:41.995569 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers2"
16:17:41.995646 [debug] [Thread-1  ]: Began compiling node model.first_project.customers2
16:17:41.995718 [debug] [Thread-1  ]: Compiling model.first_project.customers2
16:17:41.997100 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers2"
16:17:41.997202 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:17:41.997485 [info ] [Thread-2  ]: 2 of 6 START table model public.my_first_dbt_model ............................. [RUN]
16:17:41.997711 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:17:41.997780 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:17:41.997842 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:17:41.999027 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:17:41.999262 [debug] [Thread-2  ]: finished collecting timing info
16:17:41.999400 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:17:41.997335 [debug] [Thread-4  ]: Began running node model.first_project.stg_customers
16:17:41.997274 [debug] [Thread-3  ]: Began running node model.first_project.postgres_sample_source_customers
16:17:42.007525 [info ] [Thread-4  ]: 4 of 6 START table model public.stg_customers .................................. [RUN]
16:17:42.016497 [info ] [Thread-3  ]: 3 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
16:17:42.017754 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
16:17:42.017874 [debug] [Thread-3  ]: Began compiling node model.first_project.postgres_sample_source_customers
16:17:42.017956 [debug] [Thread-3  ]: Compiling model.first_project.postgres_sample_source_customers
16:17:42.019896 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
16:17:42.017228 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_customers"
16:17:42.022688 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_customers
16:17:42.022057 [debug] [Thread-1  ]: finished collecting timing info
16:17:42.021801 [debug] [Thread-3  ]: finished collecting timing info
16:17:42.037560 [debug] [Thread-3  ]: Began executing node model.first_project.postgres_sample_source_customers
16:17:42.022801 [debug] [Thread-4  ]: Compiling model.first_project.stg_customers
16:17:42.053509 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_customers"
16:17:42.036773 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:17:42.037122 [debug] [Thread-1  ]: Began executing node model.first_project.customers2
16:17:42.054217 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:17:42.062695 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:17:42.057243 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers2"
16:17:42.062429 [debug] [Thread-4  ]: finished collecting timing info
16:17:42.063155 [debug] [Thread-4  ]: Began executing node model.first_project.stg_customers
16:17:42.062779 [debug] [Thread-2  ]: Opening a new connection, currently in state init
16:17:42.066638 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_customers"
16:17:42.067636 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
16:17:42.066818 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:17:42.067752 [debug] [Thread-4  ]: On model.first_project.stg_customers: BEGIN
16:17:42.067972 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:17:42.067853 [debug] [Thread-1  ]: On model.first_project.customers2: BEGIN
16:17:42.068172 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:17:42.055542 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
16:17:42.068527 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:17:42.068707 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: BEGIN
16:17:42.068782 [debug] [Thread-3  ]: Opening a new connection, currently in state init
16:17:42.076215 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
16:17:42.076428 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
16:17:42.076524 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
)
select * from customers
  );
16:17:42.079599 [debug] [Thread-4  ]: SQL status: SELECT 100 in 0.0 seconds
16:17:42.084762 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
16:17:42.085157 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
16:17:42.085322 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
16:17:42.085496 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:17:42.085555 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
16:17:42.085394 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
16:17:42.085656 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:17:42.085761 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:17:42.086294 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
16:17:42.088157 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
16:17:42.088263 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
16:17:42.090139 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:17:42.088524 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
16:17:42.090233 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:17:42.088322 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
16:17:42.103306 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:17:42.090349 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:17:42.103495 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
16:17:42.103622 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select
 codigo_cliente as customer_id,
 nome as first_name,
 sobrenome as last_name,
 codigo_regiao as region_code
 from erp_oltp.public.clientes
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
16:17:42.103738 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:17:42.105183 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:17:42.105269 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:17:42.105402 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
16:17:42.106661 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:17:42.106754 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
16:17:42.106840 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:17:42.116661 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
16:17:42.088687 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
16:17:42.116873 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.01 seconds
16:17:42.127537 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:17:42.129607 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:17:42.129354 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:17:42.129473 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
16:17:42.130707 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
16:17:42.130808 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
16:17:42.129808 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
16:17:42.129695 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:17:42.130876 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
16:17:42.121159 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
16:17:42.131286 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:17:42.131485 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:17:42.133185 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:17:42.133429 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
16:17:42.136595 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:17:42.136701 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:17:42.133567 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
16:17:42.136901 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
16:17:42.133690 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
16:17:42.137865 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
16:17:42.138343 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
16:17:42.138507 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
16:17:42.139332 [debug] [Thread-2  ]: finished collecting timing info
16:17:42.139475 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:17:42.139578 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
16:17:42.139698 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:17:42.140215 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
16:17:42.142739 [debug] [Thread-4  ]: finished collecting timing info
16:17:42.142841 [debug] [Thread-4  ]: On model.first_project.stg_customers: Close
16:17:42.143107 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aeb1e19-807d-4c0f-8407-89a803533b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0b7c95e0>]}
16:17:42.143329 [info ] [Thread-4  ]: 4 of 6 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.13s]
16:17:42.143570 [debug] [Thread-4  ]: Finished running node model.first_project.stg_customers
16:17:42.141145 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:17:42.143661 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
16:17:42.143876 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aeb1e19-807d-4c0f-8407-89a803533b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0b7a6430>]}
16:17:42.144047 [info ] [Thread-2  ]: 2 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.15s]
16:17:42.144218 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:17:42.145250 [debug] [Thread-6  ]: Began running node model.first_project.customers
16:17:42.145466 [info ] [Thread-6  ]: 5 of 6 START table model public.customers ...................................... [RUN]
16:17:42.145689 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers"
16:17:42.145762 [debug] [Thread-6  ]: Began compiling node model.first_project.customers
16:17:42.145828 [debug] [Thread-6  ]: Compiling model.first_project.customers
16:17:42.147343 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers"
16:17:42.147590 [debug] [Thread-6  ]: finished collecting timing info
16:17:42.147713 [debug] [Thread-6  ]: Began executing node model.first_project.customers
16:17:42.142076 [debug] [Thread-1  ]: On model.first_project.customers2: COMMIT
16:17:42.150699 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:17:42.150891 [debug] [Thread-1  ]: On model.first_project.customers2: COMMIT
16:17:42.150591 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
16:17:42.150788 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
16:17:42.151104 [info ] [Thread-7  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
16:17:42.152236 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:17:42.151837 [debug] [Thread-3  ]: finished collecting timing info
16:17:42.152324 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
16:17:42.152609 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
16:17:42.152497 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: Close
16:17:42.154270 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
16:17:42.156564 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
16:17:42.154511 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aeb1e19-807d-4c0f-8407-89a803533b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec08259d60>]}
16:17:42.154115 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:17:42.157247 [debug] [Thread-7  ]: finished collecting timing info
16:17:42.157405 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
16:17:42.156935 [info ] [Thread-3  ]: 3 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.14s]
16:17:42.156669 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
16:17:42.158757 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:17:42.159398 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:17:42.159538 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: BEGIN
16:17:42.159609 [debug] [Thread-7  ]: Opening a new connection, currently in state init
16:17:42.159059 [debug] [Thread-3  ]: Finished running node model.first_project.postgres_sample_source_customers
16:17:42.150482 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers"
16:17:42.160980 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
16:17:42.161151 [debug] [Thread-6  ]: On model.first_project.customers: BEGIN
16:17:42.161229 [debug] [Thread-6  ]: Opening a new connection, currently in state init
16:17:42.164186 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
16:17:42.165198 [debug] [Thread-1  ]: finished collecting timing info
16:17:42.165359 [debug] [Thread-1  ]: On model.first_project.customers2: Close
16:17:42.165693 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aeb1e19-807d-4c0f-8407-89a803533b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0d7030a0>]}
16:17:42.165945 [info ] [Thread-1  ]: 1 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.17s]
16:17:42.166185 [debug] [Thread-1  ]: Finished running node model.first_project.customers2
16:17:42.185368 [debug] [Thread-7  ]: SQL status: BEGIN in 0.03 seconds
16:17:42.185594 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:17:42.185670 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:17:42.186950 [debug] [Thread-7  ]: SQL status: CREATE VIEW in 0.0 seconds
16:17:42.188685 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:17:42.188808 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:17:42.200920 [debug] [Thread-6  ]: SQL status: BEGIN in 0.04 seconds
16:17:42.201273 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
16:17:42.201372 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
16:17:42.202302 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.01 seconds
16:17:42.203729 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: COMMIT
16:17:42.203954 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:17:42.204044 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
16:17:42.205687 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
16:17:42.205779 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:17:42.204123 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: COMMIT
16:17:42.206076 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
16:17:42.207281 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
16:17:42.207380 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:17:42.207684 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
16:17:42.208581 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
16:17:42.208674 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
16:17:42.208737 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
16:17:42.214213 [debug] [Thread-7  ]: SQL status: COMMIT in 0.01 seconds
16:17:42.215639 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:17:42.215753 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:17:42.215890 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
16:17:42.216708 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
16:17:42.216790 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:17:42.217010 [debug] [Thread-7  ]: SQL status: DROP VIEW in 0.0 seconds
16:17:42.218028 [debug] [Thread-7  ]: finished collecting timing info
16:17:42.218242 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: Close
16:17:42.218560 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aeb1e19-807d-4c0f-8407-89a803533b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0823d220>]}
16:17:42.220475 [info ] [Thread-7  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
16:17:42.218148 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
16:17:42.221636 [debug] [Thread-6  ]: finished collecting timing info
16:17:42.221812 [debug] [Thread-6  ]: On model.first_project.customers: Close
16:17:42.222173 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aeb1e19-807d-4c0f-8407-89a803533b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec08227c40>]}
16:17:42.222419 [info ] [Thread-6  ]: 5 of 6 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.08s]
16:17:42.222672 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
16:17:42.222789 [debug] [Thread-6  ]: Finished running node model.first_project.customers
16:17:42.224340 [debug] [MainThread]: Acquiring new postgres connection "master"
16:17:42.224478 [debug] [MainThread]: Using postgres connection "master"
16:17:42.224553 [debug] [MainThread]: On master: BEGIN
16:17:42.224613 [debug] [MainThread]: Opening a new connection, currently in state closed
16:17:42.261320 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
16:17:42.261542 [debug] [MainThread]: On master: COMMIT
16:17:42.261616 [debug] [MainThread]: Using postgres connection "master"
16:17:42.261680 [debug] [MainThread]: On master: COMMIT
16:17:42.261836 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:17:42.261943 [debug] [MainThread]: On master: Close
16:17:42.262346 [info ] [MainThread]: 
16:17:42.262522 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0.36s.
16:17:42.262631 [debug] [MainThread]: Connection 'master' was properly closed.
16:17:42.262686 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
16:17:42.262736 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:17:42.262796 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
16:17:42.262845 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
16:17:42.262895 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:17:42.262942 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:17:42.272135 [info ] [MainThread]: 
16:17:42.272490 [info ] [MainThread]: [32mCompleted successfully[0m
16:17:42.272771 [info ] [MainThread]: 
16:17:42.272916 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
16:17:42.273229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0b7f4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0b8fc550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec0d124490>]}


============================== 2022-06-07 16:23:12.116121 | 6c58feb1-6ee7-408e-9b2f-f4bcb012ea8e ==============================
16:23:12.116134 [info ] [MainThread]: Running with dbt=1.1.0
16:23:12.116497 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:23:12.116648 [debug] [MainThread]: Tracking: tracking
16:23:12.119020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7786872190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7786872940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7786872ca0>]}
16:23:12.138691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
16:23:12.139046 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers2.sql
16:23:12.152240 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers2.sql
16:23:12.166952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c58feb1-6ee7-408e-9b2f-f4bcb012ea8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77862cc0d0>]}
16:23:12.170579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c58feb1-6ee7-408e-9b2f-f4bcb012ea8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f778675cfd0>]}
16:23:12.170859 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
16:23:12.171020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c58feb1-6ee7-408e-9b2f-f4bcb012ea8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f778675cd90>]}
16:23:12.172080 [info ] [MainThread]: 
16:23:12.172466 [debug] [MainThread]: Acquiring new postgres connection "master"
16:23:12.173232 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:23:12.181665 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:23:12.181865 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:23:12.181945 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:23:12.195312 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:23:12.196951 [debug] [ThreadPool]: On list_erp_oltp: Close
16:23:12.199507 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:23:12.226484 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:23:12.226743 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:23:12.226819 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:23:12.230807 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
16:23:12.230966 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:23:12.231032 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:23:12.233313 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
16:23:12.234301 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:23:12.234596 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:23:12.237364 [debug] [MainThread]: Using postgres connection "master"
16:23:12.237485 [debug] [MainThread]: On master: BEGIN
16:23:12.237549 [debug] [MainThread]: Opening a new connection, currently in state init
16:23:12.241056 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:23:12.241214 [debug] [MainThread]: Using postgres connection "master"
16:23:12.241276 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:23:12.250366 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
16:23:12.251289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c58feb1-6ee7-408e-9b2f-f4bcb012ea8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77889cd310>]}
16:23:12.251510 [debug] [MainThread]: On master: ROLLBACK
16:23:12.251716 [debug] [MainThread]: Using postgres connection "master"
16:23:12.251796 [debug] [MainThread]: On master: BEGIN
16:23:12.251998 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:23:12.252079 [debug] [MainThread]: On master: COMMIT
16:23:12.252138 [debug] [MainThread]: Using postgres connection "master"
16:23:12.252190 [debug] [MainThread]: On master: COMMIT
16:23:12.252312 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:23:12.252396 [debug] [MainThread]: On master: Close
16:23:12.252657 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:23:12.252801 [info ] [MainThread]: 
16:23:12.256892 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
16:23:12.257129 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
16:23:12.257408 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:23:12.257490 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
16:23:12.257563 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
16:23:12.258960 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:23:12.259464 [debug] [Thread-1  ]: finished collecting timing info
16:23:12.259649 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
16:23:12.269755 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
16:23:12.269945 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
16:23:12.270181 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
16:23:12.270259 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
16:23:12.270332 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
16:23:12.271521 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
16:23:12.271850 [debug] [Thread-2  ]: finished collecting timing info
16:23:12.271981 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
16:23:12.282009 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
16:23:12.289442 [info ] [Thread-3  ]: 3 of 6 START table model public.stg_customers .................................. [RUN]
16:23:12.290035 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
16:23:12.290171 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
16:23:12.290261 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
16:23:12.291218 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
16:23:12.298982 [debug] [Thread-3  ]: finished collecting timing info
16:23:12.303087 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
16:23:12.303325 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
16:23:12.303555 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:23:12.307222 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:23:12.307316 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
16:23:12.306762 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:23:12.307534 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
16:23:12.307380 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:23:12.306361 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
16:23:12.308271 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
16:23:12.308391 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
16:23:12.308450 [debug] [Thread-3  ]: Opening a new connection, currently in state init
16:23:12.307621 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:23:12.312789 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:23:12.313100 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:23:12.313192 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:23:12.314526 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
16:23:12.318996 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:23:12.319270 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:23:12.319622 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:23:12.321871 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:23:12.322023 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:23:12.322298 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:23:12.335450 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
16:23:12.335608 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
16:23:12.335994 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
16:23:12.335730 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
16:23:12.336072 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
)
select * from customers
  );
16:23:12.335887 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:23:12.336260 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:23:12.336492 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
16:23:12.336616 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
16:23:12.337921 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.0 seconds
16:23:12.339787 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
16:23:12.339900 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
16:23:12.340003 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
16:23:12.340159 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
16:23:12.341482 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:23:12.344785 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:23:12.345029 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
16:23:12.345156 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
16:23:12.346811 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
16:23:12.347010 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
16:23:12.345348 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:23:12.347780 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:23:12.347933 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
16:23:12.349221 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:23:12.350078 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
16:23:12.350360 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
16:23:12.350256 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
16:23:12.350428 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
16:23:12.350157 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
16:23:12.351156 [debug] [Thread-1  ]: finished collecting timing info
16:23:12.351290 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
16:23:12.351381 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:23:12.352332 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
16:23:12.353833 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
16:23:12.353705 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
16:23:12.351494 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
16:23:12.354332 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:23:12.354559 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
16:23:12.355193 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
16:23:12.356196 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
16:23:12.356297 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
16:23:12.356371 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
16:23:12.357344 [debug] [Thread-3  ]: finished collecting timing info
16:23:12.357453 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
16:23:12.357723 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c58feb1-6ee7-408e-9b2f-f4bcb012ea8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77841f02b0>]}
16:23:12.357940 [info ] [Thread-3  ]: 3 of 6 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.07s]
16:23:12.358170 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
16:23:12.356633 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c58feb1-6ee7-408e-9b2f-f4bcb012ea8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f778624cee0>]}
16:23:12.358535 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.10s]
16:23:12.358768 [debug] [Thread-5  ]: Began running node model.first_project.customers
16:23:12.360198 [info ] [Thread-5  ]: 4 of 6 START table model public.customers ...................................... [RUN]
16:23:12.359180 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
16:23:12.360645 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customers"
16:23:12.361166 [debug] [Thread-5  ]: Began compiling node model.first_project.customers
16:23:12.361263 [debug] [Thread-5  ]: Compiling model.first_project.customers
16:23:12.362935 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customers"
16:23:12.358859 [debug] [Thread-6  ]: Began running node model.first_project.customers2
16:23:12.363619 [info ] [Thread-6  ]: 5 of 6 START table model public.customers2 ..................................... [RUN]
16:23:12.363883 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
16:23:12.363955 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
16:23:12.364019 [debug] [Thread-6  ]: Compiling model.first_project.customers2
16:23:12.361028 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
16:23:12.365439 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
16:23:12.365957 [debug] [Thread-6  ]: finished collecting timing info
16:23:12.365607 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
16:23:12.366338 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:23:12.366076 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
16:23:12.367828 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
16:23:12.366412 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
16:23:12.367998 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
16:23:12.363208 [debug] [Thread-5  ]: finished collecting timing info
16:23:12.369668 [debug] [Thread-5  ]: Began executing node model.first_project.customers
16:23:12.369141 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:23:12.371281 [debug] [Thread-8  ]: finished collecting timing info
16:23:12.371414 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
16:23:12.369538 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
16:23:12.378339 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
16:23:12.378511 [debug] [Thread-6  ]: Opening a new connection, currently in state init
16:23:12.371036 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.customers"
16:23:12.379903 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
16:23:12.380077 [debug] [Thread-5  ]: On model.first_project.customers: BEGIN
16:23:12.380140 [debug] [Thread-5  ]: Opening a new connection, currently in state init
16:23:12.381575 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:23:12.365704 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
16:23:12.381845 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:23:12.387242 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
16:23:12.387348 [debug] [Thread-8  ]: Opening a new connection, currently in state init
16:23:12.388211 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
16:23:12.388335 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
16:23:12.388396 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
16:23:12.386892 [debug] [Thread-2  ]: finished collecting timing info
16:23:12.388679 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
16:23:12.389744 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c58feb1-6ee7-408e-9b2f-f4bcb012ea8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f778626ffd0>]}
16:23:12.390037 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.12s]
16:23:12.393930 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
16:23:12.398566 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.01 seconds
16:23:12.400395 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
16:23:12.400500 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
16:23:12.400874 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
16:23:12.400991 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
16:23:12.403332 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
16:23:12.403395 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
16:23:12.403218 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
16:23:12.403497 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
16:23:12.404075 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
16:23:12.405200 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
16:23:12.405345 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
16:23:12.405410 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
16:23:12.405804 [debug] [Thread-5  ]: SQL status: SELECT 100 in 0.0 seconds
16:23:12.407643 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
16:23:12.407745 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:23:12.407936 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
16:23:12.408883 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
16:23:12.408956 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
16:23:12.411636 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
16:23:12.411811 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:23:12.409004 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
16:23:12.412074 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:23:12.412186 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:23:12.413075 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
16:23:12.413199 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
16:23:12.415588 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:23:12.416267 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:23:12.409205 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
16:23:12.414279 [debug] [Thread-5  ]: On model.first_project.customers: COMMIT
16:23:12.416424 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
16:23:12.418905 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
16:23:12.420007 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
16:23:12.420126 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:23:12.420188 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
16:23:12.418976 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
16:23:12.419088 [debug] [Thread-5  ]: On model.first_project.customers: COMMIT
16:23:12.421149 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
16:23:12.422053 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:23:12.423041 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:23:12.421037 [debug] [Thread-6  ]: finished collecting timing info
16:23:12.423196 [debug] [Thread-6  ]: On model.first_project.customers2: Close
16:23:12.423627 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c58feb1-6ee7-408e-9b2f-f4bcb012ea8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77841ec0d0>]}
16:23:12.423854 [info ] [Thread-6  ]: 5 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.06s]
16:23:12.424231 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
16:23:12.429528 [debug] [Thread-5  ]: SQL status: COMMIT in 0.01 seconds
16:23:12.430907 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
16:23:12.431044 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:23:12.431185 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.01 seconds
16:23:12.431918 [debug] [Thread-8  ]: finished collecting timing info
16:23:12.432033 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
16:23:12.432398 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c58feb1-6ee7-408e-9b2f-f4bcb012ea8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77841ec1c0>]}
16:23:12.432623 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
16:23:12.433275 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
16:23:12.433500 [debug] [Thread-5  ]: SQL status: DROP TABLE in 0.0 seconds
16:23:12.434308 [debug] [Thread-5  ]: finished collecting timing info
16:23:12.434408 [debug] [Thread-5  ]: On model.first_project.customers: Close
16:23:12.434707 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c58feb1-6ee7-408e-9b2f-f4bcb012ea8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7786267880>]}
16:23:12.434904 [info ] [Thread-5  ]: 4 of 6 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.07s]
16:23:12.435142 [debug] [Thread-5  ]: Finished running node model.first_project.customers
16:23:12.436415 [debug] [MainThread]: Acquiring new postgres connection "master"
16:23:12.436530 [debug] [MainThread]: Using postgres connection "master"
16:23:12.436594 [debug] [MainThread]: On master: BEGIN
16:23:12.436648 [debug] [MainThread]: Opening a new connection, currently in state closed
16:23:12.440750 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:23:12.440943 [debug] [MainThread]: On master: COMMIT
16:23:12.441019 [debug] [MainThread]: Using postgres connection "master"
16:23:12.441165 [debug] [MainThread]: On master: COMMIT
16:23:12.441471 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:23:12.441583 [debug] [MainThread]: On master: Close
16:23:12.441885 [info ] [MainThread]: 
16:23:12.442020 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0.27s.
16:23:12.442166 [debug] [MainThread]: Connection 'master' was properly closed.
16:23:12.442227 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
16:23:12.442274 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:23:12.442320 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
16:23:12.442364 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:23:12.442409 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
16:23:12.442453 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:23:12.446052 [info ] [MainThread]: 
16:23:12.446265 [info ] [MainThread]: [32mCompleted successfully[0m
16:23:12.446409 [info ] [MainThread]: 
16:23:12.446504 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
16:23:12.446667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77868728e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f778686d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77880d0820>]}


============================== 2022-06-07 17:40:09.239869 | 26371c0f-69fa-4827-aef8-8f78b8c81c74 ==============================
17:40:09.239881 [info ] [MainThread]: Running with dbt=1.1.0
17:40:09.241275 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:40:09.241361 [debug] [MainThread]: Tracking: tracking
17:40:09.243441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab00d0cf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab00d0ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab00d0caf0>]}
17:40:09.281437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:40:09.281600 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:40:09.285340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26371c0f-69fa-4827-aef8-8f78b8c81c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab00bb2f10>]}
17:40:09.290841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26371c0f-69fa-4827-aef8-8f78b8c81c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab00bfca00>]}
17:40:09.291061 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:40:09.291202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26371c0f-69fa-4827-aef8-8f78b8c81c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab00bfc9d0>]}
17:40:09.292105 [info ] [MainThread]: 
17:40:09.292409 [debug] [MainThread]: Acquiring new postgres connection "master"
17:40:09.293098 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:40:09.300701 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:40:09.300883 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:40:09.300945 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:40:09.317667 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
17:40:09.317840 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:40:09.317928 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:40:09.320441 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:40:09.321512 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:40:09.321682 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:40:09.324309 [debug] [MainThread]: Using postgres connection "master"
17:40:09.324396 [debug] [MainThread]: On master: BEGIN
17:40:09.324451 [debug] [MainThread]: Opening a new connection, currently in state init
17:40:09.328424 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:40:09.328524 [debug] [MainThread]: Using postgres connection "master"
17:40:09.328588 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:40:09.345647 [debug] [MainThread]: SQL status: SELECT 2 in 0.02 seconds
17:40:09.346553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26371c0f-69fa-4827-aef8-8f78b8c81c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab00bfc7c0>]}
17:40:09.346749 [debug] [MainThread]: On master: ROLLBACK
17:40:09.346960 [debug] [MainThread]: Using postgres connection "master"
17:40:09.347034 [debug] [MainThread]: On master: BEGIN
17:40:09.347230 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:40:09.347304 [debug] [MainThread]: On master: COMMIT
17:40:09.347357 [debug] [MainThread]: Using postgres connection "master"
17:40:09.347406 [debug] [MainThread]: On master: COMMIT
17:40:09.347514 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:40:09.347582 [debug] [MainThread]: On master: Close
17:40:09.347868 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:40:09.348006 [info ] [MainThread]: 
17:40:09.356902 [debug] [Thread-1  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:40:09.357045 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:40:09.357321 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:40:09.357404 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:40:09.357477 [debug] [Thread-1  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:40:09.365793 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:40:09.365958 [debug] [Thread-3  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:40:09.368580 [info ] [Thread-3  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
17:40:09.368374 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:40:09.368980 [info ] [Thread-4  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
17:40:09.368229 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:40:09.368900 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:40:09.369209 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:40:09.369418 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:40:09.369329 [debug] [Thread-3  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:40:09.369493 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:40:09.368469 [info ] [Thread-2  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:40:09.373519 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:40:09.373234 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:40:09.373589 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:40:09.373751 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:40:09.369673 [debug] [Thread-3  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:40:09.377404 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:40:09.404387 [debug] [Thread-4  ]: finished collecting timing info
17:40:09.404599 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:40:09.414391 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:40:09.416223 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:40:09.416987 [debug] [Thread-3  ]: finished collecting timing info
17:40:09.416682 [debug] [Thread-2  ]: finished collecting timing info
17:40:09.417341 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:40:09.417121 [debug] [Thread-3  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:40:09.418352 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:40:09.416474 [debug] [Thread-1  ]: finished collecting timing info
17:40:09.419430 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:40:09.419632 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:40:09.419894 [debug] [Thread-3  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:40:09.420064 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:40:09.421130 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:40:09.421024 [debug] [Thread-3  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:40:09.421202 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:40:09.420881 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:40:09.421294 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:40:09.421385 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:40:09.422288 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:40:09.423101 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:40:09.423154 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:40:09.422916 [debug] [Thread-4  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:40:09.423739 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:40:09.426662 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:40:09.426775 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:40:09.426834 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:40:09.429529 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:40:09.430869 [debug] [Thread-2  ]: finished collecting timing info
17:40:09.430993 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:40:09.431329 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:40:09.431629 [info ] [Thread-2  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.06s]
17:40:09.431858 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:40:09.435936 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
17:40:09.436074 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:40:09.436155 [debug] [Thread-4  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:40:09.436639 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:40:09.436729 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:40:09.436783 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:40:09.436893 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
17:40:09.437711 [debug] [Thread-4  ]: finished collecting timing info
17:40:09.437810 [debug] [Thread-4  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:40:09.438177 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
17:40:09.438926 [debug] [Thread-1  ]: finished collecting timing info
17:40:09.439023 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:40:09.440383 [debug] [Thread-4  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:40:09.440729 [info ] [Thread-4  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.07s]
17:40:09.441033 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:40:09.441379 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:40:09.441657 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.08s]
17:40:09.441878 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:40:09.444428 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:40:09.444549 [debug] [Thread-3  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:40:09.444629 [debug] [Thread-3  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:40:09.446284 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:40:09.447471 [debug] [Thread-3  ]: finished collecting timing info
17:40:09.447599 [debug] [Thread-3  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:40:09.447983 [debug] [Thread-3  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:40:09.448413 [info ] [Thread-3  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.08s]
17:40:09.448685 [debug] [Thread-3  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:40:09.449879 [debug] [MainThread]: Acquiring new postgres connection "master"
17:40:09.449979 [debug] [MainThread]: Using postgres connection "master"
17:40:09.450036 [debug] [MainThread]: On master: BEGIN
17:40:09.450087 [debug] [MainThread]: Opening a new connection, currently in state closed
17:40:09.453425 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:40:09.453525 [debug] [MainThread]: On master: COMMIT
17:40:09.453603 [debug] [MainThread]: Using postgres connection "master"
17:40:09.453667 [debug] [MainThread]: On master: COMMIT
17:40:09.453775 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:40:09.453843 [debug] [MainThread]: On master: Close
17:40:09.454044 [info ] [MainThread]: 
17:40:09.454163 [info ] [MainThread]: Finished running 4 tests in 0.16s.
17:40:09.454255 [debug] [MainThread]: Connection 'master' was properly closed.
17:40:09.454302 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:40:09.454347 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:40:09.454391 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:40:09.454435 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:40:09.459177 [info ] [MainThread]: 
17:40:09.459604 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:40:09.459830 [info ] [MainThread]: 
17:40:09.459981 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:40:09.460141 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:40:09.460329 [info ] [MainThread]: 
17:40:09.460459 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:40:09.460615 [info ] [MainThread]: 
17:40:09.460743 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
17:40:09.460996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab025a9e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab00b30550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab00296f10>]}


============================== 2022-06-07 17:55:53.436395 | b9432c66-1cae-471b-bd21-8e5e10aae8ce ==============================
17:55:53.436408 [info ] [MainThread]: Running with dbt=1.1.0
17:55:53.436733 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:55:53.436829 [debug] [MainThread]: Tracking: tracking
17:55:53.439061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c23748700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c23748940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c23748c70>]}
17:55:53.456353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
17:55:53.456641 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/schema.yml
17:55:53.486461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9432c66-1cae-471b-bd21-8e5e10aae8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c235b20d0>]}
17:55:53.490180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9432c66-1cae-471b-bd21-8e5e10aae8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c23633e50>]}
17:55:53.490469 [info ] [MainThread]: Found 6 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:55:53.490634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9432c66-1cae-471b-bd21-8e5e10aae8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c23633dc0>]}
17:55:53.491818 [info ] [MainThread]: 
17:55:53.492388 [debug] [MainThread]: Acquiring new postgres connection "master"
17:55:53.493273 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:55:53.502466 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:55:53.502709 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:55:53.502780 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:55:53.509099 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:55:53.509312 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:55:53.509379 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:55:53.510813 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:55:53.511798 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:55:53.512115 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:55:53.535645 [debug] [MainThread]: Using postgres connection "master"
17:55:53.535785 [debug] [MainThread]: On master: BEGIN
17:55:53.535842 [debug] [MainThread]: Opening a new connection, currently in state init
17:55:53.539482 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:55:53.539604 [debug] [MainThread]: Using postgres connection "master"
17:55:53.539663 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:55:53.548574 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
17:55:53.549561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9432c66-1cae-471b-bd21-8e5e10aae8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c255249a0>]}
17:55:53.549796 [debug] [MainThread]: On master: ROLLBACK
17:55:53.549962 [debug] [MainThread]: Using postgres connection "master"
17:55:53.550040 [debug] [MainThread]: On master: BEGIN
17:55:53.550198 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:55:53.550278 [debug] [MainThread]: On master: COMMIT
17:55:53.550338 [debug] [MainThread]: Using postgres connection "master"
17:55:53.550393 [debug] [MainThread]: On master: COMMIT
17:55:53.550493 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:55:53.550569 [debug] [MainThread]: On master: Close
17:55:53.550856 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:55:53.551017 [info ] [MainThread]: 
17:55:53.557618 [debug] [Thread-1  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:55:53.557758 [info ] [Thread-1  ]: 1 of 5 START test not_null_customers_customer_id ............................... [RUN]
17:55:53.558152 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:55:53.558239 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:55:53.558308 [debug] [Thread-1  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
17:55:53.565710 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:55:53.565833 [info ] [Thread-2  ]: 2 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:55:53.565935 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:55:53.568828 [info ] [Thread-3  ]: 3 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:55:53.568367 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:55:53.569240 [info ] [Thread-4  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
17:55:53.569445 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:55:53.569516 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:55:53.569113 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:55:53.569727 [info ] [Thread-5  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
17:55:53.569578 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:55:53.568652 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:55:53.574465 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:55:53.574587 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:55:53.569039 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:55:53.577129 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:55:53.577245 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:55:53.579279 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:55:53.576854 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:55:53.569940 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:55:53.579705 [debug] [Thread-2  ]: finished collecting timing info
17:55:53.580885 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:55:53.574279 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:55:53.580475 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:55:53.589954 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:55:53.592941 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:55:53.589545 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:55:53.580719 [debug] [Thread-3  ]: finished collecting timing info
17:55:53.593688 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:55:53.595580 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:55:53.593473 [debug] [Thread-4  ]: finished collecting timing info
17:55:53.593300 [debug] [Thread-5  ]: finished collecting timing info
17:55:53.596382 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:55:53.597282 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:55:53.595987 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:55:53.598851 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:55:53.595808 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:55:53.599220 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:55:53.596143 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:55:53.599644 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:55:53.599310 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:55:53.599473 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:55:53.600443 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:55:53.567915 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:55:53.599086 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:55:53.600700 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:55:53.600787 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:55:53.600517 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:55:53.599755 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:55:53.602085 [debug] [Thread-1  ]: finished collecting timing info
17:55:53.602181 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:55:53.603030 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:55:53.603684 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:55:53.603760 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
17:55:53.603813 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:55:53.606599 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:55:53.606726 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
17:55:53.606826 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:55:53.607007 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:55:53.607327 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:55:53.607220 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:55:53.607107 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:55:53.607669 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:55:53.607488 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:55:53.608372 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:55:53.610033 [debug] [Thread-3  ]: finished collecting timing info
17:55:53.610218 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:55:53.610354 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:55:53.610471 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:55:53.611441 [debug] [Thread-2  ]: finished collecting timing info
17:55:53.611724 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:55:53.611517 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
17:55:53.612432 [debug] [Thread-5  ]: finished collecting timing info
17:55:53.612676 [info ] [Thread-3  ]: 3 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.04s]
17:55:53.612825 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:55:53.612899 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:55:53.613228 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:55:53.613565 [error] [Thread-2  ]: 2 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.05s]
17:55:53.613769 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:55:53.613869 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:55:53.614164 [info ] [Thread-5  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.04s]
17:55:53.614339 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:55:53.618046 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:55:53.618214 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:55:53.618277 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
17:55:53.618490 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
17:55:53.618613 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:55:53.618679 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:55:53.619403 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
17:55:53.620194 [debug] [Thread-1  ]: finished collecting timing info
17:55:53.620291 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
17:55:53.620420 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
17:55:53.621343 [debug] [Thread-4  ]: finished collecting timing info
17:55:53.621438 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:55:53.621528 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
17:55:53.621792 [info ] [Thread-1  ]: 1 of 5 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.06s]
17:55:53.622018 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:55:53.622263 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:55:53.622526 [info ] [Thread-4  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.05s]
17:55:53.622794 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:55:53.623747 [debug] [MainThread]: Acquiring new postgres connection "master"
17:55:53.623881 [debug] [MainThread]: Using postgres connection "master"
17:55:53.623939 [debug] [MainThread]: On master: BEGIN
17:55:53.623990 [debug] [MainThread]: Opening a new connection, currently in state closed
17:55:53.631466 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:55:53.631700 [debug] [MainThread]: On master: COMMIT
17:55:53.631761 [debug] [MainThread]: Using postgres connection "master"
17:55:53.631816 [debug] [MainThread]: On master: COMMIT
17:55:53.632092 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:55:53.632199 [debug] [MainThread]: On master: Close
17:55:53.632568 [info ] [MainThread]: 
17:55:53.632768 [info ] [MainThread]: Finished running 5 tests in 0.14s.
17:55:53.632888 [debug] [MainThread]: Connection 'master' was properly closed.
17:55:53.632939 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
17:55:53.632986 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:55:53.633032 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:55:53.633076 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:55:53.633119 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:55:53.635830 [info ] [MainThread]: 
17:55:53.636049 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:55:53.636187 [info ] [MainThread]: 
17:55:53.636307 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:55:53.636494 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:55:53.636611 [info ] [MainThread]: 
17:55:53.636725 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:55:53.636848 [info ] [MainThread]: 
17:55:53.636961 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
17:55:53.637135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c2552f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c25531c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c25544f10>]}


============================== 2022-06-07 17:58:28.300475 | db89c398-8acb-4528-be29-a40ed5bc65c0 ==============================
17:58:28.300488 [info ] [MainThread]: Running with dbt=1.1.0
17:58:28.300937 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:58:28.301072 [debug] [MainThread]: Tracking: tracking
17:58:28.303462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be71c2100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be71c2940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be71c2ca0>]}
17:58:28.322899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:58:28.323365 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
17:58:28.334089 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
17:58:28.359571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db89c398-8acb-4528-be29-a40ed5bc65c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be7054ac0>]}
17:58:28.388220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db89c398-8acb-4528-be29-a40ed5bc65c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be9389490>]}
17:58:28.388478 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:58:28.388682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db89c398-8acb-4528-be29-a40ed5bc65c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be9389850>]}
17:58:28.389691 [info ] [MainThread]: 
17:58:28.390086 [debug] [MainThread]: Acquiring new postgres connection "master"
17:58:28.390959 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:58:28.397899 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:58:28.398109 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:58:28.398237 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:58:28.405170 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:58:28.405344 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:58:28.405409 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:58:28.410647 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.01 seconds
17:58:28.411777 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:58:28.412056 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:58:28.415382 [debug] [MainThread]: Using postgres connection "master"
17:58:28.415725 [debug] [MainThread]: On master: BEGIN
17:58:28.415820 [debug] [MainThread]: Opening a new connection, currently in state init
17:58:28.422990 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:58:28.423165 [debug] [MainThread]: Using postgres connection "master"
17:58:28.423229 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:58:28.434188 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
17:58:28.435275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db89c398-8acb-4528-be29-a40ed5bc65c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be93169a0>]}
17:58:28.435502 [debug] [MainThread]: On master: ROLLBACK
17:58:28.435869 [debug] [MainThread]: Using postgres connection "master"
17:58:28.435964 [debug] [MainThread]: On master: BEGIN
17:58:28.436190 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:58:28.436289 [debug] [MainThread]: On master: COMMIT
17:58:28.436382 [debug] [MainThread]: Using postgres connection "master"
17:58:28.436467 [debug] [MainThread]: On master: COMMIT
17:58:28.436588 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:58:28.436668 [debug] [MainThread]: On master: Close
17:58:28.436930 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:58:28.437064 [info ] [MainThread]: 
17:58:28.441113 [debug] [Thread-1  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:58:28.441261 [info ] [Thread-1  ]: 1 of 6 START test not_null_customers_customer_id ............................... [RUN]
17:58:28.441572 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:58:28.441655 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:58:28.441727 [debug] [Thread-1  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
17:58:28.449779 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:58:28.455512 [info ] [Thread-2  ]: 2 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:58:28.455975 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:58:28.456065 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:58:28.456138 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:58:28.458261 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:58:28.458518 [debug] [Thread-2  ]: finished collecting timing info
17:58:28.458653 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:58:28.455378 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:58:28.468888 [info ] [Thread-6  ]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
17:58:28.469190 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:58:28.469278 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:58:28.469389 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:58:28.468605 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:58:28.452652 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:58:28.455322 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:58:28.473484 [info ] [Thread-5  ]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
17:58:28.455262 [debug] [Thread-4  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
17:58:28.474001 [info ] [Thread-4  ]: 4 of 6 START test unique_customers_customer_id ................................. [RUN]
17:58:28.474227 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:58:28.474304 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
17:58:28.474384 [debug] [Thread-4  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
17:58:28.455129 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:58:28.480794 [info ] [Thread-3  ]: 3 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:58:28.481914 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:58:28.485626 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:58:28.485854 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:58:28.482184 [debug] [Thread-1  ]: finished collecting timing info
17:58:28.489986 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:58:28.491497 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:58:28.491810 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:58:28.491945 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
17:58:28.492022 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:58:28.489625 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:58:28.492578 [debug] [Thread-3  ]: finished collecting timing info
17:58:28.492689 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:58:28.473895 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:58:28.493951 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:58:28.494052 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:58:28.476909 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:58:28.496594 [debug] [Thread-4  ]: finished collecting timing info
17:58:28.496681 [debug] [Thread-4  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
17:58:28.497600 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:58:28.497915 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:58:28.498008 [debug] [Thread-4  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: BEGIN
17:58:28.498075 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:58:28.473026 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:58:28.499339 [debug] [Thread-6  ]: finished collecting timing info
17:58:28.499503 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:58:28.493780 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:58:28.496376 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:58:28.501306 [debug] [Thread-5  ]: finished collecting timing info
17:58:28.501425 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:58:28.501063 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:58:28.502506 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:58:28.485214 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:58:28.502715 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:58:28.502793 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:58:28.500724 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:58:28.503567 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:58:28.503682 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:58:28.503740 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:58:28.502602 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:58:28.502392 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:58:28.505121 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:58:28.505222 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:58:28.505277 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:58:28.506807 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:58:28.506926 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:58:28.506989 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
17:58:28.507915 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
17:58:28.509659 [debug] [Thread-1  ]: finished collecting timing info
17:58:28.509809 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
17:58:28.512385 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
17:58:28.512976 [info ] [Thread-1  ]: 1 of 6 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.07s]
17:58:28.513295 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:58:28.518486 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:58:28.518706 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:58:28.518779 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:58:28.520818 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
17:58:28.521088 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:58:28.521331 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
17:58:28.523019 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:58:28.523115 [debug] [Thread-4  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
17:58:28.521545 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:58:28.523210 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:58:28.522890 [debug] [Thread-3  ]: finished collecting timing info
17:58:28.525528 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:58:28.529306 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.01 seconds
17:58:28.530364 [debug] [Thread-5  ]: finished collecting timing info
17:58:28.530521 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:58:28.530698 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
17:58:28.530854 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:58:28.530952 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:58:28.531111 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:58:28.531255 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:58:28.531702 [info ] [Thread-3  ]: 3 of 6 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.05s]
17:58:28.532111 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:58:28.532395 [info ] [Thread-5  ]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
17:58:28.532936 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:58:28.533546 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
17:58:28.534483 [debug] [Thread-6  ]: finished collecting timing info
17:58:28.534618 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:58:28.536470 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:58:28.536825 [info ] [Thread-6  ]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.07s]
17:58:28.536990 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.01 seconds
17:58:28.537201 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
17:58:28.539005 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:58:28.538821 [debug] [Thread-4  ]: finished collecting timing info
17:58:28.539089 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:58:28.537820 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:58:28.539203 [debug] [Thread-4  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
17:58:28.539905 [debug] [Thread-4  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: Close
17:58:28.540080 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:58:28.540330 [error] [Thread-4  ]: 4 of 6 FAIL 50 unique_customers_customer_id .................................... [[31mFAIL 50[0m in 0.07s]
17:58:28.541386 [debug] [Thread-2  ]: finished collecting timing info
17:58:28.541824 [debug] [Thread-4  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
17:58:28.542004 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:58:28.542382 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:58:28.542704 [error] [Thread-2  ]: 2 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.09s]
17:58:28.542923 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:58:28.544045 [debug] [MainThread]: Acquiring new postgres connection "master"
17:58:28.544149 [debug] [MainThread]: Using postgres connection "master"
17:58:28.544208 [debug] [MainThread]: On master: BEGIN
17:58:28.544260 [debug] [MainThread]: Opening a new connection, currently in state closed
17:58:28.550521 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:58:28.550724 [debug] [MainThread]: On master: COMMIT
17:58:28.550788 [debug] [MainThread]: Using postgres connection "master"
17:58:28.550845 [debug] [MainThread]: On master: COMMIT
17:58:28.550998 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:58:28.551097 [debug] [MainThread]: On master: Close
17:58:28.551406 [info ] [MainThread]: 
17:58:28.551557 [info ] [MainThread]: Finished running 6 tests in 0.16s.
17:58:28.551659 [debug] [MainThread]: Connection 'master' was properly closed.
17:58:28.551711 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
17:58:28.551757 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:58:28.551802 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:58:28.551847 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:58:28.551892 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
17:58:28.551963 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:58:28.555245 [info ] [MainThread]: 
17:58:28.555408 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
17:58:28.555532 [info ] [MainThread]: 
17:58:28.555625 [error] [MainThread]: [31mFailure in test unique_customers_customer_id (models/erp/schema.yml)[0m
17:58:28.555726 [error] [MainThread]:   Got 50 results, configured to fail if != 0
17:58:28.555813 [info ] [MainThread]: 
17:58:28.555901 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_customers_customer_id.sql
17:58:28.555991 [info ] [MainThread]: 
17:58:28.556079 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:58:28.556169 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:58:28.560354 [info ] [MainThread]: 
17:58:28.560514 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:58:28.560625 [info ] [MainThread]: 
17:58:28.560716 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
17:58:28.560913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be89c21c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be9316550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be432a280>]}


============================== 2022-06-07 17:58:45.238532 | 5a7c01a0-9ff6-4654-aba3-3bdf06687ef1 ==============================
17:58:45.238548 [info ] [MainThread]: Running with dbt=1.1.0
17:58:45.238894 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:58:45.238993 [debug] [MainThread]: Tracking: tracking
17:58:45.242181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34ee82d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34ee82190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34ee82bb0>]}
17:58:45.260726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:58:45.260899 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:58:45.265218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a7c01a0-9ff6-4654-aba3-3bdf06687ef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34ed270d0>]}
17:58:45.269422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a7c01a0-9ff6-4654-aba3-3bdf06687ef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34ed790a0>]}
17:58:45.269836 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:58:45.270078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a7c01a0-9ff6-4654-aba3-3bdf06687ef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34ede6dc0>]}
17:58:45.271336 [info ] [MainThread]: 
17:58:45.271835 [debug] [MainThread]: Acquiring new postgres connection "master"
17:58:45.272994 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:58:45.279773 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:58:45.280230 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:58:45.280426 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:58:45.296387 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.02 seconds
17:58:45.297348 [debug] [ThreadPool]: On list_erp_oltp: Close
17:58:45.301478 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:58:45.306479 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:58:45.306698 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:58:45.306759 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:58:45.317835 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:58:45.318098 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:58:45.318186 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:58:45.320305 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:58:45.321356 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:58:45.321552 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:58:45.325867 [debug] [MainThread]: Using postgres connection "master"
17:58:45.326040 [debug] [MainThread]: On master: BEGIN
17:58:45.326099 [debug] [MainThread]: Opening a new connection, currently in state init
17:58:45.330185 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:58:45.330343 [debug] [MainThread]: Using postgres connection "master"
17:58:45.330406 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:58:45.340682 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
17:58:45.341989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a7c01a0-9ff6-4654-aba3-3bdf06687ef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34ee3d8e0>]}
17:58:45.342246 [debug] [MainThread]: On master: ROLLBACK
17:58:45.342622 [debug] [MainThread]: Using postgres connection "master"
17:58:45.342718 [debug] [MainThread]: On master: BEGIN
17:58:45.343197 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:58:45.343289 [debug] [MainThread]: On master: COMMIT
17:58:45.343347 [debug] [MainThread]: Using postgres connection "master"
17:58:45.343397 [debug] [MainThread]: On master: COMMIT
17:58:45.343603 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:58:45.343677 [debug] [MainThread]: On master: Close
17:58:45.344001 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:58:45.344144 [info ] [MainThread]: 
17:58:45.347256 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
17:58:45.347461 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:58:45.347720 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:58:45.347800 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
17:58:45.347872 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
17:58:45.349317 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:58:45.349631 [debug] [Thread-1  ]: finished collecting timing info
17:58:45.349744 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
17:58:45.388021 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
17:58:45.388381 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:58:45.388772 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:58:45.388882 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:58:45.388989 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
17:58:45.390909 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:58:45.391205 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
17:58:45.391430 [info ] [Thread-3  ]: 3 of 6 START table model public.stg_customers .................................. [RUN]
17:58:45.397282 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:58:45.397406 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
17:58:45.397488 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
17:58:45.398278 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:58:45.398505 [debug] [Thread-3  ]: finished collecting timing info
17:58:45.398655 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
17:58:45.412513 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:58:45.412755 [debug] [Thread-2  ]: finished collecting timing info
17:58:45.414126 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
17:58:45.413924 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:58:45.424368 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:58:45.424512 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
17:58:45.425455 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:58:45.425763 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:58:45.427873 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:58:45.428067 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
17:58:45.428349 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:58:45.428909 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:58:45.428994 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:58:45.429047 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
17:58:45.432014 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:58:45.432214 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:58:45.432350 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
)
select * from customers
  );
17:58:45.439940 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:58:45.440214 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:58:45.440290 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:58:45.443809 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:58:45.444031 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:58:45.444153 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
17:58:45.450165 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
17:58:45.453943 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:58:45.454061 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:58:45.454187 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.02 seconds
17:58:45.455444 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:58:45.455532 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
17:58:45.456363 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:58:45.457764 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:58:45.457862 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:58:45.457986 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:58:45.458089 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:58:45.459287 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:58:45.464600 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.02 seconds
17:58:45.467425 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:58:45.466150 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:58:45.467522 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:58:45.467994 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:58:45.468877 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:58:45.468086 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:58:45.468960 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:58:45.470292 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:58:45.470153 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:58:45.465981 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:58:45.470400 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:58:45.470619 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:58:45.470808 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:58:45.471128 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:58:45.471784 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:58:45.471873 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:58:45.471926 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:58:45.472681 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:58:45.476121 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:58:45.476273 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:58:45.476506 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
17:58:45.478302 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:58:45.478426 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:58:45.478520 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
17:58:45.479405 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:58:45.479483 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:58:45.481104 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:58:45.481929 [debug] [Thread-1  ]: finished collecting timing info
17:58:45.482027 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
17:58:45.482120 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
17:58:45.482810 [debug] [Thread-2  ]: finished collecting timing info
17:58:45.483672 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
17:58:45.483507 [debug] [Thread-3  ]: finished collecting timing info
17:58:45.483840 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
17:58:45.485132 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a7c01a0-9ff6-4654-aba3-3bdf06687ef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34c3d23a0>]}
17:58:45.485362 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.10s]
17:58:45.485593 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
17:58:45.482240 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
17:58:45.486203 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a7c01a0-9ff6-4654-aba3-3bdf06687ef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34c3d77f0>]}
17:58:45.486414 [info ] [Thread-3  ]: 3 of 6 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.09s]
17:58:45.486662 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
17:58:45.486921 [debug] [Thread-5  ]: Began running node model.first_project.customers
17:58:45.487111 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a7c01a0-9ff6-4654-aba3-3bdf06687ef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34c3d22b0>]}
17:58:45.487238 [info ] [Thread-5  ]: 4 of 6 START table model public.customers ...................................... [RUN]
17:58:45.487735 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customers"
17:58:45.487484 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.14s]
17:58:45.487813 [debug] [Thread-5  ]: Began compiling node model.first_project.customers
17:58:45.488094 [debug] [Thread-5  ]: Compiling model.first_project.customers
17:58:45.488006 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
17:58:45.487311 [debug] [Thread-6  ]: Began running node model.first_project.customers2
17:58:45.489629 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customers"
17:58:45.489910 [info ] [Thread-6  ]: 5 of 6 START table model public.customers2 ..................................... [RUN]
17:58:45.490130 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
17:58:45.490432 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
17:58:45.490594 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:58:45.490716 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
17:58:45.490958 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:58:45.491092 [debug] [Thread-6  ]: Compiling model.first_project.customers2
17:58:45.491300 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
17:58:45.492885 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
17:58:45.492745 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
17:58:45.493929 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:58:45.494222 [debug] [Thread-8  ]: finished collecting timing info
17:58:45.494468 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
17:58:45.494370 [debug] [Thread-6  ]: finished collecting timing info
17:58:45.495825 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
17:58:45.491167 [debug] [Thread-5  ]: finished collecting timing info
17:58:45.502653 [debug] [Thread-5  ]: Began executing node model.first_project.customers
17:58:45.497168 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
17:58:45.495685 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:58:45.504864 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.customers"
17:58:45.505951 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:58:45.506121 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:58:45.506316 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
17:58:45.506482 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:58:45.506755 [debug] [Thread-5  ]: On model.first_project.customers: BEGIN
17:58:45.506659 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:58:45.506817 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:58:45.506573 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
17:58:45.507292 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:58:45.510595 [debug] [Thread-5  ]: SQL status: BEGIN in 0.0 seconds
17:58:45.510773 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:58:45.510865 [debug] [Thread-6  ]: SQL status: BEGIN in 0.0 seconds
17:58:45.510959 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
17:58:45.511068 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:58:45.511199 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
17:58:45.518030 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
17:58:45.518234 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:58:45.518300 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:58:45.519652 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
17:58:45.519808 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.01 seconds
17:58:45.521420 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:58:45.521567 [debug] [Thread-5  ]: SQL status: SELECT 100 in 0.01 seconds
17:58:45.523152 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:58:45.524818 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
17:58:45.523362 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:58:45.525188 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:58:45.524690 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:58:45.529313 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
17:58:45.529214 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:58:45.529418 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
17:58:45.529643 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:58:45.530399 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
17:58:45.530513 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:58:45.530570 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
17:58:45.530961 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:58:45.532009 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:58:45.532150 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:58:45.532440 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:58:45.533525 [debug] [Thread-5  ]: On model.first_project.customers: COMMIT
17:58:45.533603 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:58:45.533656 [debug] [Thread-5  ]: On model.first_project.customers: COMMIT
17:58:45.533785 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
17:58:45.535609 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:58:45.535689 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
17:58:45.537058 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.01 seconds
17:58:45.541622 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:58:45.541970 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:58:45.542039 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:58:45.542308 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.01 seconds
17:58:45.543261 [debug] [Thread-6  ]: finished collecting timing info
17:58:45.543402 [debug] [Thread-6  ]: On model.first_project.customers2: Close
17:58:45.543752 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a7c01a0-9ff6-4654-aba3-3bdf06687ef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34c411fd0>]}
17:58:45.544008 [info ] [Thread-6  ]: 5 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.05s]
17:58:45.544670 [debug] [Thread-5  ]: SQL status: COMMIT in 0.01 seconds
17:58:45.545569 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:58:45.545650 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:58:45.546360 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
17:58:45.546647 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
17:58:45.547624 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:58:45.547711 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:58:45.547807 [debug] [Thread-5  ]: SQL status: DROP TABLE in 0.0 seconds
17:58:45.548511 [debug] [Thread-5  ]: finished collecting timing info
17:58:45.548608 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:58:45.548712 [debug] [Thread-5  ]: On model.first_project.customers: Close
17:58:45.549346 [debug] [Thread-8  ]: finished collecting timing info
17:58:45.549500 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
17:58:45.549753 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a7c01a0-9ff6-4654-aba3-3bdf06687ef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd350f77ca0>]}
17:58:45.549974 [info ] [Thread-5  ]: 4 of 6 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.06s]
17:58:45.550213 [debug] [Thread-5  ]: Finished running node model.first_project.customers
17:58:45.550863 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a7c01a0-9ff6-4654-aba3-3bdf06687ef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34ee744c0>]}
17:58:45.551066 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
17:58:45.551290 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
17:58:45.552979 [debug] [MainThread]: Acquiring new postgres connection "master"
17:58:45.553083 [debug] [MainThread]: Using postgres connection "master"
17:58:45.553144 [debug] [MainThread]: On master: BEGIN
17:58:45.553199 [debug] [MainThread]: Opening a new connection, currently in state closed
17:58:45.563959 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:58:45.564161 [debug] [MainThread]: On master: COMMIT
17:58:45.564225 [debug] [MainThread]: Using postgres connection "master"
17:58:45.564285 [debug] [MainThread]: On master: COMMIT
17:58:45.564473 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:58:45.564589 [debug] [MainThread]: On master: Close
17:58:45.564918 [info ] [MainThread]: 
17:58:45.565057 [info ] [MainThread]: Finished running 2 view models, 4 table models in 0.29s.
17:58:45.565159 [debug] [MainThread]: Connection 'master' was properly closed.
17:58:45.565208 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:58:45.565252 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:58:45.565297 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:58:45.565341 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:58:45.565385 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
17:58:45.565429 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:58:45.570005 [info ] [MainThread]: 
17:58:45.570267 [info ] [MainThread]: [32mCompleted successfully[0m
17:58:45.570448 [info ] [MainThread]: 
17:58:45.570561 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:58:45.570745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34dc46fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34dc46f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34ecbc460>]}


============================== 2022-06-07 18:01:06.281485 | 979a0e4b-6def-44a7-bd49-14a306b8e0b1 ==============================
18:01:06.281500 [info ] [MainThread]: Running with dbt=1.1.0
18:01:06.281888 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:01:06.281976 [debug] [MainThread]: Tracking: tracking
18:01:06.284337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c14d5daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c14d5de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c14d5db20>]}
18:01:06.311004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:01:06.311450 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/stg_customers.sql
18:01:06.318572 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
18:01:06.331585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '979a0e4b-6def-44a7-bd49-14a306b8e0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c147bd0d0>]}
18:01:06.335501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '979a0e4b-6def-44a7-bd49-14a306b8e0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c14cbde50>]}
18:01:06.335750 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:01:06.335937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '979a0e4b-6def-44a7-bd49-14a306b8e0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c14cbdc70>]}
18:01:06.337013 [info ] [MainThread]: 
18:01:06.337364 [debug] [MainThread]: Acquiring new postgres connection "master"
18:01:06.338352 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:01:06.347946 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:01:06.348246 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:01:06.348354 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:01:06.361633 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:01:06.362769 [debug] [ThreadPool]: On list_erp_oltp: Close
18:01:06.364458 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:01:06.397418 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:01:06.397588 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:01:06.397654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:01:06.401573 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
18:01:06.401731 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:01:06.401813 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:01:06.403265 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:01:06.404249 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:01:06.405482 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:01:06.408462 [debug] [MainThread]: Using postgres connection "master"
18:01:06.408570 [debug] [MainThread]: On master: BEGIN
18:01:06.408651 [debug] [MainThread]: Opening a new connection, currently in state init
18:01:06.412495 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:01:06.412643 [debug] [MainThread]: Using postgres connection "master"
18:01:06.412708 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:01:06.422656 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
18:01:06.423572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '979a0e4b-6def-44a7-bd49-14a306b8e0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c16b3fbb0>]}
18:01:06.423782 [debug] [MainThread]: On master: ROLLBACK
18:01:06.424007 [debug] [MainThread]: Using postgres connection "master"
18:01:06.424087 [debug] [MainThread]: On master: BEGIN
18:01:06.424487 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:01:06.424601 [debug] [MainThread]: On master: COMMIT
18:01:06.424665 [debug] [MainThread]: Using postgres connection "master"
18:01:06.424722 [debug] [MainThread]: On master: COMMIT
18:01:06.425520 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:01:06.425604 [debug] [MainThread]: On master: Close
18:01:06.425890 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:01:06.426096 [info ] [MainThread]: 
18:01:06.429913 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:01:06.430260 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
18:01:06.430583 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:01:06.430675 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:01:06.430758 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:01:06.432415 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:01:06.432580 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:01:06.432735 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:01:06.432925 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
18:01:06.433096 [info ] [Thread-3  ]: 3 of 6 START table model public.stg_customers .................................. [RUN]
18:01:06.433416 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:01:06.433678 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:01:06.433776 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:01:06.433892 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:01:06.434210 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:01:06.434119 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:01:06.434923 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:01:06.436683 [debug] [Thread-3  ]: finished collecting timing info
18:01:06.436783 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:01:06.436333 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:01:06.453019 [debug] [Thread-2  ]: finished collecting timing info
18:01:06.456622 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:01:06.434029 [debug] [Thread-1  ]: finished collecting timing info
18:01:06.487471 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:01:06.491643 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:01:06.491958 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:01:06.493860 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:01:06.494104 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:01:06.494266 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:01:06.494346 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:01:06.494632 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:01:06.495237 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:01:06.495318 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:01:06.495678 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:01:06.495767 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:01:06.495825 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:01:06.499719 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:01:06.499881 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:01:06.499976 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:01:06.501017 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:01:06.506471 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:01:06.506889 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:01:06.507056 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:01:06.507166 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:01:06.507230 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
18:01:06.507547 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:01:06.509947 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:01:06.510081 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:01:06.510237 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
18:01:06.511618 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:01:06.511713 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:01:06.511849 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:01:06.511918 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:01:06.511975 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)
select * from customers
  );
18:01:06.512811 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:01:06.512920 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:01:06.520164 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:01:06.521781 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.01 seconds
18:01:06.523142 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:01:06.521918 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:01:06.523233 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:01:06.521654 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:01:06.523320 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:01:06.523516 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:01:06.523878 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:01:06.525734 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:01:06.525928 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:01:06.526107 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:01:06.526211 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:01:06.529495 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:01:06.530766 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:01:06.531040 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:01:06.531924 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:01:06.532015 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:01:06.532084 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:01:06.530580 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:01:06.532179 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:01:06.532358 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:01:06.533109 [debug] [Thread-1  ]: finished collecting timing info
18:01:06.533222 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:01:06.533301 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
18:01:06.533413 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:01:06.534398 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:01:06.535616 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:01:06.534479 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:01:06.536781 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:01:06.537104 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '979a0e4b-6def-44a7-bd49-14a306b8e0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c147440a0>]}
18:01:06.537356 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:01:06.537714 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
18:01:06.538537 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
18:01:06.539853 [debug] [Thread-3  ]: finished collecting timing info
18:01:06.539063 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:01:06.539966 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:01:06.538844 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:01:06.540372 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
18:01:06.541112 [debug] [Thread-2  ]: finished collecting timing info
18:01:06.542895 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:01:06.542761 [info ] [Thread-5  ]: 4 of 6 START view model public.my_second_dbt_model ............................. [RUN]
18:01:06.542549 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '979a0e4b-6def-44a7-bd49-14a306b8e0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c14792a60>]}
18:01:06.543505 [info ] [Thread-3  ]: 3 of 6 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.11s]
18:01:06.543772 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '979a0e4b-6def-44a7-bd49-14a306b8e0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c1479d190>]}
18:01:06.543922 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.11s]
18:01:06.544161 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:01:06.544337 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:01:06.545488 [debug] [Thread-7  ]: Began running node model.first_project.customers
18:01:06.545626 [info ] [Thread-7  ]: 5 of 6 START table model public.customers ...................................... [RUN]
18:01:06.545864 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers"
18:01:06.545940 [debug] [Thread-7  ]: Began compiling node model.first_project.customers
18:01:06.546007 [debug] [Thread-7  ]: Compiling model.first_project.customers
18:01:06.547504 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers"
18:01:06.547756 [debug] [Thread-7  ]: finished collecting timing info
18:01:06.547894 [debug] [Thread-7  ]: Began executing node model.first_project.customers
18:01:06.543221 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:01:06.550713 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
18:01:06.550839 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
18:01:06.549645 [debug] [Thread-8  ]: Began running node model.first_project.customers2
18:01:06.556633 [info ] [Thread-8  ]: 6 of 6 START table model public.customers2 ..................................... [RUN]
18:01:06.552398 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:01:06.557051 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers2"
18:01:06.558537 [debug] [Thread-8  ]: Began compiling node model.first_project.customers2
18:01:06.558662 [debug] [Thread-8  ]: Compiling model.first_project.customers2
18:01:06.560501 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers2"
18:01:06.549511 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.customers"
18:01:06.561080 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
18:01:06.561213 [debug] [Thread-7  ]: On model.first_project.customers: BEGIN
18:01:06.561360 [debug] [Thread-8  ]: finished collecting timing info
18:01:06.561464 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:01:06.561670 [debug] [Thread-8  ]: Began executing node model.first_project.customers2
18:01:06.562003 [debug] [Thread-5  ]: finished collecting timing info
18:01:06.564049 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers2"
18:01:06.564237 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
18:01:06.577238 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
18:01:06.577444 [debug] [Thread-8  ]: On model.first_project.customers2: BEGIN
18:01:06.577511 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:01:06.578548 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:01:06.580972 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:01:06.581162 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
18:01:06.581323 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:01:06.582622 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
18:01:06.582789 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
18:01:06.582860 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
18:01:06.583843 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:01:06.583971 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
18:01:06.584039 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
18:01:06.585473 [debug] [Thread-8  ]: SQL status: SELECT 100 in 0.0 seconds
18:01:06.587062 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
18:01:06.587158 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:01:06.587504 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:01:06.589468 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
18:01:06.589647 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:01:06.590736 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
18:01:06.590901 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:01:06.590985 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:01:06.591104 [debug] [Thread-7  ]: SQL status: SELECT 100 in 0.01 seconds
18:01:06.592913 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
18:01:06.593045 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
18:01:06.593201 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
18:01:06.593295 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:01:06.594808 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:01:06.596872 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:01:06.596998 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
18:01:06.599113 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
18:01:06.599357 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:01:06.599240 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
18:01:06.596634 [debug] [Thread-8  ]: On model.first_project.customers2: COMMIT
18:01:06.600140 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
18:01:06.600339 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
18:01:06.600627 [debug] [Thread-8  ]: On model.first_project.customers2: COMMIT
18:01:06.600521 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:01:06.600422 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
18:01:06.600892 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
18:01:06.601828 [debug] [Thread-7  ]: On model.first_project.customers: COMMIT
18:01:06.602001 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
18:01:06.602074 [debug] [Thread-7  ]: On model.first_project.customers: COMMIT
18:01:06.602482 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
18:01:06.603407 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
18:01:06.603592 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:01:06.604130 [debug] [Thread-7  ]: SQL status: COMMIT in 0.0 seconds
18:01:06.606620 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
18:01:06.606818 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
18:01:06.606936 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:01:06.607015 [debug] [Thread-8  ]: SQL status: DROP TABLE in 0.0 seconds
18:01:06.607998 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:01:06.609404 [debug] [Thread-8  ]: finished collecting timing info
18:01:06.609531 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:01:06.609686 [debug] [Thread-8  ]: On model.first_project.customers2: Close
18:01:06.610036 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
18:01:06.610130 [debug] [Thread-7  ]: SQL status: DROP TABLE in 0.0 seconds
18:01:06.612476 [debug] [Thread-5  ]: finished collecting timing info
18:01:06.612785 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '979a0e4b-6def-44a7-bd49-14a306b8e0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c146c7460>]}
18:01:06.614219 [info ] [Thread-8  ]: 6 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.06s]
18:01:06.613956 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
18:01:06.613766 [debug] [Thread-7  ]: finished collecting timing info
18:01:06.615662 [debug] [Thread-7  ]: On model.first_project.customers: Close
18:01:06.615501 [debug] [Thread-8  ]: Finished running node model.first_project.customers2
18:01:06.617380 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '979a0e4b-6def-44a7-bd49-14a306b8e0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c14743ac0>]}
18:01:06.617682 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '979a0e4b-6def-44a7-bd49-14a306b8e0b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c1477a8e0>]}
18:01:06.617955 [info ] [Thread-5  ]: 4 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
18:01:06.618205 [info ] [Thread-7  ]: 5 of 6 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.07s]
18:01:06.618629 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
18:01:06.618803 [debug] [Thread-7  ]: Finished running node model.first_project.customers
18:01:06.619987 [debug] [MainThread]: Acquiring new postgres connection "master"
18:01:06.620097 [debug] [MainThread]: Using postgres connection "master"
18:01:06.620160 [debug] [MainThread]: On master: BEGIN
18:01:06.620216 [debug] [MainThread]: Opening a new connection, currently in state closed
18:01:06.623995 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:01:06.624159 [debug] [MainThread]: On master: COMMIT
18:01:06.624224 [debug] [MainThread]: Using postgres connection "master"
18:01:06.624324 [debug] [MainThread]: On master: COMMIT
18:01:06.624543 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:01:06.624664 [debug] [MainThread]: On master: Close
18:01:06.624994 [info ] [MainThread]: 
18:01:06.626836 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0.29s.
18:01:06.627049 [debug] [MainThread]: Connection 'master' was properly closed.
18:01:06.627113 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:01:06.627167 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:01:06.627218 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:01:06.627350 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:01:06.627403 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:01:06.627461 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:01:06.630888 [info ] [MainThread]: 
18:01:06.632440 [info ] [MainThread]: [32mCompleted successfully[0m
18:01:06.632618 [info ] [MainThread]: 
18:01:06.632729 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
18:01:06.632917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c14cbd9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c14d4f3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c14d44f10>]}


============================== 2022-06-07 18:03:40.776530 | 6bb9fa0e-a809-4893-ac12-837a5a249a96 ==============================
18:03:40.776543 [info ] [MainThread]: Running with dbt=1.1.0
18:03:40.776970 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:03:40.777061 [debug] [MainThread]: Tracking: tracking
18:03:40.779258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05afb601f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05afb60e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05afb60af0>]}
18:03:40.797306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:03:40.797662 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:03:40.807339 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:03:40.834020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bb9fa0e-a809-4893-ac12-837a5a249a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05af5be2e0>]}
18:03:40.860366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bb9fa0e-a809-4893-ac12-837a5a249a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05b1d25b50>]}
18:03:40.860589 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:03:40.860720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bb9fa0e-a809-4893-ac12-837a5a249a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05b1d259a0>]}
18:03:40.861681 [info ] [MainThread]: 
18:03:40.862046 [debug] [MainThread]: Acquiring new postgres connection "master"
18:03:40.862772 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:03:40.869181 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:03:40.869289 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:03:40.869350 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:03:40.874293 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
18:03:40.875154 [debug] [ThreadPool]: On list_erp_oltp: Close
18:03:40.876368 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:03:40.879774 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:03:40.879889 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:03:40.879957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:03:40.901427 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:03:40.901676 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:03:40.901780 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:03:40.903425 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:03:40.904465 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:03:40.904650 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:03:40.907713 [debug] [MainThread]: Using postgres connection "master"
18:03:40.907839 [debug] [MainThread]: On master: BEGIN
18:03:40.907895 [debug] [MainThread]: Opening a new connection, currently in state init
18:03:40.914017 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:03:40.914213 [debug] [MainThread]: Using postgres connection "master"
18:03:40.914274 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:03:40.922825 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
18:03:40.923810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bb9fa0e-a809-4893-ac12-837a5a249a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05b1cc8eb0>]}
18:03:40.924030 [debug] [MainThread]: On master: ROLLBACK
18:03:40.924181 [debug] [MainThread]: Using postgres connection "master"
18:03:40.924270 [debug] [MainThread]: On master: BEGIN
18:03:40.924429 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:03:40.924505 [debug] [MainThread]: On master: COMMIT
18:03:40.924663 [debug] [MainThread]: Using postgres connection "master"
18:03:40.924719 [debug] [MainThread]: On master: COMMIT
18:03:40.924831 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:03:40.924932 [debug] [MainThread]: On master: Close
18:03:40.925195 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:03:40.925346 [info ] [MainThread]: 
18:03:40.932464 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:03:40.932726 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
18:03:40.933026 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:03:40.933118 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:03:40.933188 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:03:40.942115 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:03:40.942411 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
18:03:40.942731 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:03:40.943030 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:03:40.943180 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:03:40.945663 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:03:40.946233 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:03:40.947209 [info ] [Thread-3  ]: 3 of 6 START table model public.stg_customers .................................. [RUN]
18:03:40.947571 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:03:40.947743 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:03:40.947823 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:03:40.948637 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:03:40.948929 [debug] [Thread-3  ]: finished collecting timing info
18:03:40.949060 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:03:40.949143 [debug] [Thread-2  ]: finished collecting timing info
18:03:40.955885 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:03:40.936951 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:03:40.967159 [debug] [Thread-1  ]: finished collecting timing info
18:03:40.967373 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:03:40.995543 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:03:41.001587 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:03:41.002035 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:03:41.002368 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:03:41.002575 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:03:41.002783 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:03:41.002963 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:03:41.003097 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:03:41.003365 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:03:41.003420 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:03:41.003183 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:03:41.003724 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:03:41.008279 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
18:03:41.008472 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:03:41.008532 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)
select * from customers
  );
18:03:41.009183 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:03:41.009301 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:03:41.009472 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:03:41.009607 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:03:41.009729 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:03:41.009789 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
18:03:41.010386 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.0 seconds
18:03:41.016391 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:03:41.016569 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
18:03:41.016677 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
18:03:41.018186 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:03:41.019603 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:03:41.019455 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:03:41.016786 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:03:41.019724 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:03:41.020145 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:03:41.021253 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:03:41.021380 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:03:41.021518 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:03:41.021620 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:03:41.022688 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:03:41.023898 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:03:41.024037 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:03:41.024114 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:03:41.024216 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:03:41.031337 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:03:41.031570 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:03:41.031653 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:03:41.031835 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:03:41.032562 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:03:41.032642 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:03:41.032698 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:03:41.033253 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:03:41.034044 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:03:41.034120 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:03:41.034172 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:03:41.034366 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:03:41.038037 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:03:41.038133 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:03:41.038235 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
18:03:41.039031 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:03:41.039110 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:03:41.039201 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
18:03:41.039943 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:03:41.040013 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:03:41.041381 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
18:03:41.042798 [debug] [Thread-3  ]: finished collecting timing info
18:03:41.042907 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:03:41.043192 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bb9fa0e-a809-4893-ac12-837a5a249a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05ac4935e0>]}
18:03:41.043414 [info ] [Thread-3  ]: 3 of 6 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.10s]
18:03:41.043620 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:03:41.044147 [debug] [Thread-2  ]: finished collecting timing info
18:03:41.044231 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:03:41.044501 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bb9fa0e-a809-4893-ac12-837a5a249a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05ac48eca0>]}
18:03:41.044684 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.10s]
18:03:41.044912 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:03:41.045064 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:03:41.045504 [debug] [Thread-5  ]: Began running node model.first_project.customers
18:03:41.045646 [info ] [Thread-5  ]: 4 of 6 START table model public.customers ...................................... [RUN]
18:03:41.045866 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customers"
18:03:41.045938 [debug] [Thread-5  ]: Began compiling node model.first_project.customers
18:03:41.046002 [debug] [Thread-5  ]: Compiling model.first_project.customers
18:03:41.047418 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customers"
18:03:41.047621 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
18:03:41.048541 [debug] [Thread-1  ]: finished collecting timing info
18:03:41.048670 [debug] [Thread-6  ]: Began running node model.first_project.customers2
18:03:41.048973 [debug] [Thread-5  ]: finished collecting timing info
18:03:41.049319 [debug] [Thread-5  ]: Began executing node model.first_project.customers
18:03:41.049183 [info ] [Thread-6  ]: 5 of 6 START table model public.customers2 ..................................... [RUN]
18:03:41.050897 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.customers"
18:03:41.051576 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
18:03:41.051298 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
18:03:41.051816 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
18:03:41.051691 [debug] [Thread-5  ]: On model.first_project.customers: BEGIN
18:03:41.051914 [debug] [Thread-6  ]: Compiling model.first_project.customers2
18:03:41.048889 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:03:41.053877 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bb9fa0e-a809-4893-ac12-837a5a249a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05b1cbb1c0>]}
18:03:41.053524 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
18:03:41.054334 [debug] [Thread-6  ]: finished collecting timing info
18:03:41.054452 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
18:03:41.055770 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
18:03:41.052004 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:03:41.056221 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:03:41.056776 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
18:03:41.056841 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:03:41.054098 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.12s]
18:03:41.057374 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:03:41.060615 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
18:03:41.068770 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
18:03:41.075606 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:03:41.075744 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
18:03:41.075821 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
18:03:41.077406 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:03:41.077654 [debug] [Thread-8  ]: finished collecting timing info
18:03:41.077736 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
18:03:41.079069 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:03:41.079269 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:03:41.079360 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
18:03:41.079413 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:03:41.080266 [debug] [Thread-5  ]: SQL status: BEGIN in 0.03 seconds
18:03:41.080402 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
18:03:41.080454 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
 customers.state
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
18:03:41.082064 [debug] [Thread-5  ]: SQL status: SELECT 100 in 0.0 seconds
18:03:41.083483 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
18:03:41.083566 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
18:03:41.083914 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
18:03:41.083996 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:03:41.084049 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
18:03:41.085382 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
18:03:41.086781 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:03:41.086901 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:03:41.087167 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:03:41.088377 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:03:41.088462 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:03:41.091926 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
18:03:41.092161 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:03:41.092228 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:03:41.093345 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
18:03:41.104600 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.02 seconds
18:03:41.105864 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:03:41.105966 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:03:41.106020 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:03:41.106794 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.02 seconds
18:03:41.108132 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
18:03:41.108211 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:03:41.109599 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:03:41.109678 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:03:41.109775 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
18:03:41.110511 [debug] [Thread-5  ]: On model.first_project.customers: COMMIT
18:03:41.110629 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
18:03:41.110691 [debug] [Thread-5  ]: On model.first_project.customers: COMMIT
18:03:41.115864 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
18:03:41.117168 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:03:41.117290 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:03:41.117991 [debug] [Thread-5  ]: SQL status: COMMIT in 0.01 seconds
18:03:41.123226 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
18:03:41.123387 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.01 seconds
18:03:41.124393 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:03:41.124481 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:03:41.124533 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:03:41.123449 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.01 seconds
18:03:41.125193 [debug] [Thread-6  ]: finished collecting timing info
18:03:41.125293 [debug] [Thread-6  ]: On model.first_project.customers2: Close
18:03:41.125583 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bb9fa0e-a809-4893-ac12-837a5a249a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05af59e820>]}
18:03:41.125795 [info ] [Thread-6  ]: 5 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.07s]
18:03:41.127390 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
18:03:41.123544 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:03:41.129189 [debug] [Thread-5  ]: SQL status: DROP TABLE in 0.0 seconds
18:03:41.129524 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
18:03:41.132293 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:03:41.132433 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:03:41.132670 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
18:03:41.133271 [debug] [Thread-8  ]: finished collecting timing info
18:03:41.133366 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
18:03:41.130410 [debug] [Thread-5  ]: finished collecting timing info
18:03:41.135595 [debug] [Thread-5  ]: On model.first_project.customers: Close
18:03:41.135987 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bb9fa0e-a809-4893-ac12-837a5a249a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05ac46d100>]}
18:03:41.136230 [info ] [Thread-5  ]: 4 of 6 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.09s]
18:03:41.136532 [debug] [Thread-5  ]: Finished running node model.first_project.customers
18:03:41.141591 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bb9fa0e-a809-4893-ac12-837a5a249a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05b13524c0>]}
18:03:41.141921 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
18:03:41.142168 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
18:03:41.143559 [debug] [MainThread]: Acquiring new postgres connection "master"
18:03:41.143704 [debug] [MainThread]: Using postgres connection "master"
18:03:41.143773 [debug] [MainThread]: On master: BEGIN
18:03:41.143843 [debug] [MainThread]: Opening a new connection, currently in state closed
18:03:41.152538 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:03:41.152736 [debug] [MainThread]: On master: COMMIT
18:03:41.152803 [debug] [MainThread]: Using postgres connection "master"
18:03:41.152858 [debug] [MainThread]: On master: COMMIT
18:03:41.153181 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:03:41.153377 [debug] [MainThread]: On master: Close
18:03:41.153938 [info ] [MainThread]: 
18:03:41.154099 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0.29s.
18:03:41.154215 [debug] [MainThread]: Connection 'master' was properly closed.
18:03:41.154266 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:03:41.154348 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:03:41.154394 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:03:41.154438 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:03:41.154483 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:03:41.154527 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:03:41.157918 [info ] [MainThread]: 
18:03:41.158089 [info ] [MainThread]: [32mCompleted successfully[0m
18:03:41.158346 [info ] [MainThread]: 
18:03:41.158464 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
18:03:41.158626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05b137a370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05b137a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05afa22160>]}


============================== 2022-06-07 18:08:30.697858 | 99431fed-3764-4232-a18d-a866aa41b9aa ==============================
18:08:30.697871 [info ] [MainThread]: Running with dbt=1.1.0
18:08:30.698435 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:08:30.698526 [debug] [MainThread]: Tracking: tracking
18:08:30.701254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82aba65190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82aba65e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82aba65b20>]}
18:08:30.718324 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:08:30.718776 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
18:08:30.726355 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:08:30.788038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99431fed-3764-4232-a18d-a866aa41b9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ad8b0700>]}
18:08:30.791123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99431fed-3764-4232-a18d-a866aa41b9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ab9c5fa0>]}
18:08:30.791344 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:08:30.791482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99431fed-3764-4232-a18d-a866aa41b9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ab9c5e50>]}
18:08:30.792342 [info ] [MainThread]: 
18:08:30.792644 [debug] [MainThread]: Acquiring new postgres connection "master"
18:08:30.793281 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:08:30.799927 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:08:30.800097 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:08:30.800168 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:08:30.806384 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:08:30.807264 [debug] [ThreadPool]: On list_erp_oltp: Close
18:08:30.808320 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:08:30.811759 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:08:30.811853 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:08:30.811910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:08:30.816475 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
18:08:30.816620 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:08:30.816678 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:08:30.818113 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:08:30.819088 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:08:30.819272 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:08:30.829232 [debug] [MainThread]: Using postgres connection "master"
18:08:30.829472 [debug] [MainThread]: On master: BEGIN
18:08:30.829539 [debug] [MainThread]: Opening a new connection, currently in state init
18:08:30.843793 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:08:30.844063 [debug] [MainThread]: Using postgres connection "master"
18:08:30.844135 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:08:30.855262 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
18:08:30.856234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99431fed-3764-4232-a18d-a866aa41b9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ab9c5b80>]}
18:08:30.856459 [debug] [MainThread]: On master: ROLLBACK
18:08:30.856646 [debug] [MainThread]: Using postgres connection "master"
18:08:30.856720 [debug] [MainThread]: On master: BEGIN
18:08:30.856881 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:08:30.856957 [debug] [MainThread]: On master: COMMIT
18:08:30.857013 [debug] [MainThread]: Using postgres connection "master"
18:08:30.857114 [debug] [MainThread]: On master: COMMIT
18:08:30.857226 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:08:30.857298 [debug] [MainThread]: On master: Close
18:08:30.857560 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:08:30.857744 [info ] [MainThread]: 
18:08:30.861624 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:08:30.861820 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
18:08:30.862079 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:08:30.862159 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:08:30.862230 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:08:30.863815 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:08:30.864231 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:08:30.864508 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
18:08:30.864858 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:08:30.864965 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:08:30.865053 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:08:30.867357 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:08:30.867993 [debug] [Thread-2  ]: finished collecting timing info
18:08:30.868137 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:08:30.864336 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:08:30.873825 [info ] [Thread-3  ]: 3 of 6 START table model public.stg_customers .................................. [RUN]
18:08:30.874141 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:08:30.874231 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:08:30.874305 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:08:30.874428 [debug] [Thread-1  ]: finished collecting timing info
18:08:30.875087 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:08:30.897442 [debug] [Thread-3  ]: finished collecting timing info
18:08:30.897556 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:08:30.896960 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:08:30.896640 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:08:30.917295 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:08:30.918205 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:08:30.918508 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:08:30.918842 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:08:30.918977 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:08:30.919067 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:08:30.919157 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:08:30.919656 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:08:30.919728 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:08:30.919240 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:08:30.920204 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:08:30.923398 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
18:08:30.923537 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:08:30.923599 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)
select * from customers
  );
18:08:30.925579 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:08:30.925766 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:08:30.925893 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:08:30.926033 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.0 seconds
18:08:30.930136 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:08:30.930307 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:08:30.930530 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:08:30.931985 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:08:30.932138 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:08:30.932347 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:08:30.932460 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:08:30.932591 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
18:08:30.932816 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:08:30.932915 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:08:30.934306 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:08:30.936769 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:08:30.936914 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
18:08:30.937003 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:08:30.938273 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:08:30.938447 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:08:30.937113 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:08:30.938610 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:08:30.943850 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
18:08:30.947308 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:08:30.947404 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
18:08:30.948250 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:08:30.949688 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:08:30.950028 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:08:30.949904 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:08:30.948379 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:08:30.950153 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:08:30.950540 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:08:30.951395 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:08:30.951486 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:08:30.951539 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:08:30.950621 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:08:30.952377 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:08:30.952483 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:08:30.956441 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:08:30.957879 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:08:30.958182 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:08:30.958080 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:08:30.957981 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
18:08:30.960317 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:08:30.960433 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:08:30.960524 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:08:30.960594 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:08:30.961309 [debug] [Thread-2  ]: finished collecting timing info
18:08:30.961985 [debug] [Thread-1  ]: finished collecting timing info
18:08:30.962305 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:08:30.962386 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
18:08:30.965211 [debug] [Thread-3  ]: finished collecting timing info
18:08:30.965378 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:08:30.965831 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99431fed-3764-4232-a18d-a866aa41b9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ab9f0d30>]}
18:08:30.966193 [info ] [Thread-3  ]: 3 of 6 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.09s]
18:08:30.962494 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:08:30.966767 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99431fed-3764-4232-a18d-a866aa41b9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82aba4c9d0>]}
18:08:30.967008 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.10s]
18:08:30.967405 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:08:30.968452 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99431fed-3764-4232-a18d-a866aa41b9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a841fac0>]}
18:08:30.968708 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:08:30.968824 [debug] [Thread-5  ]: Began running node model.first_project.customers
18:08:30.969449 [info ] [Thread-5  ]: 4 of 6 START table model public.customers ...................................... [RUN]
18:08:30.969663 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customers"
18:08:30.969733 [debug] [Thread-5  ]: Began compiling node model.first_project.customers
18:08:30.969794 [debug] [Thread-5  ]: Compiling model.first_project.customers
18:08:30.971225 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customers"
18:08:30.971455 [debug] [Thread-5  ]: finished collecting timing info
18:08:30.971591 [debug] [Thread-5  ]: Began executing node model.first_project.customers
18:08:30.973036 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.customers"
18:08:30.973312 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
18:08:30.973390 [debug] [Thread-5  ]: On model.first_project.customers: BEGIN
18:08:30.973442 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:08:30.968906 [debug] [Thread-6  ]: Began running node model.first_project.customers2
18:08:30.973856 [info ] [Thread-6  ]: 5 of 6 START table model public.customers2 ..................................... [RUN]
18:08:30.974088 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
18:08:30.974164 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
18:08:30.974225 [debug] [Thread-6  ]: Compiling model.first_project.customers2
18:08:30.975694 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
18:08:30.975883 [debug] [Thread-6  ]: finished collecting timing info
18:08:30.976013 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
18:08:30.969340 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
18:08:30.977811 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
18:08:30.978045 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:08:30.978114 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
18:08:30.978171 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
18:08:30.969091 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.10s]
18:08:30.979344 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:08:30.979934 [debug] [Thread-8  ]: finished collecting timing info
18:08:30.980035 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
18:08:30.977662 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
18:08:30.981407 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:08:30.981892 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:08:30.982003 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
18:08:30.982084 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:08:30.982291 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:08:30.982379 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
18:08:30.982433 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:08:30.983077 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:08:30.989413 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
18:08:30.989665 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
18:08:30.989737 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
 customers.state
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
18:08:30.992143 [debug] [Thread-5  ]: SQL status: SELECT 100 in 0.0 seconds
18:08:30.994012 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
18:08:30.994132 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
18:08:30.994384 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
18:08:30.994523 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:08:30.994584 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:08:30.995630 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
18:08:30.997188 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:08:30.997304 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:08:30.997552 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
18:08:31.005027 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
18:08:31.005199 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:08:31.005553 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.01 seconds
18:08:31.006510 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:08:31.006608 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:08:31.006661 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:08:31.006743 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
18:08:31.006883 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:08:31.008431 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:08:31.008504 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
18:08:31.008270 [debug] [Thread-5  ]: On model.first_project.customers: COMMIT
18:08:31.008624 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
18:08:31.008706 [debug] [Thread-5  ]: On model.first_project.customers: COMMIT
18:08:31.009225 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
18:08:31.013396 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
18:08:31.016749 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:08:31.017082 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:08:31.016946 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
18:08:31.014617 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
18:08:31.018246 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:08:31.018108 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:08:31.018630 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:08:31.018848 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
18:08:31.020399 [debug] [Thread-8  ]: finished collecting timing info
18:08:31.020516 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:08:31.021797 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:08:31.020676 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
18:08:31.021890 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:08:31.020591 [debug] [Thread-5  ]: SQL status: DROP TABLE in 0.0 seconds
18:08:31.022520 [debug] [Thread-5  ]: finished collecting timing info
18:08:31.022601 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:08:31.022678 [debug] [Thread-5  ]: On model.first_project.customers: Close
18:08:31.023655 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99431fed-3764-4232-a18d-a866aa41b9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a83676a0>]}
18:08:31.025974 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
18:08:31.026226 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
18:08:31.025754 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99431fed-3764-4232-a18d-a866aa41b9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a842abb0>]}
18:08:31.026483 [info ] [Thread-5  ]: 4 of 6 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.06s]
18:08:31.024522 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:08:31.026668 [debug] [Thread-5  ]: Finished running node model.first_project.customers
18:08:31.026766 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:08:31.026963 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:08:31.027627 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
18:08:31.028636 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:08:31.028718 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:08:31.029783 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
18:08:31.030397 [debug] [Thread-6  ]: finished collecting timing info
18:08:31.030491 [debug] [Thread-6  ]: On model.first_project.customers2: Close
18:08:31.030743 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99431fed-3764-4232-a18d-a866aa41b9aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a83dda90>]}
18:08:31.030949 [info ] [Thread-6  ]: 5 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.06s]
18:08:31.031211 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
18:08:31.033326 [debug] [MainThread]: Acquiring new postgres connection "master"
18:08:31.039660 [debug] [MainThread]: Using postgres connection "master"
18:08:31.039809 [debug] [MainThread]: On master: BEGIN
18:08:31.039879 [debug] [MainThread]: Opening a new connection, currently in state closed
18:08:31.043614 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:08:31.043762 [debug] [MainThread]: On master: COMMIT
18:08:31.043825 [debug] [MainThread]: Using postgres connection "master"
18:08:31.043882 [debug] [MainThread]: On master: COMMIT
18:08:31.052431 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
18:08:31.052670 [debug] [MainThread]: On master: Close
18:08:31.053115 [info ] [MainThread]: 
18:08:31.056583 [info ] [MainThread]: Finished running 4 table models, 2 view models in 0.26s.
18:08:31.057343 [debug] [MainThread]: Connection 'master' was properly closed.
18:08:31.057435 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:08:31.057489 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:08:31.057540 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:08:31.057587 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:08:31.060445 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:08:31.060534 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:08:31.063674 [info ] [MainThread]: 
18:08:31.063937 [info ] [MainThread]: [32mCompleted successfully[0m
18:08:31.064104 [info ] [MainThread]: 
18:08:31.064405 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
18:08:31.064642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ad85e6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ad279a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ab4de670>]}


============================== 2022-06-07 18:08:58.095320 | 983539e5-d00a-4a50-822a-e34bbc790de4 ==============================
18:08:58.095333 [info ] [MainThread]: Running with dbt=1.1.0
18:08:58.095945 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:08:58.096023 [debug] [MainThread]: Tracking: tracking
18:08:58.098476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ca9a0970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ca9a0dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ca9a0460>]}
18:08:58.117981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:08:58.118191 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:08:58.122155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '983539e5-d00a-4a50-822a-e34bbc790de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ca8570d0>]}
18:08:58.133028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '983539e5-d00a-4a50-822a-e34bbc790de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ca8a9220>]}
18:08:58.133599 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:08:58.133796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '983539e5-d00a-4a50-822a-e34bbc790de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ca8a9130>]}
18:08:58.135250 [info ] [MainThread]: 
18:08:58.135704 [debug] [MainThread]: Acquiring new postgres connection "master"
18:08:58.136593 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:08:58.142252 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:08:58.142375 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:08:58.142440 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:08:58.148737 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:08:58.148914 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:08:58.148980 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:08:58.150416 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:08:58.151418 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:08:58.151716 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:08:58.154629 [debug] [MainThread]: Using postgres connection "master"
18:08:58.154772 [debug] [MainThread]: On master: BEGIN
18:08:58.154832 [debug] [MainThread]: Opening a new connection, currently in state init
18:08:58.160527 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:08:58.160689 [debug] [MainThread]: Using postgres connection "master"
18:08:58.160751 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:08:58.169357 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
18:08:58.170330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '983539e5-d00a-4a50-822a-e34bbc790de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ca99eb80>]}
18:08:58.170545 [debug] [MainThread]: On master: ROLLBACK
18:08:58.170964 [debug] [MainThread]: Using postgres connection "master"
18:08:58.171090 [debug] [MainThread]: On master: BEGIN
18:08:58.171277 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:08:58.171355 [debug] [MainThread]: On master: COMMIT
18:08:58.171413 [debug] [MainThread]: Using postgres connection "master"
18:08:58.171467 [debug] [MainThread]: On master: COMMIT
18:08:58.171565 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:08:58.171640 [debug] [MainThread]: On master: Close
18:08:58.172186 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:08:58.172348 [info ] [MainThread]: 
18:08:58.182720 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__MG__RJ__BA__SP__AL__MA__RO.b159de29bc
18:08:58.182913 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_customers_state__PR__SC__RS__MG__RJ__BA__SP__AL__MA__RO  [RUN]
18:08:58.183252 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__MG__RJ__BA__SP__AL__MA__RO.b159de29bc"
18:08:58.183366 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__MG__RJ__BA__SP__AL__MA__RO.b159de29bc
18:08:58.183440 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__MG__RJ__BA__SP__AL__MA__RO.b159de29bc
18:08:58.189645 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:58.189807 [info ] [Thread-2  ]: 2 of 7 START test not_null_customers_customer_id ............................... [RUN]
18:08:58.189911 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:58.190031 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:58.204814 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:08:58.190168 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:58.205236 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:08:58.196923 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:58.197084 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:08:58.190111 [debug] [Thread-5  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:58.206194 [info ] [Thread-5  ]: 5 of 7 START test unique_customers_customer_id ................................. [RUN]
18:08:58.206406 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:58.206475 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:58.206557 [debug] [Thread-5  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:58.190223 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:58.206031 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:58.244622 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:58.244753 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:58.205711 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:58.250385 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:58.204620 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__MG__RJ__BA__SP__AL__MA__RO.b159de29bc"
18:08:58.244315 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:58.205058 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:58.205490 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:58.250091 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:58.241433 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:08:58.252266 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:58.252671 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:58.252815 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:58.253924 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:58.255824 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:58.253796 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:58.253651 [debug] [Thread-2  ]: finished collecting timing info
18:08:58.258564 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:58.256007 [debug] [Thread-6  ]: finished collecting timing info
18:08:58.252913 [debug] [Thread-1  ]: finished collecting timing info
18:08:58.258163 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:58.273244 [debug] [Thread-4  ]: finished collecting timing info
18:08:58.273409 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:58.253389 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:58.275503 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:58.272063 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:58.272854 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__MG__RJ__BA__SP__AL__MA__RO.b159de29bc
18:08:58.275583 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:58.279257 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:58.272585 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:58.281020 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:58.281372 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:58.276649 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__MG__RJ__BA__SP__AL__MA__RO.b159de29bc"
18:08:58.281724 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__MG__RJ__BA__SP__AL__MA__RO.b159de29bc"
18:08:58.281786 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__MG__RJ__BA__SP__AL__MA__RO.b159de29bc: BEGIN
18:08:58.281843 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:08:58.274603 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:58.281530 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:08:58.283018 [debug] [Thread-7  ]: finished collecting timing info
18:08:58.283700 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:58.284798 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:58.283195 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:58.284948 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:08:58.285023 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:08:58.285602 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:58.285719 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:08:58.285771 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:08:58.283329 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:08:58.258336 [debug] [Thread-3  ]: finished collecting timing info
18:08:58.286063 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:58.283490 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:58.287293 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
18:08:58.258397 [debug] [Thread-5  ]: finished collecting timing info
18:08:58.287551 [debug] [Thread-5  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:58.287387 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:08:58.289051 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:58.289574 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:58.289706 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: BEGIN
18:08:58.289760 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:08:58.287177 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:58.290172 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:58.290293 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:08:58.289952 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:08:58.290434 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__MG__RJ__BA__SP__AL__MA__RO.b159de29bc"
18:08:58.290350 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:08:58.290516 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__MG__RJ__BA__SP__AL__MA__RO.b159de29bc: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_customers_state__PR__SC__RS__MG__RJ__BA__SP__AL__MA__RO.b159de29bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."customers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','MG','RJ','BA','SP','AL','MA','RO'
)



      
    ) dbt_internal_test
18:08:58.297122 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
18:08:58.298629 [debug] [Thread-1  ]: finished collecting timing info
18:08:58.298783 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__MG__RJ__BA__SP__AL__MA__RO.b159de29bc: ROLLBACK
18:08:58.299665 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__MG__RJ__BA__SP__AL__MA__RO.b159de29bc: Close
18:08:58.300036 [error] [Thread-1  ]: 1 of 7 FAIL 4 accepted_values_customers_state__PR__SC__RS__MG__RJ__BA__SP__AL__MA__RO  [[31mFAIL 4[0m in 0.12s]
18:08:58.300734 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__MG__RJ__BA__SP__AL__MA__RO.b159de29bc
18:08:58.303492 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:08:58.303692 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:58.303763 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:08:58.304010 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:08:58.304122 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:58.304183 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:08:58.304281 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:08:58.304425 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:58.304487 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:08:58.304826 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:58.305742 [debug] [Thread-6  ]: finished collecting timing info
18:08:58.305914 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:08:58.306024 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:58.306755 [debug] [Thread-4  ]: finished collecting timing info
18:08:58.306879 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:58.306991 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:08:58.307907 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:08:58.307748 [debug] [Thread-7  ]: finished collecting timing info
18:08:58.308038 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:08:58.308289 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.10s]
18:08:58.308545 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:58.308717 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:08:58.308820 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:08:58.309093 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
18:08:58.309321 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:58.309602 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.10s]
18:08:58.309807 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:58.315389 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
18:08:58.315608 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:58.315684 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
18:08:58.316712 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:58.317729 [debug] [Thread-2  ]: finished collecting timing info
18:08:58.317855 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
18:08:58.318055 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
18:08:58.318416 [info ] [Thread-2  ]: 2 of 7 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.12s]
18:08:58.318732 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:58.319054 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
18:08:58.319152 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:58.319213 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:08:58.319406 [debug] [Thread-5  ]: SQL status: BEGIN in 0.03 seconds
18:08:58.319476 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:58.319553 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:08:58.320157 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:58.321004 [debug] [Thread-5  ]: finished collecting timing info
18:08:58.321119 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
18:08:58.321209 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:58.321936 [debug] [Thread-3  ]: finished collecting timing info
18:08:58.322025 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:08:58.322151 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:08:58.322399 [error] [Thread-3  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.12s]
18:08:58.322677 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:58.330017 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: Close
18:08:58.330659 [error] [Thread-5  ]: 5 of 7 FAIL 50 unique_customers_customer_id .................................... [[31mFAIL 50[0m in 0.12s]
18:08:58.331258 [debug] [Thread-5  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:58.333152 [debug] [MainThread]: Acquiring new postgres connection "master"
18:08:58.333323 [debug] [MainThread]: Using postgres connection "master"
18:08:58.333388 [debug] [MainThread]: On master: BEGIN
18:08:58.333443 [debug] [MainThread]: Opening a new connection, currently in state closed
18:08:58.338021 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:08:58.338178 [debug] [MainThread]: On master: COMMIT
18:08:58.338241 [debug] [MainThread]: Using postgres connection "master"
18:08:58.338299 [debug] [MainThread]: On master: COMMIT
18:08:58.338413 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:08:58.338494 [debug] [MainThread]: On master: Close
18:08:58.338756 [info ] [MainThread]: 
18:08:58.338889 [info ] [MainThread]: Finished running 7 tests in 0.20s.
18:08:58.339006 [debug] [MainThread]: Connection 'master' was properly closed.
18:08:58.339076 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__MG__RJ__BA__SP__AL__MA__RO.b159de29bc' was properly closed.
18:08:58.339125 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
18:08:58.339171 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:08:58.339215 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:08:58.339261 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:08:58.339306 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
18:08:58.339351 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:08:58.342385 [info ] [MainThread]: 
18:08:58.342589 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
18:08:58.342713 [info ] [MainThread]: 
18:08:58.342802 [error] [MainThread]: [31mFailure in test accepted_values_customers_state__PR__SC__RS__MG__RJ__BA__SP__AL__MA__RO (models/erp/schema.yml)[0m
18:08:58.342941 [error] [MainThread]:   Got 4 results, configured to fail if != 0
18:08:58.343039 [info ] [MainThread]: 
18:08:58.343133 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/accepted_values_customers_d1b1fc546b6cab45f4966f6ebfd05c61.sql
18:08:58.343232 [info ] [MainThread]: 
18:08:58.343318 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:08:58.343408 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:08:58.343490 [info ] [MainThread]: 
18:08:58.343571 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:08:58.343656 [info ] [MainThread]: 
18:08:58.343776 [error] [MainThread]: [31mFailure in test unique_customers_customer_id (models/erp/schema.yml)[0m
18:08:58.343877 [error] [MainThread]:   Got 50 results, configured to fail if != 0
18:08:58.343957 [info ] [MainThread]: 
18:08:58.344037 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_customers_customer_id.sql
18:08:58.344137 [info ] [MainThread]: 
18:08:58.345953 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
18:08:58.346197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ca7e6f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6c870adc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6c8743610>]}


============================== 2022-06-07 18:18:43.241598 | 5b5a0c7d-23e4-4ee2-a55e-42e1779a0ce1 ==============================
18:18:43.241611 [info ] [MainThread]: Running with dbt=1.1.0
18:18:43.242515 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:18:43.242622 [debug] [MainThread]: Tracking: tracking
18:18:43.245412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7db187c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7db18df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7db18490>]}
18:18:43.264636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:18:43.265050 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
18:18:43.275692 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:18:43.341512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b5a0c7d-23e4-4ee2-a55e-42e1779a0ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7f968760>]}
18:18:43.344830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b5a0c7d-23e4-4ee2-a55e-42e1779a0ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca825b7f10>]}
18:18:43.345069 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:18:43.345281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b5a0c7d-23e4-4ee2-a55e-42e1779a0ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7da26eb0>]}
18:18:43.346296 [info ] [MainThread]: 
18:18:43.346597 [debug] [MainThread]: Acquiring new postgres connection "master"
18:18:43.347414 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:18:43.353551 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:18:43.353752 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:18:43.353819 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:18:43.359682 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:18:43.359845 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:18:43.359905 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:18:43.361247 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:18:43.362355 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:18:43.362553 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:18:43.366642 [debug] [MainThread]: Using postgres connection "master"
18:18:43.366759 [debug] [MainThread]: On master: BEGIN
18:18:43.366815 [debug] [MainThread]: Opening a new connection, currently in state init
18:18:43.383327 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:18:43.383557 [debug] [MainThread]: Using postgres connection "master"
18:18:43.383629 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:18:43.394075 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
18:18:43.395254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b5a0c7d-23e4-4ee2-a55e-42e1779a0ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7da26c70>]}
18:18:43.395470 [debug] [MainThread]: On master: ROLLBACK
18:18:43.395722 [debug] [MainThread]: Using postgres connection "master"
18:18:43.395817 [debug] [MainThread]: On master: BEGIN
18:18:43.396235 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:18:43.396352 [debug] [MainThread]: On master: COMMIT
18:18:43.396421 [debug] [MainThread]: Using postgres connection "master"
18:18:43.396479 [debug] [MainThread]: On master: COMMIT
18:18:43.396658 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:18:43.396737 [debug] [MainThread]: On master: Close
18:18:43.397111 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:18:43.397319 [info ] [MainThread]: 
18:18:43.401216 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
18:18:43.401351 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF  [RUN]
18:18:43.401675 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a"
18:18:43.402780 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
18:18:43.402863 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
18:18:43.412058 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:18:43.412280 [info ] [Thread-2  ]: 2 of 7 START test not_null_customers_customer_id ............................... [RUN]
18:18:43.412775 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:18:43.412897 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:18:43.413012 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:18:43.413189 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:18:43.419678 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:18:43.413270 [debug] [Thread-5  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:18:43.413396 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:18:43.420224 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:18:43.413472 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
18:18:43.419489 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:18:43.427304 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:18:43.419999 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:18:43.420112 [info ] [Thread-5  ]: 5 of 7 START test unique_customers_customer_id ................................. [RUN]
18:18:43.420574 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:18:43.428060 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:18:43.428154 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:18:43.427409 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:18:43.432280 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:18:43.427561 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:18:43.434347 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:18:43.427862 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:18:43.436380 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:18:43.436463 [debug] [Thread-5  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
18:18:43.434172 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:18:43.426944 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:18:43.419316 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a"
18:18:43.436199 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:18:43.413335 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:18:43.440981 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:18:43.440043 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:18:43.440528 [debug] [Thread-3  ]: finished collecting timing info
18:18:43.441487 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:18:43.441321 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:18:43.432098 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:18:43.441631 [debug] [Thread-4  ]: finished collecting timing info
18:18:43.455858 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:18:43.441842 [debug] [Thread-5  ]: finished collecting timing info
18:18:43.447686 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:18:43.455547 [debug] [Thread-1  ]: finished collecting timing info
18:18:43.461298 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
18:18:43.462467 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a"
18:18:43.462690 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a"
18:18:43.462767 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a: BEGIN
18:18:43.462825 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:18:43.461189 [debug] [Thread-7  ]: finished collecting timing info
18:18:43.463227 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:18:43.460968 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:18:43.459790 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:18:43.468206 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:18:43.468317 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:18:43.468410 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:18:43.460736 [debug] [Thread-5  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:18:43.467776 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:18:43.472978 [debug] [Thread-6  ]: finished collecting timing info
18:18:43.473225 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:18:43.474171 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:18:43.464871 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:18:43.441974 [debug] [Thread-2  ]: finished collecting timing info
18:18:43.474989 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:18:43.475861 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:18:43.474519 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:18:43.474879 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:18:43.478050 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:18:43.478138 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:18:43.472625 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:18:43.478740 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:18:43.478866 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: BEGIN
18:18:43.478921 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:18:43.476241 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:18:43.479080 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:18:43.476049 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:18:43.479218 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
18:18:43.479285 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:18:43.460495 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:18:43.479671 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:18:43.479786 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:18:43.479839 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:18:43.480565 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:18:43.480644 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a"
18:18:43.480696 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."customers"
    group by state

)

select *
from all_values
where value_field not in (
    'SP','GO','AL','PA','RO','MT','RS','SC','PR','BA','RJ','DF'
)



      
    ) dbt_internal_test
18:18:43.481546 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:18:43.482800 [debug] [Thread-1  ]: finished collecting timing info
18:18:43.482896 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a: ROLLBACK
18:18:43.483015 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a: Close
18:18:43.483297 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF  [[32mPASS[0m in 0.08s]
18:18:43.483591 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
18:18:43.487695 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
18:18:43.487994 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:18:43.488169 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:18:43.489592 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:18:43.491030 [debug] [Thread-6  ]: finished collecting timing info
18:18:43.491213 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:18:43.491385 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:18:43.491781 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.05s]
18:18:43.492187 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:18:43.476353 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:18:43.492476 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:18:43.492589 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:18:43.499989 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
18:18:43.500159 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:18:43.500250 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:18:43.501050 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
18:18:43.502335 [debug] [Thread-5  ]: finished collecting timing info
18:18:43.502489 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
18:18:43.502615 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.02 seconds
18:18:43.503650 [debug] [Thread-4  ]: finished collecting timing info
18:18:43.503785 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:18:43.503991 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: Close
18:18:43.504116 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:18:43.504591 [error] [Thread-5  ]: 5 of 7 FAIL 50 unique_customers_customer_id .................................... [[31mFAIL 50[0m in 0.08s]
18:18:43.505052 [debug] [Thread-5  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:18:43.505722 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.09s]
18:18:43.505966 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:18:43.512842 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:18:43.513153 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:18:43.513225 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:18:43.514018 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.0 seconds
18:18:43.515199 [debug] [Thread-7  ]: finished collecting timing info
18:18:43.515333 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:18:43.516435 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:18:43.516776 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.10s]
18:18:43.517046 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:18:43.520822 [debug] [Thread-3  ]: SQL status: BEGIN in 0.04 seconds
18:18:43.521218 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:18:43.521353 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:18:43.522062 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:18:43.523093 [debug] [Thread-3  ]: finished collecting timing info
18:18:43.523258 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:18:43.523684 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:18:43.524042 [error] [Thread-3  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.10s]
18:18:43.524486 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:18:43.525862 [debug] [Thread-2  ]: SQL status: BEGIN in 0.05 seconds
18:18:43.525947 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:18:43.526002 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
18:18:43.526479 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:18:43.527265 [debug] [Thread-2  ]: finished collecting timing info
18:18:43.527395 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
18:18:43.527993 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
18:18:43.528346 [info ] [Thread-2  ]: 2 of 7 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.12s]
18:18:43.528615 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:18:43.529937 [debug] [MainThread]: Acquiring new postgres connection "master"
18:18:43.530050 [debug] [MainThread]: Using postgres connection "master"
18:18:43.530112 [debug] [MainThread]: On master: BEGIN
18:18:43.530173 [debug] [MainThread]: Opening a new connection, currently in state closed
18:18:43.546876 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:18:43.547099 [debug] [MainThread]: On master: COMMIT
18:18:43.547167 [debug] [MainThread]: Using postgres connection "master"
18:18:43.547283 [debug] [MainThread]: On master: COMMIT
18:18:43.547603 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:18:43.547718 [debug] [MainThread]: On master: Close
18:18:43.548361 [info ] [MainThread]: 
18:18:43.548524 [info ] [MainThread]: Finished running 7 tests in 0.20s.
18:18:43.548636 [debug] [MainThread]: Connection 'master' was properly closed.
18:18:43.548706 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a' was properly closed.
18:18:43.548754 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
18:18:43.548799 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:18:43.548852 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:18:43.548902 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:18:43.548946 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
18:18:43.548991 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:18:43.556126 [info ] [MainThread]: 
18:18:43.556397 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
18:18:43.556535 [info ] [MainThread]: 
18:18:43.556634 [error] [MainThread]: [31mFailure in test unique_customers_customer_id (models/erp/schema.yml)[0m
18:18:43.556742 [error] [MainThread]:   Got 50 results, configured to fail if != 0
18:18:43.556846 [info ] [MainThread]: 
18:18:43.556937 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_customers_customer_id.sql
18:18:43.557028 [info ] [MainThread]: 
18:18:43.557115 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:18:43.557206 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:18:43.557290 [info ] [MainThread]: 
18:18:43.557374 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:18:43.557471 [info ] [MainThread]: 
18:18:43.557559 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
18:18:43.557725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7db1e340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7db1ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca7f37afd0>]}


============================== 2022-06-07 18:30:04.213148 | 085a5e21-7663-4d26-b2dd-8e8a0b8b5689 ==============================
18:30:04.213160 [info ] [MainThread]: Running with dbt=1.1.0
18:30:04.213520 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:30:04.213696 [debug] [MainThread]: Tracking: tracking
18:30:04.216672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4fa143f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4fa143e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4fa1436d0>]}
18:30:04.239843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
18:30:04.240194 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/stg_orders.sql
18:30:04.240501 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:30:04.255292 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
18:30:04.264013 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:30:04.315433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '085a5e21-7663-4d26-b2dd-8e8a0b8b5689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4fbf8e700>]}
18:30:04.318450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '085a5e21-7663-4d26-b2dd-8e8a0b8b5689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4febde7f0>]}
18:30:04.318668 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:30:04.318804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '085a5e21-7663-4d26-b2dd-8e8a0b8b5689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4fa084160>]}
18:30:04.319669 [info ] [MainThread]: 
18:30:04.319960 [debug] [MainThread]: Acquiring new postgres connection "master"
18:30:04.320693 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:30:04.327044 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:30:04.327138 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:30:04.327198 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:30:04.332238 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:30:04.333064 [debug] [ThreadPool]: On list_erp_oltp: Close
18:30:04.335130 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:30:04.338401 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:30:04.338485 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:30:04.338539 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:30:04.357635 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:30:04.357860 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:30:04.357925 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:30:04.360348 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:30:04.361385 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:30:04.361774 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:30:04.364583 [debug] [MainThread]: Using postgres connection "master"
18:30:04.364675 [debug] [MainThread]: On master: BEGIN
18:30:04.364733 [debug] [MainThread]: Opening a new connection, currently in state init
18:30:04.368546 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:30:04.368660 [debug] [MainThread]: Using postgres connection "master"
18:30:04.368716 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:30:04.377107 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
18:30:04.378022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '085a5e21-7663-4d26-b2dd-8e8a0b8b5689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4fa06b8e0>]}
18:30:04.378245 [debug] [MainThread]: On master: ROLLBACK
18:30:04.378444 [debug] [MainThread]: Using postgres connection "master"
18:30:04.378515 [debug] [MainThread]: On master: BEGIN
18:30:04.378672 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:30:04.378742 [debug] [MainThread]: On master: COMMIT
18:30:04.378792 [debug] [MainThread]: Using postgres connection "master"
18:30:04.378839 [debug] [MainThread]: On master: COMMIT
18:30:04.378926 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:30:04.378990 [debug] [MainThread]: On master: Close
18:30:04.379238 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:30:04.379377 [info ] [MainThread]: 
18:30:04.383714 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:30:04.383896 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:30:04.384212 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:30:04.384300 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:30:04.384425 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:30:04.384547 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:30:04.387213 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:30:04.385589 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:30:04.385740 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:30:04.385477 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:30:04.387790 [info ] [Thread-3  ]: 3 of 7 START table model public.stg_customers .................................. [RUN]
18:30:04.387663 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:30:04.388044 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:30:04.388334 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:30:04.388171 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:30:04.388411 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:30:04.389228 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:30:04.388490 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:30:04.387398 [info ] [Thread-4  ]: 4 of 7 START table model public.stg_orders ..................................... [RUN]
18:30:04.390789 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:30:04.390874 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:30:04.390928 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:30:04.390508 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:30:04.391956 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:30:04.392252 [debug] [Thread-4  ]: finished collecting timing info
18:30:04.392467 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:30:04.392369 [debug] [Thread-2  ]: finished collecting timing info
18:30:04.388583 [debug] [Thread-1  ]: finished collecting timing info
18:30:04.411019 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:30:04.410746 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:30:04.399541 [debug] [Thread-3  ]: finished collecting timing info
18:30:04.431666 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:30:04.420675 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:30:04.431408 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:30:04.433603 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:30:04.433201 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:30:04.421327 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:30:04.433803 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:30:04.434398 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:30:04.434187 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:30:04.435493 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:30:04.434030 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:30:04.435595 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:30:04.435721 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:30:04.436197 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:30:04.436262 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:30:04.435861 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:30:04.436881 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:30:04.441534 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:30:04.441692 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:30:04.441751 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
18:30:04.443725 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:30:04.443921 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:30:04.444008 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */


  create  table "erp_oltp"."public"."stg_orders__dbt_tmp"
  as (
    with orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
)
select * from orders
  );
18:30:04.444106 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:30:04.444224 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:30:04.444315 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:30:04.444431 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
18:30:04.448647 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:30:04.448819 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
18:30:04.449080 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:30:04.449146 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)
select * from customers
  );
18:30:04.448971 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:30:04.448897 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:30:04.450473 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:30:04.450550 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:30:04.450641 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.0 seconds
18:30:04.451719 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:30:04.451795 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:30:04.452114 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:04.453186 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:30:04.453283 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:30:04.453435 [debug] [Thread-4  ]: SQL status: SELECT 295 in 0.01 seconds
18:30:04.454501 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:30:04.454584 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:30:04.454707 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
18:30:04.455695 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:30:04.455778 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:30:04.455879 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
18:30:04.456943 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:30:04.457039 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:30:04.457195 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:04.462603 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
18:30:04.466325 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:30:04.466441 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:30:04.466500 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:30:04.466628 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
18:30:04.467658 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:30:04.467763 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:30:04.467846 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:30:04.467911 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:30:04.468104 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
18:30:04.473331 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:30:04.473427 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:30:04.472525 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:30:04.473731 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:30:04.473491 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
18:30:04.473629 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:30:04.469897 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:30:04.474535 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:30:04.475615 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:30:04.475517 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:30:04.475798 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:30:04.477112 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:30:04.478106 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:30:04.478191 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:30:04.478758 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
18:30:04.479479 [debug] [Thread-3  ]: finished collecting timing info
18:30:04.479575 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:30:04.479855 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '085a5e21-7663-4d26-b2dd-8e8a0b8b5689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4fa132c10>]}
18:30:04.480056 [info ] [Thread-3  ]: 3 of 7 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.09s]
18:30:04.480356 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
18:30:04.480966 [debug] [Thread-1  ]: finished collecting timing info
18:30:04.481057 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:30:04.481302 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '085a5e21-7663-4d26-b2dd-8e8a0b8b5689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4fa0cf0d0>]}
18:30:04.481517 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.10s]
18:30:04.481629 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:30:04.482253 [debug] [Thread-2  ]: finished collecting timing info
18:30:04.482357 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:30:04.482611 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '085a5e21-7663-4d26-b2dd-8e8a0b8b5689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f9b692e0>]}
18:30:04.482789 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.10s]
18:30:04.481679 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
18:30:04.483648 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:30:04.483730 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop table if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:30:04.484033 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:30:04.484374 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:30:04.485480 [debug] [Thread-6  ]: Began running node model.first_project.customers2
18:30:04.485653 [info ] [Thread-6  ]: 5 of 7 START table model public.customers2 ..................................... [RUN]
18:30:04.485800 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
18:30:04.486371 [debug] [Thread-4  ]: finished collecting timing info
18:30:04.486454 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:30:04.486680 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '085a5e21-7663-4d26-b2dd-8e8a0b8b5689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f82fdfd0>]}
18:30:04.486849 [info ] [Thread-4  ]: 4 of 7 OK created table model public.stg_orders ................................ [[32mSELECT 295[0m in 0.10s]
18:30:04.487062 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:30:04.487233 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
18:30:04.487342 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
18:30:04.487407 [debug] [Thread-6  ]: Compiling model.first_project.customers2
18:30:04.488965 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
18:30:04.489244 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
18:30:04.489382 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:30:04.489511 [info ] [Thread-8  ]: 6 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:30:04.489998 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:30:04.490067 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
18:30:04.490141 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
18:30:04.491346 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:30:04.491550 [debug] [Thread-8  ]: finished collecting timing info
18:30:04.491625 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
18:30:04.492893 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:30:04.493109 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:30:04.493206 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
18:30:04.493265 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:30:04.489773 [debug] [Thread-10 ]: Began running node model.first_project.customers
18:30:04.493891 [info ] [Thread-10 ]: 7 of 7 START table model public.customers ...................................... [RUN]
18:30:04.494129 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
18:30:04.494198 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
18:30:04.494254 [debug] [Thread-10 ]: Compiling model.first_project.customers
18:30:04.495726 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
18:30:04.495924 [debug] [Thread-10 ]: finished collecting timing info
18:30:04.496030 [debug] [Thread-10 ]: Began executing node model.first_project.customers
18:30:04.497606 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.customers"
18:30:04.503098 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:30:04.503475 [debug] [Thread-10 ]: On model.first_project.customers: BEGIN
18:30:04.503322 [debug] [Thread-6  ]: finished collecting timing info
18:30:04.503584 [debug] [Thread-10 ]: Opening a new connection, currently in state init
18:30:04.503755 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
18:30:04.506552 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
18:30:04.517184 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:30:04.517441 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
18:30:04.517513 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:30:04.517801 [debug] [Thread-10 ]: SQL status: BEGIN in 0.01 seconds
18:30:04.518020 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:30:04.518108 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
order as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
 customers.state
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
18:30:04.518907 [debug] [Thread-10 ]: Postgres adapter: Postgres error: syntax error at or near "order"
LINE 9: order as (
        ^

18:30:04.519040 [debug] [Thread-10 ]: On model.first_project.customers: ROLLBACK
18:30:04.519298 [debug] [Thread-10 ]: finished collecting timing info
18:30:04.519424 [debug] [Thread-10 ]: On model.first_project.customers: Close
18:30:04.519701 [debug] [Thread-10 ]: Database Error in model customers (models/erp/customers.sql)
  syntax error at or near "order"
  LINE 9: order as (
          ^
  compiled SQL at target/run/first_project/models/erp/customers.sql
18:30:04.519884 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '085a5e21-7663-4d26-b2dd-8e8a0b8b5689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f825e0d0>]}
18:30:04.520103 [error] [Thread-10 ]: 7 of 7 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.03s]
18:30:04.520456 [debug] [Thread-10 ]: Finished running node model.first_project.customers
18:30:04.520553 [debug] [Thread-8  ]: SQL status: BEGIN in 0.03 seconds
18:30:04.520787 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:30:04.520856 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:30:04.521686 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
18:30:04.523060 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:30:04.523137 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:30:04.523382 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:04.524052 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:30:04.524124 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:30:04.524207 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:30:04.525267 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
18:30:04.527139 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:30:04.527302 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:30:04.527519 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
18:30:04.528281 [debug] [Thread-8  ]: finished collecting timing info
18:30:04.528477 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
18:30:04.528605 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
18:30:04.528686 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:30:04.528739 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
18:30:04.530085 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '085a5e21-7663-4d26-b2dd-8e8a0b8b5689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f82a4e50>]}
18:30:04.530351 [info ] [Thread-8  ]: 6 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
18:30:04.530432 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
18:30:04.531666 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:30:04.531742 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:30:04.532006 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
18:30:04.532107 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:04.534096 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:30:04.534225 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:30:04.534567 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:04.535354 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:30:04.535429 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:30:04.535488 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:30:04.536958 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
18:30:04.538692 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:30:04.540690 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:30:04.549341 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
18:30:04.550309 [debug] [Thread-6  ]: finished collecting timing info
18:30:04.550469 [debug] [Thread-6  ]: On model.first_project.customers2: Close
18:30:04.550827 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '085a5e21-7663-4d26-b2dd-8e8a0b8b5689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f8255f40>]}
18:30:04.551048 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.06s]
18:30:04.551328 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
18:30:04.552772 [debug] [MainThread]: Acquiring new postgres connection "master"
18:30:04.552908 [debug] [MainThread]: Using postgres connection "master"
18:30:04.552971 [debug] [MainThread]: On master: BEGIN
18:30:04.553026 [debug] [MainThread]: Opening a new connection, currently in state closed
18:30:04.557660 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:30:04.557816 [debug] [MainThread]: On master: COMMIT
18:30:04.557878 [debug] [MainThread]: Using postgres connection "master"
18:30:04.557933 [debug] [MainThread]: On master: COMMIT
18:30:04.558088 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:30:04.558176 [debug] [MainThread]: On master: Close
18:30:04.558472 [info ] [MainThread]: 
18:30:04.558633 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0.24s.
18:30:04.558735 [debug] [MainThread]: Connection 'master' was properly closed.
18:30:04.558785 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:30:04.558859 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:30:04.558906 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:30:04.558954 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:30:04.559002 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:30:04.559157 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:30:04.559326 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:30:04.562239 [info ] [MainThread]: 
18:30:04.562392 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:30:04.562519 [info ] [MainThread]: 
18:30:04.562616 [error] [MainThread]: [33mDatabase Error in model customers (models/erp/customers.sql)[0m
18:30:04.562714 [error] [MainThread]:   syntax error at or near "order"
18:30:04.562802 [error] [MainThread]:   LINE 9: order as (
18:30:04.562889 [error] [MainThread]:           ^
18:30:04.562976 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/customers.sql
18:30:04.563071 [info ] [MainThread]: 
18:30:04.563187 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
18:30:04.563342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f9fdc730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4fb9437f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f824c640>]}


============================== 2022-06-07 18:30:43.770609 | b836e662-9ffe-4023-b66b-04a58f9f2010 ==============================
18:30:43.770620 [info ] [MainThread]: Running with dbt=1.1.0
18:30:43.771007 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:30:43.771114 [debug] [MainThread]: Tracking: tracking
18:30:43.773412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4b2d6b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4b2d6e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4b2d6b20>]}
18:30:43.791465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:30:43.791844 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:30:43.801700 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:30:43.863258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b836e662-9ffe-4023-b66b-04a58f9f2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4d121700>]}
18:30:43.866388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b836e662-9ffe-4023-b66b-04a58f9f2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4fd717f0>]}
18:30:43.866630 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:30:43.866782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b836e662-9ffe-4023-b66b-04a58f9f2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4b2182e0>]}
18:30:43.867839 [info ] [MainThread]: 
18:30:43.868223 [debug] [MainThread]: Acquiring new postgres connection "master"
18:30:43.869030 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:30:43.875448 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:30:43.875547 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:30:43.875604 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:30:43.881878 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:30:43.882707 [debug] [ThreadPool]: On list_erp_oltp: Close
18:30:43.883789 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:30:43.893318 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:30:43.893606 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:30:43.893690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:30:43.901616 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:30:43.901797 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:30:43.901859 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:30:43.903222 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:30:43.904133 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:30:43.904363 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:30:43.907241 [debug] [MainThread]: Using postgres connection "master"
18:30:43.907454 [debug] [MainThread]: On master: BEGIN
18:30:43.907527 [debug] [MainThread]: Opening a new connection, currently in state init
18:30:43.913767 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:30:43.913999 [debug] [MainThread]: Using postgres connection "master"
18:30:43.914087 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:30:43.924644 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
18:30:43.926089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b836e662-9ffe-4023-b66b-04a58f9f2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4b1d1dc0>]}
18:30:43.926365 [debug] [MainThread]: On master: ROLLBACK
18:30:43.926711 [debug] [MainThread]: Using postgres connection "master"
18:30:43.926824 [debug] [MainThread]: On master: BEGIN
18:30:43.927276 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:30:43.927510 [debug] [MainThread]: On master: COMMIT
18:30:43.927589 [debug] [MainThread]: Using postgres connection "master"
18:30:43.927667 [debug] [MainThread]: On master: COMMIT
18:30:43.927951 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:30:43.928070 [debug] [MainThread]: On master: Close
18:30:43.928491 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:30:43.928680 [info ] [MainThread]: 
18:30:43.933792 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:30:43.933987 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:30:43.934281 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:30:43.934361 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:30:43.934435 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:30:43.935903 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:30:43.936182 [debug] [Thread-1  ]: finished collecting timing info
18:30:43.936384 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:30:43.937046 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:30:43.936726 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:30:43.936892 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:30:43.937781 [info ] [Thread-4  ]: 4 of 7 START table model public.stg_orders ..................................... [RUN]
18:30:43.938053 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:30:43.938133 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:30:43.937572 [info ] [Thread-3  ]: 3 of 7 START table model public.stg_customers .................................. [RUN]
18:30:43.938196 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:30:43.939232 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:30:43.939424 [debug] [Thread-4  ]: finished collecting timing info
18:30:43.938521 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:30:43.939713 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:30:43.939813 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:30:43.940398 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:30:43.940561 [debug] [Thread-3  ]: finished collecting timing info
18:30:43.940655 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:30:43.937357 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:30:43.946378 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:30:43.946528 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:30:43.947927 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:30:43.939544 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:30:43.936475 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:30:43.968874 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:30:43.967131 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:30:43.967380 [debug] [Thread-2  ]: finished collecting timing info
18:30:43.964386 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:30:43.973495 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:30:43.976451 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:30:43.973786 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:30:43.976260 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:30:43.974118 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:30:43.976521 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:30:43.981797 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:30:43.981962 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:30:43.987807 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:30:43.987694 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:30:43.986687 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:30:43.988339 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:30:43.988478 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:30:43.988533 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:30:43.993876 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:30:43.994067 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:30:43.994135 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */


  create  table "erp_oltp"."public"."stg_orders__dbt_tmp"
  as (
    with orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
)
select * from orders
  );
18:30:43.995493 [debug] [Thread-4  ]: SQL status: SELECT 295 in 0.0 seconds
18:30:43.999174 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:30:43.999288 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:30:43.999584 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:44.000843 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:30:44.000968 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:30:44.001193 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:30:44.001281 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:30:44.001339 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
18:30:44.001948 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:44.002081 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
18:30:44.008050 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
18:30:44.011480 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:30:44.011573 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:30:44.008468 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:30:44.008235 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:30:44.011807 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:30:44.011694 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)
select * from customers
  );
18:30:44.009968 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:30:44.011887 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:30:44.012654 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:44.012085 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:30:44.014111 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:30:44.014309 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:30:44.014443 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:30:44.015823 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:30:44.016041 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:30:44.014559 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:30:44.016435 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:44.017481 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:30:44.017555 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:30:44.017863 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:44.018800 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:30:44.018873 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:30:44.018925 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:30:44.019063 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:44.019833 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:30:44.019930 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.01 seconds
18:30:44.021267 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:30:44.020086 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:30:44.021445 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:30:44.020173 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:30:44.021362 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:30:44.020008 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
18:30:44.026289 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:30:44.025534 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:30:44.027195 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:30:44.027281 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:30:44.024907 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:30:44.026476 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:44.027391 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:30:44.026381 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop table if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:30:44.028509 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:30:44.029361 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:30:44.029632 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:44.030566 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:30:44.030647 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:30:44.030701 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:30:44.030810 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:30:44.031543 [debug] [Thread-2  ]: finished collecting timing info
18:30:44.031651 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:30:44.031737 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
18:30:44.032630 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:30:44.032716 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:30:44.032965 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b836e662-9ffe-4023-b66b-04a58f9f2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4ad3c5b0>]}
18:30:44.033195 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.10s]
18:30:44.033588 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:30:44.033761 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:30:44.033843 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
18:30:44.037648 [debug] [Thread-3  ]: finished collecting timing info
18:30:44.037741 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:30:44.037980 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b836e662-9ffe-4023-b66b-04a58f9f2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f484950d0>]}
18:30:44.038178 [info ] [Thread-3  ]: 3 of 7 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.10s]
18:30:44.034492 [debug] [Thread-1  ]: finished collecting timing info
18:30:44.038363 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:30:44.038563 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b836e662-9ffe-4023-b66b-04a58f9f2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4b2bd460>]}
18:30:44.038714 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.10s]
18:30:44.034583 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.01 seconds
18:30:44.039368 [debug] [Thread-4  ]: finished collecting timing info
18:30:44.039456 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:30:44.040673 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b836e662-9ffe-4023-b66b-04a58f9f2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4ad20130>]}
18:30:44.040874 [info ] [Thread-4  ]: 4 of 7 OK created table model public.stg_orders ................................ [[32mSELECT 295[0m in 0.10s]
18:30:44.041156 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:30:44.041464 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:30:44.041722 [debug] [Thread-6  ]: Began running node model.first_project.customers2
18:30:44.041847 [info ] [Thread-6  ]: 5 of 7 START table model public.customers2 ..................................... [RUN]
18:30:44.042079 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:30:44.042270 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
18:30:44.042415 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
18:30:44.042510 [debug] [Thread-6  ]: Compiling model.first_project.customers2
18:30:44.044028 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
18:30:44.044276 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
18:30:44.044459 [info ] [Thread-8  ]: 6 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:30:44.044689 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:30:44.044764 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
18:30:44.044826 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
18:30:44.055310 [debug] [Thread-10 ]: Began running node model.first_project.customers
18:30:44.055687 [info ] [Thread-10 ]: 7 of 7 START table model public.customers ...................................... [RUN]
18:30:44.056371 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
18:30:44.056497 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
18:30:44.056620 [debug] [Thread-10 ]: Compiling model.first_project.customers
18:30:44.058658 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
18:30:44.059029 [debug] [Thread-6  ]: finished collecting timing info
18:30:44.059195 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
18:30:44.060783 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
18:30:44.060997 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:30:44.061091 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
18:30:44.061177 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:30:44.061393 [debug] [Thread-10 ]: finished collecting timing info
18:30:44.061512 [debug] [Thread-10 ]: Began executing node model.first_project.customers
18:30:44.062860 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.customers"
18:30:44.063055 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:30:44.063174 [debug] [Thread-10 ]: On model.first_project.customers: BEGIN
18:30:44.063241 [debug] [Thread-10 ]: Opening a new connection, currently in state init
18:30:44.064519 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:30:44.064736 [debug] [Thread-8  ]: finished collecting timing info
18:30:44.064869 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
18:30:44.066321 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:30:44.067756 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:30:44.067938 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
18:30:44.068001 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:30:44.068937 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
18:30:44.069055 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:30:44.069116 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
18:30:44.070482 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
18:30:44.071932 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:30:44.072027 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:30:44.072273 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:44.073474 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:30:44.073563 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:30:44.073661 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
18:30:44.073762 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:30:44.073826 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:30:44.073911 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:44.075543 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:30:44.075711 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:30:44.075792 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:30:44.080437 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.01 seconds
18:30:44.083089 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:30:44.083216 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:30:44.083518 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
18:30:44.085623 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:30:44.085813 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:30:44.085977 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:44.087606 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:30:44.087708 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:30:44.087774 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:30:44.088541 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
18:30:44.089455 [debug] [Thread-6  ]: finished collecting timing info
18:30:44.089569 [debug] [Thread-6  ]: On model.first_project.customers2: Close
18:30:44.089693 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
18:30:44.090698 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:30:44.090846 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:30:44.091199 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b836e662-9ffe-4023-b66b-04a58f9f2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4ad334f0>]}
18:30:44.091703 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.05s]
18:30:44.091998 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
18:30:44.093171 [debug] [Thread-8  ]: finished collecting timing info
18:30:44.093441 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
18:30:44.093752 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
18:30:44.096110 [debug] [Thread-10 ]: SQL status: BEGIN in 0.03 seconds
18:30:44.096214 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:30:44.096278 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
 customers.state
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
18:30:44.096689 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b836e662-9ffe-4023-b66b-04a58f9f2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f483ffb20>]}
18:30:44.096933 [info ] [Thread-8  ]: 6 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
18:30:44.097190 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
18:30:44.100037 [debug] [Thread-10 ]: SQL status: SELECT 100 in 0.0 seconds
18:30:44.101696 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:30:44.101797 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
18:30:44.102042 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:44.103181 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:30:44.103260 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:30:44.103473 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
18:30:44.104193 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
18:30:44.104746 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:30:44.104818 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
18:30:44.111997 [debug] [Thread-10 ]: SQL status: COMMIT in 0.01 seconds
18:30:44.113530 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:30:44.113689 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:30:44.116402 [debug] [Thread-10 ]: SQL status: DROP TABLE in 0.0 seconds
18:30:44.117286 [debug] [Thread-10 ]: finished collecting timing info
18:30:44.117410 [debug] [Thread-10 ]: On model.first_project.customers: Close
18:30:44.117714 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b836e662-9ffe-4023-b66b-04a58f9f2010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f484775b0>]}
18:30:44.117929 [info ] [Thread-10 ]: 7 of 7 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.06s]
18:30:44.118278 [debug] [Thread-10 ]: Finished running node model.first_project.customers
18:30:44.119651 [debug] [MainThread]: Acquiring new postgres connection "master"
18:30:44.119817 [debug] [MainThread]: Using postgres connection "master"
18:30:44.119882 [debug] [MainThread]: On master: BEGIN
18:30:44.119971 [debug] [MainThread]: Opening a new connection, currently in state closed
18:30:44.137764 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:30:44.137965 [debug] [MainThread]: On master: COMMIT
18:30:44.138031 [debug] [MainThread]: Using postgres connection "master"
18:30:44.138089 [debug] [MainThread]: On master: COMMIT
18:30:44.138204 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:30:44.138289 [debug] [MainThread]: On master: Close
18:30:44.138656 [info ] [MainThread]: 
18:30:44.139869 [info ] [MainThread]: Finished running 2 view models, 5 table models in 0.27s.
18:30:44.140032 [debug] [MainThread]: Connection 'master' was properly closed.
18:30:44.140086 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:30:44.140135 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:30:44.140181 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:30:44.140226 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:30:44.140271 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:30:44.140320 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:30:44.140428 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:30:44.143681 [info ] [MainThread]: 
18:30:44.143918 [info ] [MainThread]: [32mCompleted successfully[0m
18:30:44.144087 [info ] [MainThread]: 
18:30:44.144210 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:30:44.144444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4cb1fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4cb73ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4ad3afa0>]}


============================== 2022-06-07 18:36:25.513708 | 7ad5924d-14a8-4fe6-abb8-f8b9ea479024 ==============================
18:36:25.513720 [info ] [MainThread]: Running with dbt=1.1.0
18:36:25.514082 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:36:25.514170 [debug] [MainThread]: Tracking: tracking
18:36:25.517183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffff9daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffff9de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffff9db20>]}
18:36:25.538214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:36:25.538624 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
18:36:25.555027 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:36:25.610449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ad5924d-14a8-4fe6-abb8-f8b9ea479024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40017b77f0>]}
18:36:25.613469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ad5924d-14a8-4fe6-abb8-f8b9ea479024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fffedf130>]}
18:36:25.613705 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:36:25.613898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ad5924d-14a8-4fe6-abb8-f8b9ea479024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fffedf040>]}
18:36:25.615088 [info ] [MainThread]: 
18:36:25.615594 [debug] [MainThread]: Acquiring new postgres connection "master"
18:36:25.616599 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:36:25.622396 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:36:25.622483 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:36:25.622542 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:36:25.633946 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:36:25.635161 [debug] [ThreadPool]: On list_erp_oltp: Close
18:36:25.637246 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:36:25.640865 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:36:25.640982 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:36:25.641042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:36:25.645850 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
18:36:25.646006 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:36:25.646065 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:36:25.647360 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:36:25.648520 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:36:25.649103 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:36:25.659350 [debug] [MainThread]: Using postgres connection "master"
18:36:25.659582 [debug] [MainThread]: On master: BEGIN
18:36:25.659650 [debug] [MainThread]: Opening a new connection, currently in state init
18:36:25.663999 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:36:25.664206 [debug] [MainThread]: Using postgres connection "master"
18:36:25.664296 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:36:25.674469 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
18:36:25.675440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ad5924d-14a8-4fe6-abb8-f8b9ea479024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fffe98eb0>]}
18:36:25.675676 [debug] [MainThread]: On master: ROLLBACK
18:36:25.676024 [debug] [MainThread]: Using postgres connection "master"
18:36:25.676121 [debug] [MainThread]: On master: BEGIN
18:36:25.676336 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:36:25.676439 [debug] [MainThread]: On master: COMMIT
18:36:25.676492 [debug] [MainThread]: Using postgres connection "master"
18:36:25.676543 [debug] [MainThread]: On master: COMMIT
18:36:25.676661 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:36:25.676743 [debug] [MainThread]: On master: Close
18:36:25.676996 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:36:25.677130 [info ] [MainThread]: 
18:36:25.679712 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:36:25.679881 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:36:25.680106 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:36:25.680176 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:36:25.680242 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:36:25.681843 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:36:25.682205 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:36:25.682507 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:36:25.682710 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:36:25.683559 [info ] [Thread-3  ]: 3 of 7 START table model public.stg_customers .................................. [RUN]
18:36:25.683260 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:36:25.682812 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:36:25.684245 [info ] [Thread-4  ]: 4 of 7 START table model public.stg_orders ..................................... [RUN]
18:36:25.684046 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:36:25.684640 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:36:25.684535 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:36:25.686328 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:36:25.686108 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:36:25.686405 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:36:25.687102 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:36:25.683928 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:36:25.687287 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:36:25.687470 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:36:25.688064 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:36:25.688216 [debug] [Thread-3  ]: finished collecting timing info
18:36:25.688350 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:36:25.687384 [debug] [Thread-2  ]: finished collecting timing info
18:36:25.686234 [debug] [Thread-1  ]: finished collecting timing info
18:36:25.707490 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:36:25.707211 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:36:25.718278 [debug] [Thread-4  ]: finished collecting timing info
18:36:25.721373 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:36:25.721527 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:36:25.729005 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:36:25.729269 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:36:25.729373 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:36:25.729430 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:36:25.722339 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:36:25.729924 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:36:25.730016 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:36:25.730072 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:36:25.727187 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:36:25.730448 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:36:25.730537 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:36:25.730588 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:36:25.736421 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:36:25.736604 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:36:25.736665 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:36:25.741562 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
18:36:25.741755 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:36:25.741821 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:36:25.742847 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:36:25.749491 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:36:25.749721 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:36:25.750397 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:36:25.750556 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:36:25.752531 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:36:25.752415 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:36:25.750653 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:36:25.753031 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:36:25.752855 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:36:25.752947 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:36:25.753205 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:36:25.753265 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)
select * from customers
  );
18:36:25.753091 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
18:36:25.752621 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */


  create  table "erp_oltp"."public"."stg_orders__dbt_tmp"
  as (
    with orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
)
select * from orders
  );
18:36:25.754171 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:36:25.759448 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.01 seconds
18:36:25.761744 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:36:25.763149 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:36:25.763566 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:36:25.763332 [debug] [Thread-4  ]: SQL status: SELECT 295 in 0.01 seconds
18:36:25.763455 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:36:25.765073 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:36:25.765867 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:36:25.763225 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
18:36:25.765710 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:36:25.767328 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:36:25.767487 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:36:25.765238 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:36:25.768646 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:36:25.768726 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:36:25.768981 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:36:25.769814 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:36:25.769899 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:36:25.769956 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:36:25.770157 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:36:25.773579 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:36:25.773678 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:36:25.773773 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
18:36:25.774922 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:36:25.775032 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:36:25.775152 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
18:36:25.776348 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:36:25.776461 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:36:25.776563 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:36:25.777469 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:36:25.777296 [debug] [Thread-1  ]: finished collecting timing info
18:36:25.778109 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:36:25.778414 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:36:25.778488 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:36:25.778308 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:36:25.778193 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:36:25.779316 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:36:25.779441 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:36:25.779501 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:36:25.776658 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
18:36:25.780522 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:36:25.780618 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:36:25.781127 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
18:36:25.782316 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:36:25.782413 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop table if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:36:25.782505 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:36:25.783370 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:36:25.783466 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:36:25.783563 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
18:36:25.784386 [debug] [Thread-3  ]: finished collecting timing info
18:36:25.784494 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:36:25.784804 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ad5924d-14a8-4fe6-abb8-f8b9ea479024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffc1584c0>]}
18:36:25.785015 [info ] [Thread-3  ]: 3 of 7 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.10s]
18:36:25.785236 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:36:25.786705 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
18:36:25.786910 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:36:25.787748 [debug] [Thread-4  ]: finished collecting timing info
18:36:25.788883 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:36:25.788101 [debug] [Thread-6  ]: Began running node model.first_project.customers2
18:36:25.789062 [info ] [Thread-6  ]: 5 of 7 START table model public.customers2 ..................................... [RUN]
18:36:25.789293 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
18:36:25.789363 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
18:36:25.789425 [debug] [Thread-6  ]: Compiling model.first_project.customers2
18:36:25.787945 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ad5924d-14a8-4fe6-abb8-f8b9ea479024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4001d7f310>]}
18:36:25.790865 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
18:36:25.791566 [debug] [Thread-6  ]: finished collecting timing info
18:36:25.791679 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
18:36:25.791110 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ad5924d-14a8-4fe6-abb8-f8b9ea479024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffc1584f0>]}
18:36:25.793469 [info ] [Thread-4  ]: 4 of 7 OK created table model public.stg_orders ................................ [[32mSELECT 295[0m in 0.11s]
18:36:25.793203 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
18:36:25.788740 [debug] [Thread-2  ]: finished collecting timing info
18:36:25.791320 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
18:36:25.794379 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:36:25.793996 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:36:25.795788 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
18:36:25.793774 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:36:25.795711 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
18:36:25.796027 [info ] [Thread-8  ]: 6 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:36:25.796251 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:36:25.796373 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
18:36:25.796440 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
18:36:25.797727 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:36:25.797927 [debug] [Thread-8  ]: finished collecting timing info
18:36:25.798050 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
18:36:25.799402 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:36:25.799626 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:36:25.799724 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
18:36:25.799779 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:36:25.800652 [debug] [Thread-10 ]: Began running node model.first_project.customers
18:36:25.800801 [info ] [Thread-10 ]: 7 of 7 START table model public.customers ...................................... [RUN]
18:36:25.801041 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
18:36:25.801108 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
18:36:25.801167 [debug] [Thread-10 ]: Compiling model.first_project.customers
18:36:25.802639 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
18:36:25.802858 [debug] [Thread-10 ]: finished collecting timing info
18:36:25.802936 [debug] [Thread-10 ]: Began executing node model.first_project.customers
18:36:25.804384 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.customers"
18:36:25.804562 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:36:25.804699 [debug] [Thread-10 ]: On model.first_project.customers: BEGIN
18:36:25.804759 [debug] [Thread-10 ]: Opening a new connection, currently in state init
18:36:25.795855 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:36:25.794110 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:36:25.806532 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ad5924d-14a8-4fe6-abb8-f8b9ea479024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffff29310>]}
18:36:25.806749 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.12s]
18:36:25.806961 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:36:25.816729 [debug] [Thread-10 ]: SQL status: BEGIN in 0.01 seconds
18:36:25.817062 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:36:25.817142 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
 customers.state
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
18:36:25.819047 [debug] [Thread-10 ]: SQL status: SELECT 100 in 0.0 seconds
18:36:25.821132 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:36:25.821475 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
18:36:25.821832 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
18:36:25.823653 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:36:25.823799 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:36:25.824018 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
18:36:25.824096 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:36:25.824151 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:36:25.824442 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
18:36:25.825333 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
18:36:25.825415 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:36:25.825472 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
18:36:25.826300 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
18:36:25.828697 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:36:25.828819 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
18:36:25.828977 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:36:25.829066 [debug] [Thread-10 ]: SQL status: COMMIT in 0.0 seconds
18:36:25.829162 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:36:25.830089 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:36:25.830230 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:36:25.830309 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
18:36:25.830410 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:36:25.831083 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:36:25.843027 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:36:25.843422 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:36:25.843979 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.01 seconds
18:36:25.845740 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:36:25.845830 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:36:25.845920 [debug] [Thread-10 ]: SQL status: DROP TABLE in 0.01 seconds
18:36:25.846705 [debug] [Thread-10 ]: finished collecting timing info
18:36:25.846831 [debug] [Thread-10 ]: On model.first_project.customers: Close
18:36:25.846913 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:36:25.848644 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:36:25.848776 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:36:25.849937 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ad5924d-14a8-4fe6-abb8-f8b9ea479024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffc0a5550>]}
18:36:25.850291 [info ] [Thread-10 ]: 7 of 7 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.05s]
18:36:25.850536 [debug] [Thread-10 ]: Finished running node model.first_project.customers
18:36:25.850685 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
18:36:25.851791 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:36:25.851921 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:36:25.852096 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:36:25.853028 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:36:25.853105 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:36:25.853159 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:36:25.853537 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
18:36:25.854347 [debug] [Thread-8  ]: finished collecting timing info
18:36:25.854460 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
18:36:25.854926 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ad5924d-14a8-4fe6-abb8-f8b9ea479024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40017b7370>]}
18:36:25.855135 [info ] [Thread-8  ]: 6 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
18:36:25.855374 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
18:36:25.856055 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
18:36:25.857019 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:36:25.857096 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:36:25.858141 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
18:36:25.858832 [debug] [Thread-6  ]: finished collecting timing info
18:36:25.858941 [debug] [Thread-6  ]: On model.first_project.customers2: Close
18:36:25.859182 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ad5924d-14a8-4fe6-abb8-f8b9ea479024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffc0ecc40>]}
18:36:25.859363 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.07s]
18:36:25.861334 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
18:36:25.862535 [debug] [MainThread]: Acquiring new postgres connection "master"
18:36:25.862642 [debug] [MainThread]: Using postgres connection "master"
18:36:25.862703 [debug] [MainThread]: On master: BEGIN
18:36:25.862761 [debug] [MainThread]: Opening a new connection, currently in state closed
18:36:25.873857 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:36:25.874161 [debug] [MainThread]: On master: COMMIT
18:36:25.874226 [debug] [MainThread]: Using postgres connection "master"
18:36:25.874287 [debug] [MainThread]: On master: COMMIT
18:36:25.876158 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:36:25.876488 [debug] [MainThread]: On master: Close
18:36:25.876872 [info ] [MainThread]: 
18:36:25.877037 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0.26s.
18:36:25.877155 [debug] [MainThread]: Connection 'master' was properly closed.
18:36:25.877205 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:36:25.877279 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:36:25.877346 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:36:25.877393 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:36:25.877439 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:36:25.877484 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:36:25.877529 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:36:25.880351 [info ] [MainThread]: 
18:36:25.880508 [info ] [MainThread]: [32mCompleted successfully[0m
18:36:25.880644 [info ] [MainThread]: 
18:36:25.880743 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:36:25.880905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fffa10250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fffa10670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4002073fa0>]}


============================== 2022-06-07 18:40:37.474230 | 94470e69-cd88-4cd9-9a05-717b9c93b5e4 ==============================
18:40:37.474242 [info ] [MainThread]: Running with dbt=1.1.0
18:40:37.474612 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:40:37.474695 [debug] [MainThread]: Tracking: tracking
18:40:37.477019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dca3aa130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dca3aa580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dca3aa2b0>]}
18:40:37.494963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:40:37.495309 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:40:37.503315 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:40:37.517597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94470e69-cd88-4cd9-9a05-717b9c93b5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc9e110d0>]}
18:40:37.520929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94470e69-cd88-4cd9-9a05-717b9c93b5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dca307f10>]}
18:40:37.521137 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:40:37.521298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94470e69-cd88-4cd9-9a05-717b9c93b5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dca307ee0>]}
18:40:37.522425 [info ] [MainThread]: 
18:40:37.522758 [debug] [MainThread]: Acquiring new postgres connection "master"
18:40:37.523750 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:40:37.530635 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:40:37.530803 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:40:37.530873 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:40:37.539888 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:40:37.540940 [debug] [ThreadPool]: On list_erp_oltp: Close
18:40:37.542285 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:40:37.571684 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:40:37.571813 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:40:37.571869 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:40:37.577107 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:40:37.577309 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:40:37.577385 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:40:37.578770 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:40:37.579651 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:40:37.579944 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:40:37.582620 [debug] [MainThread]: Using postgres connection "master"
18:40:37.582708 [debug] [MainThread]: On master: BEGIN
18:40:37.582765 [debug] [MainThread]: Opening a new connection, currently in state init
18:40:37.588614 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:40:37.588747 [debug] [MainThread]: Using postgres connection "master"
18:40:37.588809 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:40:37.598815 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
18:40:37.599786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94470e69-cd88-4cd9-9a05-717b9c93b5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dca367b20>]}
18:40:37.599988 [debug] [MainThread]: On master: ROLLBACK
18:40:37.600468 [debug] [MainThread]: Using postgres connection "master"
18:40:37.600562 [debug] [MainThread]: On master: BEGIN
18:40:37.601088 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:40:37.601182 [debug] [MainThread]: On master: COMMIT
18:40:37.601243 [debug] [MainThread]: Using postgres connection "master"
18:40:37.601295 [debug] [MainThread]: On master: COMMIT
18:40:37.601571 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:40:37.601669 [debug] [MainThread]: On master: Close
18:40:37.602001 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:40:37.602153 [info ] [MainThread]: 
18:40:37.607045 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:40:37.607234 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:40:37.607553 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:40:37.607658 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:40:37.607731 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:40:37.609161 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:40:37.609398 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:40:37.609575 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:40:37.609744 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:40:37.609920 [info ] [Thread-3  ]: 3 of 7 START table model public.stg_customers .................................. [RUN]
18:40:37.610062 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:40:37.610171 [info ] [Thread-4  ]: 4 of 7 START table model public.stg_orders ..................................... [RUN]
18:40:37.610287 [debug] [Thread-1  ]: finished collecting timing info
18:40:37.610375 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:40:37.620358 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:40:37.620628 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:40:37.620732 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:40:37.622272 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:40:37.622649 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:40:37.622891 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:40:37.623170 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:40:37.642189 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:40:37.642273 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:40:37.639126 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:40:37.644032 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:40:37.643037 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:40:37.644460 [debug] [Thread-4  ]: finished collecting timing info
18:40:37.629648 [debug] [Thread-2  ]: finished collecting timing info
18:40:37.651300 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:40:37.641924 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:40:37.658443 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:40:37.658798 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:40:37.658866 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:40:37.659711 [debug] [Thread-3  ]: finished collecting timing info
18:40:37.659918 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:40:37.644597 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:40:37.662052 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:40:37.669006 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:40:37.670086 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:40:37.670213 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:40:37.670279 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:40:37.670505 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:40:37.669610 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:40:37.670614 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:40:37.671115 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:40:37.670685 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:40:37.671498 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:40:37.671589 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:40:37.671804 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:40:37.671887 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:40:37.671940 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:40:37.673223 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:40:37.677330 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:40:37.677491 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:40:37.677832 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:40:37.679509 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:40:37.679752 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:40:37.680195 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:40:37.685870 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:40:37.686137 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:40:37.686223 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */


  create  table "erp_oltp"."public"."stg_orders__dbt_tmp"
  as (
    with orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
)
select * from orders
  );
18:40:37.687167 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:40:37.687260 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:40:37.687321 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)
select * from customers
  );
18:40:37.686913 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:40:37.687409 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:40:37.687575 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:40:37.687683 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:40:37.687889 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
18:40:37.687786 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:40:37.689348 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:40:37.689461 [debug] [Thread-4  ]: SQL status: SELECT 295 in 0.0 seconds
18:40:37.692454 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:40:37.693973 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:40:37.694443 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:40:37.694235 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.01 seconds
18:40:37.694065 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
18:40:37.696996 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:40:37.695746 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:40:37.697079 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:40:37.697140 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:40:37.694344 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:40:37.697282 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:40:37.703556 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:40:37.704348 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
18:40:37.705652 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:40:37.707121 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:40:37.707519 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:40:37.707198 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:40:37.709117 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:40:37.707628 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:40:37.709208 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:40:37.707280 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:40:37.710070 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:40:37.710214 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:40:37.711744 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:40:37.711033 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:40:37.711981 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:40:37.711841 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:40:37.712113 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:40:37.711903 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:40:37.713129 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:40:37.713215 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:40:37.713271 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:40:37.710884 [debug] [Thread-1  ]: finished collecting timing info
18:40:37.713444 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
18:40:37.713618 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:40:37.716780 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:40:37.716862 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:40:37.715865 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:40:37.713947 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
18:40:37.718915 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:40:37.717477 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop table if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:40:37.719002 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:40:37.713807 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:40:37.719121 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:40:37.719749 [debug] [Thread-2  ]: finished collecting timing info
18:40:37.719862 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:40:37.720192 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94470e69-cd88-4cd9-9a05-717b9c93b5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc9e114f0>]}
18:40:37.720443 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.10s]
18:40:37.720711 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:40:37.720927 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
18:40:37.721512 [debug] [Thread-3  ]: finished collecting timing info
18:40:37.721605 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:40:37.721852 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94470e69-cd88-4cd9-9a05-717b9c93b5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc9e11550>]}
18:40:37.722036 [info ] [Thread-3  ]: 3 of 7 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.10s]
18:40:37.722290 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94470e69-cd88-4cd9-9a05-717b9c93b5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dca307cd0>]}
18:40:37.722440 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
18:40:37.722625 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:40:37.722757 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:40:37.723291 [debug] [Thread-6  ]: Began running node model.first_project.customers2
18:40:37.723415 [info ] [Thread-6  ]: 5 of 7 START table model public.customers2 ..................................... [RUN]
18:40:37.723621 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
18:40:37.723689 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
18:40:37.723766 [debug] [Thread-6  ]: Compiling model.first_project.customers2
18:40:37.725378 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
18:40:37.725517 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
18:40:37.725934 [info ] [Thread-7  ]: 6 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:40:37.726203 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:40:37.726295 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
18:40:37.726367 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
18:40:37.727954 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:40:37.725623 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.01 seconds
18:40:37.728204 [debug] [Thread-6  ]: finished collecting timing info
18:40:37.728368 [debug] [Thread-7  ]: finished collecting timing info
18:40:37.729390 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
18:40:37.729270 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
18:40:37.730693 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:40:37.736947 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:40:37.738827 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: BEGIN
18:40:37.732087 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
18:40:37.738929 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:40:37.739499 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:40:37.739592 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
18:40:37.739664 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:40:37.729091 [debug] [Thread-4  ]: finished collecting timing info
18:40:37.741378 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:40:37.742998 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94470e69-cd88-4cd9-9a05-717b9c93b5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc9e11f40>]}
18:40:37.743286 [info ] [Thread-4  ]: 4 of 7 OK created table model public.stg_orders ................................ [[32mSELECT 295[0m in 0.12s]
18:40:37.743672 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:40:37.744007 [debug] [Thread-9  ]: Began running node model.first_project.customers
18:40:37.744147 [info ] [Thread-9  ]: 7 of 7 START table model public.customers ...................................... [RUN]
18:40:37.744461 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers"
18:40:37.744563 [debug] [Thread-7  ]: SQL status: BEGIN in 0.01 seconds
18:40:37.745483 [debug] [Thread-9  ]: Began compiling node model.first_project.customers
18:40:37.745592 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:40:37.745708 [debug] [Thread-9  ]: Compiling model.first_project.customers
18:40:37.745796 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:40:37.748631 [debug] [Thread-7  ]: SQL status: CREATE VIEW in 0.0 seconds
18:40:37.750214 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:40:37.750335 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:40:37.750700 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
18:40:37.747548 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers"
18:40:37.751725 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: COMMIT
18:40:37.752013 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:40:37.752106 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: COMMIT
18:40:37.752265 [debug] [Thread-9  ]: finished collecting timing info
18:40:37.752448 [debug] [Thread-9  ]: Began executing node model.first_project.customers
18:40:37.754247 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.customers"
18:40:37.754387 [debug] [Thread-7  ]: SQL status: COMMIT in 0.0 seconds
18:40:37.755228 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:40:37.755311 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:40:37.755498 [debug] [Thread-7  ]: SQL status: DROP VIEW in 0.0 seconds
18:40:37.756435 [debug] [Thread-7  ]: finished collecting timing info
18:40:37.756605 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: Close
18:40:37.756731 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
18:40:37.756864 [debug] [Thread-9  ]: On model.first_project.customers: BEGIN
18:40:37.756921 [debug] [Thread-9  ]: Opening a new connection, currently in state init
18:40:37.758065 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94470e69-cd88-4cd9-9a05-717b9c93b5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dca3aab80>]}
18:40:37.758461 [info ] [Thread-7  ]: 6 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
18:40:37.758926 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
18:40:37.759045 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:40:37.759156 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:40:37.759219 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
18:40:37.767149 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.01 seconds
18:40:37.769179 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:40:37.769474 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:40:37.769984 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:40:37.771370 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:40:37.771457 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:40:37.771734 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:40:37.772611 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:40:37.772687 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:40:37.772740 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:40:37.774050 [debug] [Thread-9  ]: SQL status: BEGIN in 0.02 seconds
18:40:37.774230 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
18:40:37.774368 [debug] [Thread-9  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
 customers.state
 WHERE customers.customer_id <> 63
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
18:40:37.775731 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
18:40:37.775942 [debug] [Thread-9  ]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 31:  from customers
          ^

18:40:37.777200 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:40:37.777318 [debug] [Thread-9  ]: On model.first_project.customers: ROLLBACK
18:40:37.777450 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:40:37.777712 [debug] [Thread-9  ]: finished collecting timing info
18:40:37.777902 [debug] [Thread-9  ]: On model.first_project.customers: Close
18:40:37.778143 [debug] [Thread-9  ]: Database Error in model customers (models/erp/customers.sql)
  syntax error at or near "from"
  LINE 31:  from customers
            ^
  compiled SQL at target/run/first_project/models/erp/customers.sql
18:40:37.778304 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94470e69-cd88-4cd9-9a05-717b9c93b5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc849ca30>]}
18:40:37.778539 [error] [Thread-9  ]: 7 of 7 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.03s]
18:40:37.778771 [debug] [Thread-9  ]: Finished running node model.first_project.customers
18:40:37.784220 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.01 seconds
18:40:37.785149 [debug] [Thread-6  ]: finished collecting timing info
18:40:37.785263 [debug] [Thread-6  ]: On model.first_project.customers2: Close
18:40:37.785564 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94470e69-cd88-4cd9-9a05-717b9c93b5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc84e6460>]}
18:40:37.785786 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.06s]
18:40:37.786027 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
18:40:37.787232 [debug] [MainThread]: Acquiring new postgres connection "master"
18:40:37.787341 [debug] [MainThread]: Using postgres connection "master"
18:40:37.787400 [debug] [MainThread]: On master: BEGIN
18:40:37.787474 [debug] [MainThread]: Opening a new connection, currently in state closed
18:40:37.798360 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:40:37.798566 [debug] [MainThread]: On master: COMMIT
18:40:37.798631 [debug] [MainThread]: Using postgres connection "master"
18:40:37.798687 [debug] [MainThread]: On master: COMMIT
18:40:37.798913 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:40:37.799015 [debug] [MainThread]: On master: Close
18:40:37.799331 [info ] [MainThread]: 
18:40:37.799510 [info ] [MainThread]: Finished running 2 view models, 5 table models in 0.28s.
18:40:37.799617 [debug] [MainThread]: Connection 'master' was properly closed.
18:40:37.799668 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:40:37.799715 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:40:37.799762 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:40:37.799808 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:40:37.799853 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:40:37.799899 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:40:37.799943 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:40:37.802804 [info ] [MainThread]: 
18:40:37.802992 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:40:37.803119 [info ] [MainThread]: 
18:40:37.803215 [error] [MainThread]: [33mDatabase Error in model customers (models/erp/customers.sql)[0m
18:40:37.803320 [error] [MainThread]:   syntax error at or near "from"
18:40:37.803411 [error] [MainThread]:   LINE 31:  from customers
18:40:37.803494 [error] [MainThread]:             ^
18:40:37.803643 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/customers.sql
18:40:37.803754 [info ] [MainThread]: 
18:40:37.803849 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
18:40:37.804061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dca3aa790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dca39b160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dcbb9ebb0>]}


============================== 2022-06-07 18:40:51.979491 | 35817a11-1e1a-4dad-a1e1-8080fa2344ac ==============================
18:40:51.979503 [info ] [MainThread]: Running with dbt=1.1.0
18:40:51.979870 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:40:51.979972 [debug] [MainThread]: Tracking: tracking
18:40:51.982254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12bf7b0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12bf7b01f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12bf7b0f10>]}
18:40:52.000391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:40:52.000783 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:40:52.010908 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:40:52.023899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35817a11-1e1a-4dad-a1e1-8080fa2344ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12bf21b0d0>]}
18:40:52.027749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35817a11-1e1a-4dad-a1e1-8080fa2344ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12bf70ef40>]}
18:40:52.028080 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:40:52.028667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35817a11-1e1a-4dad-a1e1-8080fa2344ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12bf70ef70>]}
18:40:52.030140 [info ] [MainThread]: 
18:40:52.030514 [debug] [MainThread]: Acquiring new postgres connection "master"
18:40:52.031401 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:40:52.041228 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:40:52.041453 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:40:52.041524 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:40:52.047711 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:40:52.048670 [debug] [ThreadPool]: On list_erp_oltp: Close
18:40:52.058896 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:40:52.088270 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:40:52.088427 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:40:52.088487 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:40:52.092114 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
18:40:52.092281 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:40:52.092391 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:40:52.093680 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:40:52.094599 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:40:52.095502 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:40:52.098353 [debug] [MainThread]: Using postgres connection "master"
18:40:52.098464 [debug] [MainThread]: On master: BEGIN
18:40:52.098524 [debug] [MainThread]: Opening a new connection, currently in state init
18:40:52.103079 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:40:52.103183 [debug] [MainThread]: Using postgres connection "master"
18:40:52.103244 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:40:52.112743 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
18:40:52.113830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35817a11-1e1a-4dad-a1e1-8080fa2344ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12c197aa30>]}
18:40:52.114027 [debug] [MainThread]: On master: ROLLBACK
18:40:52.114333 [debug] [MainThread]: Using postgres connection "master"
18:40:52.114423 [debug] [MainThread]: On master: BEGIN
18:40:52.115756 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:40:52.115848 [debug] [MainThread]: On master: COMMIT
18:40:52.115910 [debug] [MainThread]: Using postgres connection "master"
18:40:52.115962 [debug] [MainThread]: On master: COMMIT
18:40:52.116236 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:40:52.116362 [debug] [MainThread]: On master: Close
18:40:52.116668 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:40:52.116868 [info ] [MainThread]: 
18:40:52.121399 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:40:52.121583 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:40:52.121840 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:40:52.121941 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:40:52.122015 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:40:52.123334 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:40:52.123553 [debug] [Thread-1  ]: finished collecting timing info
18:40:52.123721 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:40:52.134433 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:40:52.134799 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:40:52.135095 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:40:52.135168 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:40:52.135230 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:40:52.136690 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:40:52.136906 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:40:52.137069 [info ] [Thread-3  ]: 3 of 7 START table model public.stg_customers .................................. [RUN]
18:40:52.137333 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:40:52.137423 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:40:52.137525 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:40:52.137635 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:40:52.152310 [info ] [Thread-4  ]: 4 of 7 START table model public.stg_orders ..................................... [RUN]
18:40:52.152827 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:40:52.152936 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:40:52.153010 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:40:52.138705 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:40:52.160078 [debug] [Thread-3  ]: finished collecting timing info
18:40:52.159687 [debug] [Thread-2  ]: finished collecting timing info
18:40:52.160404 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:40:52.154184 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:40:52.159572 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:40:52.160233 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:40:52.170115 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:40:52.170404 [debug] [Thread-4  ]: finished collecting timing info
18:40:52.172491 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:40:52.172329 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:40:52.171935 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:40:52.177153 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:40:52.177298 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:40:52.177365 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:40:52.174450 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:40:52.177961 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:40:52.178095 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:40:52.178151 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:40:52.175475 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:40:52.178485 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:40:52.178585 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:40:52.176817 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:40:52.178847 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:40:52.182961 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
18:40:52.183107 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:40:52.183172 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)
select * from customers
  );
18:40:52.184130 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:40:52.184244 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:40:52.184320 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
18:40:52.185495 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:40:52.185599 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:40:52.185658 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:40:52.185739 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
18:40:52.195649 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
18:40:52.197825 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:40:52.197960 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:40:52.198148 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:40:52.198199 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */


  create  table "erp_oltp"."public"."stg_orders__dbt_tmp"
  as (
    with orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
)
select * from orders
  );
18:40:52.198057 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:40:52.198448 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:40:52.198527 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:40:52.198656 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:40:52.200002 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:40:52.200087 [debug] [Thread-4  ]: SQL status: SELECT 295 in 0.0 seconds
18:40:52.201270 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:40:52.201346 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:40:52.200153 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:40:52.201465 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:40:52.202518 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:40:52.203094 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.02 seconds
18:40:52.204307 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:40:52.203022 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:40:52.204407 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:40:52.203141 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:40:52.203204 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:40:52.205675 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:40:52.212894 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
18:40:52.214607 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:40:52.214710 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:40:52.213204 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:40:52.215004 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:40:52.212560 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:40:52.216171 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:40:52.216016 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:40:52.216861 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:40:52.216940 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:40:52.215840 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:40:52.216993 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:40:52.216092 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:40:52.218134 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:40:52.217080 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:40:52.218250 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:40:52.218576 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:40:52.218359 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:40:52.216234 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:40:52.219335 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:40:52.222172 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:40:52.222267 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:40:52.222382 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
18:40:52.222481 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
18:40:52.225728 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:40:52.223777 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:40:52.225855 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:40:52.225957 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:40:52.226882 [debug] [Thread-2  ]: finished collecting timing info
18:40:52.227021 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:40:52.226032 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop table if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:40:52.227154 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
18:40:52.228870 [debug] [Thread-3  ]: finished collecting timing info
18:40:52.228999 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:40:52.229301 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35817a11-1e1a-4dad-a1e1-8080fa2344ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12bc11baf0>]}
18:40:52.229516 [info ] [Thread-3  ]: 3 of 7 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.09s]
18:40:52.229739 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:40:52.222547 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:40:52.230778 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:40:52.230868 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:40:52.227504 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35817a11-1e1a-4dad-a1e1-8080fa2344ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12bf19e910>]}
18:40:52.231402 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.09s]
18:40:52.231161 [debug] [Thread-6  ]: Began running node model.first_project.customers2
18:40:52.231611 [info ] [Thread-6  ]: 5 of 7 START table model public.customers2 ..................................... [RUN]
18:40:52.231026 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
18:40:52.231974 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
18:40:52.232879 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
18:40:52.232720 [debug] [Thread-4  ]: finished collecting timing info
18:40:52.232971 [debug] [Thread-6  ]: Compiling model.first_project.customers2
18:40:52.235456 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
18:40:52.235688 [debug] [Thread-6  ]: finished collecting timing info
18:40:52.233186 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:40:52.235815 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
18:40:52.237565 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
18:40:52.237769 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:40:52.236086 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35817a11-1e1a-4dad-a1e1-8080fa2344ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12bf1b3190>]}
18:40:52.237891 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
18:40:52.238241 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:40:52.231781 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:40:52.233080 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:40:52.238137 [info ] [Thread-4  ]: 4 of 7 OK created table model public.stg_orders ................................ [[32mSELECT 295[0m in 0.08s]
18:40:52.239252 [debug] [Thread-1  ]: finished collecting timing info
18:40:52.239517 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:40:52.239909 [debug] [Thread-8  ]: Began running node model.first_project.customers
18:40:52.240041 [info ] [Thread-8  ]: 6 of 7 START table model public.customers ...................................... [RUN]
18:40:52.240257 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
18:40:52.240374 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
18:40:52.240449 [debug] [Thread-8  ]: Compiling model.first_project.customers
18:40:52.241827 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
18:40:52.242041 [debug] [Thread-8  ]: finished collecting timing info
18:40:52.242170 [debug] [Thread-8  ]: Began executing node model.first_project.customers
18:40:52.243540 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
18:40:52.243768 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:40:52.243849 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
18:40:52.243903 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:40:52.239629 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:40:52.244514 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35817a11-1e1a-4dad-a1e1-8080fa2344ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12bf1caac0>]}
18:40:52.244766 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.12s]
18:40:52.244966 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:40:52.245705 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
18:40:52.245832 [info ] [Thread-10 ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:40:52.246036 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:40:52.246101 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
18:40:52.246158 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
18:40:52.247430 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:40:52.247643 [debug] [Thread-10 ]: finished collecting timing info
18:40:52.247800 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
18:40:52.249062 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:40:52.249269 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:40:52.249380 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: BEGIN
18:40:52.249440 [debug] [Thread-10 ]: Opening a new connection, currently in state init
18:40:52.250243 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
18:40:52.250717 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:40:52.255587 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
18:40:52.258264 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
18:40:52.259908 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:40:52.260016 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:40:52.260349 [debug] [Thread-10 ]: SQL status: BEGIN in 0.01 seconds
18:40:52.260486 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:40:52.260546 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:40:52.261585 [debug] [Thread-10 ]: SQL status: CREATE VIEW in 0.0 seconds
18:40:52.263458 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:40:52.263580 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:40:52.265229 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.01 seconds
18:40:52.266684 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:40:52.266786 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:40:52.266886 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
18:40:52.267679 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
18:40:52.267764 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:40:52.267827 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
18:40:52.273938 [debug] [Thread-10 ]: SQL status: COMMIT in 0.01 seconds
18:40:52.280828 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:40:52.281022 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:40:52.281160 [debug] [Thread-8  ]: SQL status: BEGIN in 0.04 seconds
18:40:52.281493 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:40:52.281571 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
 customers.state
 WHERE customers.customer_id != 63
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
18:40:52.281265 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.01 seconds
18:40:52.281662 [debug] [Thread-10 ]: SQL status: DROP VIEW in 0.0 seconds
18:40:52.282935 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:40:52.283089 [debug] [Thread-8  ]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 31:  from customers
          ^

18:40:52.283842 [debug] [Thread-10 ]: finished collecting timing info
18:40:52.284153 [debug] [Thread-8  ]: On model.first_project.customers: ROLLBACK
18:40:52.284587 [debug] [Thread-8  ]: finished collecting timing info
18:40:52.284687 [debug] [Thread-8  ]: On model.first_project.customers: Close
18:40:52.284900 [debug] [Thread-8  ]: Database Error in model customers (models/erp/customers.sql)
  syntax error at or near "from"
  LINE 31:  from customers
            ^
  compiled SQL at target/run/first_project/models/erp/customers.sql
18:40:52.285046 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35817a11-1e1a-4dad-a1e1-8080fa2344ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12bc158b50>]}
18:40:52.285230 [error] [Thread-8  ]: 6 of 7 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.04s]
18:40:52.284284 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: Close
18:40:52.285439 [debug] [Thread-8  ]: Finished running node model.first_project.customers
18:40:52.284062 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:40:52.286691 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:40:52.286984 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35817a11-1e1a-4dad-a1e1-8080fa2344ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12c191c760>]}
18:40:52.287275 [info ] [Thread-10 ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
18:40:52.287538 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
18:40:52.288123 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
18:40:52.291884 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:40:52.292204 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:40:52.293839 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
18:40:52.294785 [debug] [Thread-6  ]: finished collecting timing info
18:40:52.294914 [debug] [Thread-6  ]: On model.first_project.customers2: Close
18:40:52.295798 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35817a11-1e1a-4dad-a1e1-8080fa2344ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12bc107a00>]}
18:40:52.296037 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.06s]
18:40:52.296265 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
18:40:52.297934 [debug] [MainThread]: Acquiring new postgres connection "master"
18:40:52.298043 [debug] [MainThread]: Using postgres connection "master"
18:40:52.298101 [debug] [MainThread]: On master: BEGIN
18:40:52.298154 [debug] [MainThread]: Opening a new connection, currently in state closed
18:40:52.314544 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:40:52.314759 [debug] [MainThread]: On master: COMMIT
18:40:52.314823 [debug] [MainThread]: Using postgres connection "master"
18:40:52.314878 [debug] [MainThread]: On master: COMMIT
18:40:52.315540 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:40:52.315646 [debug] [MainThread]: On master: Close
18:40:52.316006 [info ] [MainThread]: 
18:40:52.316148 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0.29s.
18:40:52.316250 [debug] [MainThread]: Connection 'master' was properly closed.
18:40:52.316369 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:40:52.316419 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:40:52.316465 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:40:52.316510 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:40:52.316555 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:40:52.316600 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:40:52.316645 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:40:52.320920 [info ] [MainThread]: 
18:40:52.321157 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:40:52.321283 [info ] [MainThread]: 
18:40:52.321377 [error] [MainThread]: [33mDatabase Error in model customers (models/erp/customers.sql)[0m
18:40:52.321469 [error] [MainThread]:   syntax error at or near "from"
18:40:52.321554 [error] [MainThread]:   LINE 31:  from customers
18:40:52.321639 [error] [MainThread]:             ^
18:40:52.321720 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/customers.sql
18:40:52.321835 [info ] [MainThread]: 
18:40:52.321935 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
18:40:52.322989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12bf70e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12bf7a6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12c191c760>]}


============================== 2022-06-07 18:41:42.930297 | b2c8b9a1-1e09-447f-bf87-a2d5a67655af ==============================
18:41:42.930309 [info ] [MainThread]: Running with dbt=1.1.0
18:41:42.930719 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:41:42.930810 [debug] [MainThread]: Tracking: tracking
18:41:42.933215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e3a8a3b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e3a8a3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e3a8a3eb0>]}
18:41:42.953884 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:41:42.954192 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:41:42.978462 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:41:42.990163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2c8b9a1-1e09-447f-bf87-a2d5a67655af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e3a3060d0>]}
18:41:42.993521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2c8b9a1-1e09-447f-bf87-a2d5a67655af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e3a7feee0>]}
18:41:42.993765 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:41:42.993924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2c8b9a1-1e09-447f-bf87-a2d5a67655af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e3a7feeb0>]}
18:41:42.994958 [info ] [MainThread]: 
18:41:42.995243 [debug] [MainThread]: Acquiring new postgres connection "master"
18:41:42.996061 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:41:43.002341 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:41:43.002462 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:41:43.002523 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:41:43.010009 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:41:43.016569 [debug] [ThreadPool]: On list_erp_oltp: Close
18:41:43.017975 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:41:43.057266 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:41:43.057409 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:41:43.057464 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:41:43.061834 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
18:41:43.061981 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:41:43.062040 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:41:43.063467 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:41:43.064340 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:41:43.065476 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:41:43.068113 [debug] [MainThread]: Using postgres connection "master"
18:41:43.068198 [debug] [MainThread]: On master: BEGIN
18:41:43.068253 [debug] [MainThread]: Opening a new connection, currently in state init
18:41:43.071886 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:41:43.072015 [debug] [MainThread]: Using postgres connection "master"
18:41:43.072075 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:41:43.080918 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
18:41:43.081752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2c8b9a1-1e09-447f-bf87-a2d5a67655af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e3a85d730>]}
18:41:43.081955 [debug] [MainThread]: On master: ROLLBACK
18:41:43.082108 [debug] [MainThread]: Using postgres connection "master"
18:41:43.082208 [debug] [MainThread]: On master: BEGIN
18:41:43.082399 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:41:43.082498 [debug] [MainThread]: On master: COMMIT
18:41:43.082571 [debug] [MainThread]: Using postgres connection "master"
18:41:43.082626 [debug] [MainThread]: On master: COMMIT
18:41:43.082733 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:41:43.082813 [debug] [MainThread]: On master: Close
18:41:43.083061 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:41:43.083249 [info ] [MainThread]: 
18:41:43.087289 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:41:43.087537 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:41:43.087782 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:41:43.087856 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:41:43.087923 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:41:43.089554 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:41:43.089796 [debug] [Thread-1  ]: finished collecting timing info
18:41:43.089925 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:41:43.096978 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:41:43.097174 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:41:43.097451 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:41:43.097542 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:41:43.097606 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:41:43.098857 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:41:43.099089 [debug] [Thread-2  ]: finished collecting timing info
18:41:43.099222 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:41:43.112421 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:41:43.112698 [info ] [Thread-3  ]: 3 of 7 START table model public.stg_customers .................................. [RUN]
18:41:43.112977 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:41:43.113059 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:41:43.113127 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:41:43.113820 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:41:43.129351 [debug] [Thread-3  ]: finished collecting timing info
18:41:43.129571 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:41:43.134396 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:41:43.134753 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:41:43.134917 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:41:43.134998 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:41:43.137442 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:41:43.137801 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:41:43.138616 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:41:43.141064 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:41:43.141202 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:41:43.141266 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:41:43.140577 [info ] [Thread-4  ]: 4 of 7 START table model public.stg_orders ..................................... [RUN]
18:41:43.141735 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:41:43.141830 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:41:43.141928 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:41:43.143496 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:41:43.143812 [debug] [Thread-4  ]: finished collecting timing info
18:41:43.143981 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:41:43.145506 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:41:43.145774 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:41:43.145890 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:41:43.145946 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:41:43.147326 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:41:43.147523 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:41:43.147590 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:41:43.148782 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:41:43.154022 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:41:43.154268 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:41:43.154758 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:41:43.154912 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:41:43.154969 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:41:43.155513 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:41:43.155616 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:41:43.155668 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)
select * from customers
  );
18:41:43.156160 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:41:43.157753 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:41:43.157863 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:41:43.157964 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.0 seconds
18:41:43.159337 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:41:43.159436 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:41:43.159688 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:41:43.159777 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:41:43.159844 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */


  create  table "erp_oltp"."public"."stg_orders__dbt_tmp"
  as (
    with orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
)
select * from orders
  );
18:41:43.164464 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:41:43.166027 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:41:43.166154 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:41:43.166666 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
18:41:43.179713 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:41:43.179921 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:41:43.180024 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
18:41:43.180205 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:41:43.180376 [debug] [Thread-4  ]: SQL status: SELECT 295 in 0.02 seconds
18:41:43.181964 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:41:43.180530 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:41:43.182063 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:41:43.180456 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
18:41:43.182150 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:41:43.183337 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:41:43.184754 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:41:43.184847 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:41:43.183046 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:41:43.185084 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:41:43.185151 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:41:43.185322 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:41:43.186338 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:41:43.186438 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
18:41:43.187917 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:41:43.187998 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:41:43.186509 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
18:41:43.186643 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:41:43.191345 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:41:43.191507 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:41:43.199145 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:41:43.198880 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:41:43.201017 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:41:43.200770 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:41:43.201589 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:41:43.186572 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:41:43.201854 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:41:43.202268 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:41:43.203111 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:41:43.203255 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:41:43.203457 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:41:43.204242 [debug] [Thread-1  ]: finished collecting timing info
18:41:43.206091 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
18:41:43.206232 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.01 seconds
18:41:43.206411 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:41:43.206595 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:41:43.207642 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:41:43.208827 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop table if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:41:43.208590 [debug] [Thread-3  ]: finished collecting timing info
18:41:43.210153 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
18:41:43.210320 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:41:43.211474 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2c8b9a1-1e09-447f-bf87-a2d5a67655af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e3a2cac40>]}
18:41:43.211700 [info ] [Thread-3  ]: 3 of 7 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.10s]
18:41:43.211973 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:41:43.211076 [debug] [Thread-4  ]: finished collecting timing info
18:41:43.212638 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2c8b9a1-1e09-447f-bf87-a2d5a67655af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e3a2ce430>]}
18:41:43.212723 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:41:43.212991 [debug] [Thread-6  ]: Began running node model.first_project.customers2
18:41:43.213102 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:41:43.213318 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.12s]
18:41:43.214645 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:41:43.214389 [info ] [Thread-6  ]: 5 of 7 START table model public.customers2 ..................................... [RUN]
18:41:43.214895 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
18:41:43.214962 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
18:41:43.215026 [debug] [Thread-6  ]: Compiling model.first_project.customers2
18:41:43.214201 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:41:43.219153 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
18:41:43.219528 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
18:41:43.219642 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:41:43.219890 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2c8b9a1-1e09-447f-bf87-a2d5a67655af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e3a2ca850>]}
18:41:43.220108 [info ] [Thread-8  ]: 6 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:41:43.220489 [info ] [Thread-4  ]: 4 of 7 OK created table model public.stg_orders ................................ [[32mSELECT 295[0m in 0.08s]
18:41:43.220830 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:41:43.221022 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
18:41:43.221105 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
18:41:43.222483 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:41:43.222656 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:41:43.223182 [debug] [Thread-6  ]: finished collecting timing info
18:41:43.223468 [debug] [Thread-10 ]: Began running node model.first_project.customers
18:41:43.223946 [info ] [Thread-10 ]: 7 of 7 START table model public.customers ...................................... [RUN]
18:41:43.224212 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
18:41:43.224306 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
18:41:43.224371 [debug] [Thread-10 ]: Compiling model.first_project.customers
18:41:43.225916 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
18:41:43.223598 [debug] [Thread-8  ]: finished collecting timing info
18:41:43.226332 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
18:41:43.226065 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
18:41:43.226213 [debug] [Thread-10 ]: finished collecting timing info
18:41:43.229003 [debug] [Thread-10 ]: Began executing node model.first_project.customers
18:41:43.230374 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.customers"
18:41:43.228786 [debug] [Thread-2  ]: finished collecting timing info
18:41:43.230691 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:41:43.227996 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:41:43.231163 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:41:43.231250 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
18:41:43.231310 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:41:43.223806 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
18:41:43.230875 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:41:43.233016 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
18:41:43.233452 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2c8b9a1-1e09-447f-bf87-a2d5a67655af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e3a2d9a60>]}
18:41:43.233566 [debug] [Thread-10 ]: On model.first_project.customers: BEGIN
18:41:43.233802 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:41:43.239459 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
18:41:43.234172 [debug] [Thread-10 ]: Opening a new connection, currently in state init
18:41:43.239611 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:41:43.234063 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.14s]
18:41:43.243040 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:41:43.248435 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
18:41:43.248804 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:41:43.248928 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:41:43.250265 [debug] [Thread-10 ]: SQL status: BEGIN in 0.02 seconds
18:41:43.250433 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:41:43.250503 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
 customers.state
 from customers
 left join customer_orders using (customer_id)
 WHERE customers.customer_id != 63
)
select * from final
  );
18:41:43.250604 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
18:41:43.252556 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:41:43.252678 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:41:43.252827 [debug] [Thread-10 ]: SQL status: SELECT 98 in 0.0 seconds
18:41:43.254069 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:41:43.254147 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
18:41:43.254525 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
18:41:43.255657 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:41:43.255772 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:41:43.255961 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:41:43.257069 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:41:43.257455 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:41:43.257557 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:41:43.257790 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
18:41:43.259025 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
18:41:43.259131 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:41:43.259254 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
18:41:43.259387 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
18:41:43.271167 [debug] [Thread-10 ]: SQL status: COMMIT in 0.01 seconds
18:41:43.273049 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:41:43.273316 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
18:41:43.273449 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:41:43.273580 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:41:43.273738 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
18:41:43.276397 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
18:41:43.278132 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:41:43.278264 [debug] [Thread-10 ]: SQL status: DROP TABLE in 0.0 seconds
18:41:43.279510 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:41:43.280261 [debug] [Thread-10 ]: finished collecting timing info
18:41:43.280552 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:41:43.280714 [debug] [Thread-10 ]: On model.first_project.customers: Close
18:41:43.280802 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:41:43.282112 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:41:43.282196 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:41:43.280900 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:41:43.282456 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2c8b9a1-1e09-447f-bf87-a2d5a67655af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e3a2792e0>]}
18:41:43.282853 [info ] [Thread-10 ]: 7 of 7 OK created table model public.customers ................................. [[32mSELECT 98[0m in 0.06s]
18:41:43.283124 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
18:41:43.283225 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:41:43.283440 [debug] [Thread-10 ]: Finished running node model.first_project.customers
18:41:43.285824 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:41:43.286037 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:41:43.286102 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:41:43.284094 [debug] [Thread-8  ]: finished collecting timing info
18:41:43.286208 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
18:41:43.286533 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2c8b9a1-1e09-447f-bf87-a2d5a67655af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e38236940>]}
18:41:43.286728 [info ] [Thread-8  ]: 6 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
18:41:43.286973 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
18:41:43.287711 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
18:41:43.288687 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:41:43.288775 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:41:43.290164 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
18:41:43.291083 [debug] [Thread-6  ]: finished collecting timing info
18:41:43.291333 [debug] [Thread-6  ]: On model.first_project.customers2: Close
18:41:43.291735 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2c8b9a1-1e09-447f-bf87-a2d5a67655af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e381db6a0>]}
18:41:43.291952 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.08s]
18:41:43.292221 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
18:41:43.302508 [debug] [MainThread]: Acquiring new postgres connection "master"
18:41:43.302731 [debug] [MainThread]: Using postgres connection "master"
18:41:43.302801 [debug] [MainThread]: On master: BEGIN
18:41:43.302858 [debug] [MainThread]: Opening a new connection, currently in state closed
18:41:43.311701 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:41:43.311939 [debug] [MainThread]: On master: COMMIT
18:41:43.312009 [debug] [MainThread]: Using postgres connection "master"
18:41:43.312095 [debug] [MainThread]: On master: COMMIT
18:41:43.312225 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:41:43.312317 [debug] [MainThread]: On master: Close
18:41:43.312692 [info ] [MainThread]: 
18:41:43.312848 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0.32s.
18:41:43.312973 [debug] [MainThread]: Connection 'master' was properly closed.
18:41:43.313037 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:41:43.313097 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:41:43.313144 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:41:43.313188 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:41:43.313232 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:41:43.313275 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:41:43.313319 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:41:43.317711 [info ] [MainThread]: 
18:41:43.317912 [info ] [MainThread]: [32mCompleted successfully[0m
18:41:43.318091 [info ] [MainThread]: 
18:41:43.318195 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:41:43.318348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e3c095610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e3c0959d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e3c095760>]}


============================== 2022-06-07 18:42:27.440846 | 09dfd684-e48c-4e8c-b8e4-6782f23a2fad ==============================
18:42:27.440858 [info ] [MainThread]: Running with dbt=1.1.0
18:42:27.441267 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:42:27.441363 [debug] [MainThread]: Tracking: tracking
18:42:27.443612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b9553bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b9553be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b9553b6d0>]}
18:42:27.462299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:42:27.462480 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:42:27.466460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09dfd684-e48c-4e8c-b8e4-6782f23a2fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b953e20d0>]}
18:42:27.472768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09dfd684-e48c-4e8c-b8e4-6782f23a2fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b95434130>]}
18:42:27.473069 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:42:27.473229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09dfd684-e48c-4e8c-b8e4-6782f23a2fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b954341c0>]}
18:42:27.474361 [info ] [MainThread]: 
18:42:27.474862 [debug] [MainThread]: Acquiring new postgres connection "master"
18:42:27.480244 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:42:27.487747 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:42:27.487940 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:42:27.488006 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:42:27.493189 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:42:27.493368 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:42:27.493430 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:42:27.495658 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:42:27.496735 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:42:27.497092 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:42:27.503842 [debug] [MainThread]: Using postgres connection "master"
18:42:27.503989 [debug] [MainThread]: On master: BEGIN
18:42:27.504046 [debug] [MainThread]: Opening a new connection, currently in state init
18:42:27.513898 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:42:27.514080 [debug] [MainThread]: Using postgres connection "master"
18:42:27.514147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:42:27.524406 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
18:42:27.525405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09dfd684-e48c-4e8c-b8e4-6782f23a2fad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b9549bdf0>]}
18:42:27.525661 [debug] [MainThread]: On master: ROLLBACK
18:42:27.526049 [debug] [MainThread]: Using postgres connection "master"
18:42:27.526165 [debug] [MainThread]: On master: BEGIN
18:42:27.526623 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:42:27.526719 [debug] [MainThread]: On master: COMMIT
18:42:27.526780 [debug] [MainThread]: Using postgres connection "master"
18:42:27.526833 [debug] [MainThread]: On master: COMMIT
18:42:27.527119 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:42:27.527222 [debug] [MainThread]: On master: Close
18:42:27.527570 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:42:27.528260 [info ] [MainThread]: 
18:42:27.541159 [debug] [Thread-1  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:42:27.541375 [info ] [Thread-1  ]: 1 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:42:27.541730 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:42:27.541839 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:42:27.541913 [debug] [Thread-1  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:42:27.549434 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:42:27.549625 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:42:27.549782 [debug] [Thread-3  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:42:27.550305 [info ] [Thread-3  ]: 3 of 5 START test relationships_stg_orders_customer_id__customer_id__ref_customers_  [RUN]
18:42:27.550787 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:42:27.550868 [debug] [Thread-3  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:42:27.550099 [info ] [Thread-2  ]: 2 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:42:27.551274 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:42:27.550931 [debug] [Thread-3  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:42:27.549931 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:42:27.557950 [info ] [Thread-5  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
18:42:27.551355 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:42:27.558444 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:42:27.549869 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:42:27.558268 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:42:27.590970 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:42:27.550428 [debug] [Thread-1  ]: finished collecting timing info
18:42:27.591189 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:42:27.588324 [info ] [Thread-4  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
18:42:27.591065 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:42:27.557747 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:42:27.602116 [debug] [Thread-3  ]: finished collecting timing info
18:42:27.598114 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:42:27.601771 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:42:27.604755 [debug] [Thread-5  ]: finished collecting timing info
18:42:27.604857 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:42:27.602215 [debug] [Thread-3  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:42:27.604436 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:42:27.607065 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:42:27.590739 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:42:27.610785 [debug] [Thread-2  ]: finished collecting timing info
18:42:27.610906 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:42:27.606963 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:42:27.610430 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:42:27.611761 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:42:27.612271 [debug] [Thread-4  ]: finished collecting timing info
18:42:27.612451 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:42:27.611963 [debug] [Thread-3  ]: Using postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:42:27.613252 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:42:27.613689 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:42:27.613830 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:42:27.613891 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:42:27.613435 [debug] [Thread-3  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: BEGIN
18:42:27.605967 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:42:27.603506 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:42:27.614080 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:42:27.621043 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:42:27.621244 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:42:27.621303 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:42:27.622002 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:42:27.622169 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:42:27.622313 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:42:27.622999 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:42:27.623123 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:42:27.623189 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:42:27.634983 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
18:42:27.635220 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:42:27.635322 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:42:27.635815 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:42:27.635927 [debug] [Thread-3  ]: Using postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:42:27.635984 [debug] [Thread-3  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "erp_oltp"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "erp_oltp"."public"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
18:42:27.637609 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:42:27.639247 [debug] [Thread-3  ]: finished collecting timing info
18:42:27.639419 [debug] [Thread-3  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: ROLLBACK
18:42:27.640276 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
18:42:27.641192 [debug] [Thread-5  ]: finished collecting timing info
18:42:27.641300 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:42:27.641413 [debug] [Thread-3  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: Close
18:42:27.641696 [error] [Thread-3  ]: 3 of 5 FAIL 20 relationships_stg_orders_customer_id__customer_id__ref_customers_  [[31mFAIL 20[0m in 0.09s]
18:42:27.641982 [debug] [Thread-3  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:42:27.642191 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:42:27.642422 [info ] [Thread-5  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.08s]
18:42:27.642575 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:42:27.642641 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:42:27.642699 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:42:27.642842 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:42:27.643389 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:42:27.644190 [debug] [Thread-2  ]: finished collecting timing info
18:42:27.644287 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:42:27.644501 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:42:27.644814 [info ] [Thread-2  ]: 2 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.09s]
18:42:27.645036 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:42:27.645878 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:42:27.646002 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:42:27.646065 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:42:27.646272 [debug] [Thread-4  ]: SQL status: BEGIN in 0.03 seconds
18:42:27.646356 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:42:27.646410 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:42:27.647033 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:42:27.647950 [debug] [Thread-4  ]: finished collecting timing info
18:42:27.648050 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:42:27.648141 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:42:27.648972 [debug] [Thread-1  ]: finished collecting timing info
18:42:27.649092 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:42:27.649198 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:42:27.649535 [info ] [Thread-4  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.05s]
18:42:27.649878 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:42:27.650080 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:42:27.650461 [error] [Thread-1  ]: 1 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.11s]
18:42:27.650808 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:42:27.652150 [debug] [MainThread]: Acquiring new postgres connection "master"
18:42:27.654259 [debug] [MainThread]: Using postgres connection "master"
18:42:27.654370 [debug] [MainThread]: On master: BEGIN
18:42:27.654445 [debug] [MainThread]: Opening a new connection, currently in state closed
18:42:27.660825 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:42:27.661039 [debug] [MainThread]: On master: COMMIT
18:42:27.661115 [debug] [MainThread]: Using postgres connection "master"
18:42:27.661168 [debug] [MainThread]: On master: COMMIT
18:42:27.661276 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:42:27.661366 [debug] [MainThread]: On master: Close
18:42:27.661735 [info ] [MainThread]: 
18:42:27.661877 [info ] [MainThread]: Finished running 5 tests in 0.19s.
18:42:27.661973 [debug] [MainThread]: Connection 'master' was properly closed.
18:42:27.662021 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:42:27.662067 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
18:42:27.662111 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:42:27.662154 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:42:27.662197 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:42:27.665892 [info ] [MainThread]: 
18:42:27.666121 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
18:42:27.666279 [info ] [MainThread]: 
18:42:27.666421 [error] [MainThread]: [31mFailure in test relationships_stg_orders_customer_id__customer_id__ref_customers_ (models/erp/schema.yml)[0m
18:42:27.666537 [error] [MainThread]:   Got 20 results, configured to fail if != 0
18:42:27.666631 [info ] [MainThread]: 
18:42:27.666732 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/relationships_stg_orders_ea624a80826c8a7f9bd15b85fd5d6316.sql
18:42:27.666827 [info ] [MainThread]: 
18:42:27.666917 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:42:27.667018 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:42:27.667106 [info ] [MainThread]: 
18:42:27.667198 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:42:27.667319 [info ] [MainThread]: 
18:42:27.667416 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
18:42:27.667585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b95375d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b9552d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b942cf430>]}


============================== 2022-06-07 20:36:35.084069 | 8a6e1c1e-3f83-4732-b59e-331703248ff0 ==============================
20:36:35.084081 [info ] [MainThread]: Running with dbt=1.1.0
20:36:35.085389 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:36:35.085473 [debug] [MainThread]: Tracking: tracking
20:36:35.087680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fe0b6220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fe0b6130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fe0b6820>]}
20:36:35.101043 [info ] [MainThread]: Unable to do partial parsing because profile has changed
20:36:35.101282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8a6e1c1e-3f83-4732-b59e-331703248ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fe0adb80>]}
20:36:35.116445 [debug] [MainThread]: Parsing macros/catalog.sql
20:36:35.118411 [debug] [MainThread]: Parsing macros/relations.sql
20:36:35.119306 [debug] [MainThread]: Parsing macros/adapters.sql
20:36:35.139687 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
20:36:35.141137 [debug] [MainThread]: Parsing macros/materializations/configs.sql
20:36:35.142483 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
20:36:35.144766 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
20:36:35.151786 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
20:36:35.161303 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
20:36:35.171267 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
20:36:35.173819 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
20:36:35.174683 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
20:36:35.175450 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
20:36:35.176851 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
20:36:35.178373 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
20:36:35.183312 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
20:36:35.187502 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
20:36:35.189168 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
20:36:35.199218 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
20:36:35.203540 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
20:36:35.204558 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
20:36:35.207075 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
20:36:35.208143 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
20:36:35.216158 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
20:36:35.226451 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
20:36:35.231883 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
20:36:35.232760 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
20:36:35.234050 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
20:36:35.234835 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
20:36:35.235630 [debug] [MainThread]: Parsing macros/adapters/columns.sql
20:36:35.240526 [debug] [MainThread]: Parsing macros/adapters/relation.sql
20:36:35.245369 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
20:36:35.247069 [debug] [MainThread]: Parsing macros/adapters/schema.sql
20:36:35.248430 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
20:36:35.249885 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
20:36:35.253671 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
20:36:35.256203 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
20:36:35.256686 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
20:36:35.257152 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
20:36:35.257537 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
20:36:35.258326 [debug] [MainThread]: Parsing macros/etc/datetime.sql
20:36:35.262841 [debug] [MainThread]: Parsing macros/etc/statement.sql
20:36:35.265389 [debug] [MainThread]: Parsing tests/generic/builtin.sql
20:36:35.392279 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers2.sql
20:36:35.399706 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
20:36:35.401074 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
20:36:35.402717 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
20:36:35.404163 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
20:36:35.405604 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
20:36:35.406954 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
20:36:35.460078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a6e1c1e-3f83-4732-b59e-331703248ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fff1a340>]}
20:36:35.463461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a6e1c1e-3f83-4732-b59e-331703248ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fdb6f7f0>]}
20:36:35.463756 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
20:36:35.463913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a6e1c1e-3f83-4732-b59e-331703248ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fdb6f7c0>]}
20:36:35.464920 [info ] [MainThread]: 
20:36:35.465244 [debug] [MainThread]: Acquiring new postgres connection "master"
20:36:35.466096 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
20:36:35.472747 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
20:36:35.472833 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
20:36:35.472890 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:36:35.484812 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
20:36:35.485744 [debug] [ThreadPool]: On list_erp_oltp: Close
20:36:35.486995 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
20:36:35.491247 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:36:35.491379 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
20:36:35.491438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:36:35.496451 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:36:35.496629 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:36:35.496692 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:36:35.507849 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.01 seconds
20:36:35.508903 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
20:36:35.509358 [debug] [ThreadPool]: On list_erp_oltp_public: Close
20:36:35.513570 [debug] [MainThread]: Using postgres connection "master"
20:36:35.513751 [debug] [MainThread]: On master: BEGIN
20:36:35.513815 [debug] [MainThread]: Opening a new connection, currently in state init
20:36:35.518978 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:36:35.519146 [debug] [MainThread]: Using postgres connection "master"
20:36:35.519242 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:36:35.530027 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
20:36:35.531015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a6e1c1e-3f83-4732-b59e-331703248ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fdb44340>]}
20:36:35.531254 [debug] [MainThread]: On master: ROLLBACK
20:36:35.531635 [debug] [MainThread]: Using postgres connection "master"
20:36:35.531742 [debug] [MainThread]: On master: BEGIN
20:36:35.532216 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:36:35.532310 [debug] [MainThread]: On master: COMMIT
20:36:35.532370 [debug] [MainThread]: Using postgres connection "master"
20:36:35.532421 [debug] [MainThread]: On master: COMMIT
20:36:35.532699 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:36:35.532809 [debug] [MainThread]: On master: Close
20:36:35.533108 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:36:35.533300 [info ] [MainThread]: 
20:36:35.536333 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
20:36:35.536515 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
20:36:35.536768 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
20:36:35.536855 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
20:36:35.536924 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
20:36:35.538289 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
20:36:35.538478 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
20:36:35.538603 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
20:36:35.538883 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
20:36:35.538985 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
20:36:35.539105 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
20:36:35.539514 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
20:36:35.539385 [info ] [Thread-3  ]: 3 of 7 START table model public.stg_customers .................................. [RUN]
20:36:35.539183 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
20:36:35.541168 [info ] [Thread-4  ]: 4 of 7 START table model public.stg_orders ..................................... [RUN]
20:36:35.541025 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
20:36:35.540757 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
20:36:35.541394 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
20:36:35.541505 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
20:36:35.541683 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
20:36:35.541786 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
20:36:35.541930 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
20:36:35.542597 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
20:36:35.542758 [debug] [Thread-2  ]: finished collecting timing info
20:36:35.544655 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
20:36:35.543399 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
20:36:35.543556 [debug] [Thread-1  ]: finished collecting timing info
20:36:35.551126 [debug] [Thread-3  ]: finished collecting timing info
20:36:35.562537 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
20:36:35.551384 [debug] [Thread-4  ]: finished collecting timing info
20:36:35.568288 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
20:36:35.551530 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
20:36:35.604171 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
20:36:35.605478 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
20:36:35.606368 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
20:36:35.607978 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
20:36:35.609337 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:36:35.609448 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
20:36:35.610447 [debug] [Thread-2  ]: Opening a new connection, currently in state init
20:36:35.610735 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:36:35.611260 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
20:36:35.611339 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:36:35.611575 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:36:35.611650 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
20:36:35.611699 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:36:35.612327 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:36:35.612430 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
20:36:35.612488 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:36:35.614793 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
20:36:35.614914 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:36:35.614977 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
20:36:35.617442 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
20:36:35.617566 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:36:35.617624 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)
select * from customers
  );
20:36:35.618326 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
20:36:35.618462 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:36:35.618526 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */


  create  table "erp_oltp"."public"."stg_orders__dbt_tmp"
  as (
    with orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
)
select * from orders
  );
20:36:35.621645 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:36:35.621762 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:36:35.621835 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:36:35.624766 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.01 seconds
20:36:35.628576 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:36:35.628693 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
20:36:35.628794 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
20:36:35.630119 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:36:35.630210 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
20:36:35.630372 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
20:36:35.631489 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:36:35.631586 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:36:35.631685 [debug] [Thread-4  ]: SQL status: SELECT 295 in 0.01 seconds
20:36:35.631785 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
20:36:35.632912 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:36:35.634488 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
20:36:35.634107 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:36:35.634240 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:36:35.633020 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
20:36:35.635680 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:36:35.636999 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:36:35.636753 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:36:35.637131 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
20:36:35.634643 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
20:36:35.636847 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
20:36:35.638186 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:36:35.638273 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
20:36:35.638366 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
20:36:35.643840 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
20:36:35.643997 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
20:36:35.646220 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:36:35.644582 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
20:36:35.647060 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
20:36:35.646326 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:36:35.647224 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:36:35.647141 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:36:35.644475 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
20:36:35.647330 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
20:36:35.645430 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
20:36:35.647415 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:36:35.647537 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:36:35.647801 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
20:36:35.647904 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
20:36:35.648919 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:36:35.652336 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:36:35.652452 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
20:36:35.652562 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
20:36:35.652666 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
20:36:35.653498 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:36:35.654468 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
20:36:35.654329 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:36:35.654583 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
20:36:35.653592 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
20:36:35.656824 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:36:35.656946 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:36:35.657969 [debug] [Thread-1  ]: finished collecting timing info
20:36:35.657155 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
20:36:35.658742 [debug] [Thread-2  ]: finished collecting timing info
20:36:35.658091 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
20:36:35.659197 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a6e1c1e-3f83-4732-b59e-331703248ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53ffe24df0>]}
20:36:35.658886 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
20:36:35.660649 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a6e1c1e-3f83-4732-b59e-331703248ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fc214b50>]}
20:36:35.659441 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.12s]
20:36:35.661232 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
20:36:35.657026 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
20:36:35.661912 [debug] [Thread-3  ]: finished collecting timing info
20:36:35.662090 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
20:36:35.662392 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
20:36:35.662616 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
20:36:35.662194 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
20:36:35.662689 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
20:36:35.662817 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
20:36:35.664104 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
20:36:35.664567 [debug] [Thread-6  ]: finished collecting timing info
20:36:35.664694 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
20:36:35.664343 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a6e1c1e-3f83-4732-b59e-331703248ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fd266af0>]}
20:36:35.665992 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
20:36:35.666512 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:36:35.666594 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
20:36:35.666262 [info ] [Thread-3  ]: 3 of 7 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.12s]
20:36:35.666652 [debug] [Thread-6  ]: Opening a new connection, currently in state init
20:36:35.657236 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop table if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
20:36:35.660844 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.12s]
20:36:35.666977 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
20:36:35.668040 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
20:36:35.668364 [debug] [Thread-8  ]: Began running node model.first_project.customers2
20:36:35.668493 [info ] [Thread-8  ]: 6 of 7 START table model public.customers2 ..................................... [RUN]
20:36:35.668750 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers2"
20:36:35.668818 [debug] [Thread-8  ]: Began compiling node model.first_project.customers2
20:36:35.668878 [debug] [Thread-8  ]: Compiling model.first_project.customers2
20:36:35.670330 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers2"
20:36:35.670516 [debug] [Thread-8  ]: finished collecting timing info
20:36:35.670634 [debug] [Thread-8  ]: Began executing node model.first_project.customers2
20:36:35.672476 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers2"
20:36:35.672586 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.01 seconds
20:36:35.673576 [debug] [Thread-4  ]: finished collecting timing info
20:36:35.673683 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
20:36:35.673949 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a6e1c1e-3f83-4732-b59e-331703248ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fd266b20>]}
20:36:35.674135 [info ] [Thread-4  ]: 4 of 7 OK created table model public.stg_orders ................................ [[32mSELECT 295[0m in 0.13s]
20:36:35.674332 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
20:36:35.674830 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
20:36:35.674977 [debug] [Thread-8  ]: On model.first_project.customers2: BEGIN
20:36:35.675036 [debug] [Thread-8  ]: Opening a new connection, currently in state init
20:36:35.675327 [debug] [Thread-10 ]: Began running node model.first_project.customers
20:36:35.675454 [info ] [Thread-10 ]: 7 of 7 START table model public.customers ...................................... [RUN]
20:36:35.675684 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
20:36:35.675752 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
20:36:35.675827 [debug] [Thread-10 ]: Compiling model.first_project.customers
20:36:35.677251 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
20:36:35.677436 [debug] [Thread-10 ]: finished collecting timing info
20:36:35.677558 [debug] [Thread-10 ]: Began executing node model.first_project.customers
20:36:35.684427 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.customers"
20:36:35.684857 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
20:36:35.685005 [debug] [Thread-10 ]: On model.first_project.customers: BEGIN
20:36:35.685062 [debug] [Thread-10 ]: Opening a new connection, currently in state init
20:36:35.686657 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
20:36:35.686802 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:36:35.687110 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
20:36:35.693057 [debug] [Thread-10 ]: SQL status: BEGIN in 0.01 seconds
20:36:35.693247 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
20:36:35.693351 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
 customers.state
 from customers
 left join customer_orders using (customer_id)
 WHERE customers.customer_id != 63
)
select * from final
  );
20:36:35.696134 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
20:36:35.696343 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
20:36:35.696413 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
20:36:35.699444 [debug] [Thread-8  ]: SQL status: SELECT 100 in 0.0 seconds
20:36:35.701139 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
20:36:35.701934 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.01 seconds
20:36:35.703333 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:36:35.703412 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:36:35.702010 [debug] [Thread-10 ]: SQL status: SELECT 98 in 0.01 seconds
20:36:35.704518 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
20:36:35.704592 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
20:36:35.704679 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
20:36:35.702099 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
20:36:35.705417 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
20:36:35.705910 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:36:35.705987 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
20:36:35.706532 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
20:36:35.708730 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
20:36:35.708829 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
20:36:35.708940 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
20:36:35.710750 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:36:35.710914 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
20:36:35.711274 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
20:36:35.711419 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.01 seconds
20:36:35.712585 [debug] [Thread-6  ]: finished collecting timing info
20:36:35.714125 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
20:36:35.714252 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.01 seconds
20:36:35.715471 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
20:36:35.714482 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
20:36:35.715561 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
20:36:35.715721 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
20:36:35.714388 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
20:36:35.717236 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
20:36:35.718073 [debug] [Thread-8  ]: On model.first_project.customers2: COMMIT
20:36:35.718161 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
20:36:35.718219 [debug] [Thread-8  ]: On model.first_project.customers2: COMMIT
20:36:35.718313 [debug] [Thread-10 ]: SQL status: COMMIT in 0.0 seconds
20:36:35.719205 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
20:36:35.719283 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
20:36:35.719804 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a6e1c1e-3f83-4732-b59e-331703248ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fd24e400>]}
20:36:35.720021 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
20:36:35.720244 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
20:36:35.720889 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
20:36:35.721687 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
20:36:35.721770 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
20:36:35.721866 [debug] [Thread-10 ]: SQL status: DROP TABLE in 0.0 seconds
20:36:35.722469 [debug] [Thread-10 ]: finished collecting timing info
20:36:35.722575 [debug] [Thread-10 ]: On model.first_project.customers: Close
20:36:35.722823 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a6e1c1e-3f83-4732-b59e-331703248ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fda8a6a0>]}
20:36:35.723041 [info ] [Thread-10 ]: 7 of 7 OK created table model public.customers ................................. [[32mSELECT 98[0m in 0.05s]
20:36:35.723237 [debug] [Thread-10 ]: Finished running node model.first_project.customers
20:36:35.724357 [debug] [Thread-8  ]: SQL status: DROP TABLE in 0.0 seconds
20:36:35.724954 [debug] [Thread-8  ]: finished collecting timing info
20:36:35.725048 [debug] [Thread-8  ]: On model.first_project.customers2: Close
20:36:35.725383 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a6e1c1e-3f83-4732-b59e-331703248ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fc1f5370>]}
20:36:35.725571 [info ] [Thread-8  ]: 6 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.06s]
20:36:35.725796 [debug] [Thread-8  ]: Finished running node model.first_project.customers2
20:36:35.727118 [debug] [MainThread]: Acquiring new postgres connection "master"
20:36:35.727220 [debug] [MainThread]: Using postgres connection "master"
20:36:35.727277 [debug] [MainThread]: On master: BEGIN
20:36:35.727329 [debug] [MainThread]: Opening a new connection, currently in state closed
20:36:35.739293 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:36:35.739572 [debug] [MainThread]: On master: COMMIT
20:36:35.739655 [debug] [MainThread]: Using postgres connection "master"
20:36:35.739846 [debug] [MainThread]: On master: COMMIT
20:36:35.740684 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:36:35.740871 [debug] [MainThread]: On master: Close
20:36:35.741280 [info ] [MainThread]: 
20:36:35.741451 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0.28s.
20:36:35.741556 [debug] [MainThread]: Connection 'master' was properly closed.
20:36:35.741608 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
20:36:35.741655 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
20:36:35.741701 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
20:36:35.741745 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
20:36:35.741790 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
20:36:35.741835 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
20:36:35.741880 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
20:36:35.744951 [info ] [MainThread]: 
20:36:35.745143 [info ] [MainThread]: [32mCompleted successfully[0m
20:36:35.745368 [info ] [MainThread]: 
20:36:35.745487 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
20:36:35.745670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fe0b4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fc1f5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53fdaa6400>]}


============================== 2022-06-07 20:36:40.129677 | a55ac415-099a-4a2d-ba05-daff3652d7e7 ==============================
20:36:40.129691 [info ] [MainThread]: Running with dbt=1.1.0
20:36:40.130043 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
20:36:40.130125 [debug] [MainThread]: Tracking: tracking
20:36:40.132652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc75467bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc75467b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc75467b400>]}
20:36:40.149946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:36:40.150115 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:36:40.156039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a55ac415-099a-4a2d-ba05-daff3652d7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7545250d0>]}
20:36:40.161919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a55ac415-099a-4a2d-ba05-daff3652d7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc754577100>]}
20:36:40.162274 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
20:36:40.162437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a55ac415-099a-4a2d-ba05-daff3652d7e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc754577070>]}
20:36:40.163491 [info ] [MainThread]: 
20:36:40.163689 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
20:36:40.166283 [info ] [MainThread]: 
20:36:40.166440 [info ] [MainThread]: [32mCompleted successfully[0m
20:36:40.166571 [info ] [MainThread]: 
20:36:40.166677 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
20:36:40.166954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc754577250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7545770a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7545889d0>]}


============================== 2022-06-07 20:44:11.183831 | 6a7b7fdb-bd7b-4807-911d-3cffed09fffb ==============================
20:44:11.183845 [info ] [MainThread]: Running with dbt=1.1.0
20:44:11.184231 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:44:11.184319 [debug] [MainThread]: Tracking: tracking
20:44:11.186602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef883c3c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef883c3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef883c3400>]}
20:44:11.204787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
20:44:11.205139 [debug] [MainThread]: Partial parsing: added file: first_project://seeds/code-country.csv
20:44:11.227594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a7b7fdb-bd7b-4807-911d-3cffed09fffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8822b0d0>]}
20:44:11.230995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a7b7fdb-bd7b-4807-911d-3cffed09fffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef882cae50>]}
20:44:11.231235 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:44:11.231552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a7b7fdb-bd7b-4807-911d-3cffed09fffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef882caee0>]}
20:44:11.232928 [info ] [MainThread]: 
20:44:11.233495 [debug] [MainThread]: Acquiring new postgres connection "master"
20:44:11.234523 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
20:44:11.245345 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
20:44:11.245514 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
20:44:11.245580 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:44:11.259000 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
20:44:11.261043 [debug] [ThreadPool]: On list_erp_oltp: Close
20:44:11.262537 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
20:44:11.292610 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:44:11.292753 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
20:44:11.292810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:44:11.297433 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:44:11.297570 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:44:11.297628 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:44:11.299101 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
20:44:11.299948 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
20:44:11.300579 [debug] [ThreadPool]: On list_erp_oltp_public: Close
20:44:11.303455 [debug] [MainThread]: Using postgres connection "master"
20:44:11.303553 [debug] [MainThread]: On master: BEGIN
20:44:11.303609 [debug] [MainThread]: Opening a new connection, currently in state init
20:44:11.307873 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:44:11.307975 [debug] [MainThread]: Using postgres connection "master"
20:44:11.308031 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:44:11.317851 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
20:44:11.318585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a7b7fdb-bd7b-4807-911d-3cffed09fffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef88349a00>]}
20:44:11.318777 [debug] [MainThread]: On master: ROLLBACK
20:44:11.319201 [debug] [MainThread]: Using postgres connection "master"
20:44:11.319289 [debug] [MainThread]: On master: BEGIN
20:44:11.320573 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:44:11.320665 [debug] [MainThread]: On master: COMMIT
20:44:11.320724 [debug] [MainThread]: Using postgres connection "master"
20:44:11.320775 [debug] [MainThread]: On master: COMMIT
20:44:11.321051 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:44:11.321147 [debug] [MainThread]: On master: Close
20:44:11.321399 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:44:11.321648 [info ] [MainThread]: 
20:44:11.325939 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
20:44:11.326154 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
20:44:11.326392 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
20:44:11.326466 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
20:44:11.326532 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
20:44:11.327887 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
20:44:11.328050 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
20:44:11.328184 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
20:44:11.328531 [info ] [Thread-3  ]: 3 of 7 START table model public.stg_customers .................................. [RUN]
20:44:11.328386 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
20:44:11.328263 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
20:44:11.329162 [info ] [Thread-4  ]: 4 of 7 START table model public.stg_orders ..................................... [RUN]
20:44:11.329030 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
20:44:11.329474 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
20:44:11.329546 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
20:44:11.329367 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
20:44:11.330917 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
20:44:11.330789 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
20:44:11.328764 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
20:44:11.331195 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
20:44:11.331257 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
20:44:11.331797 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
20:44:11.330996 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
20:44:11.332634 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
20:44:11.332779 [debug] [Thread-4  ]: finished collecting timing info
20:44:11.332921 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
20:44:11.331994 [debug] [Thread-2  ]: finished collecting timing info
20:44:11.341489 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
20:44:11.332104 [debug] [Thread-3  ]: finished collecting timing info
20:44:11.331064 [debug] [Thread-1  ]: finished collecting timing info
20:44:11.347097 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
20:44:11.361449 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
20:44:11.375312 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
20:44:11.375562 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:44:11.375638 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
20:44:11.373867 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
20:44:11.376046 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:44:11.376166 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
20:44:11.375758 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:44:11.376224 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:44:11.369450 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
20:44:11.376817 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:44:11.376936 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
20:44:11.376993 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:44:11.371685 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
20:44:11.377347 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:44:11.377458 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
20:44:11.377511 [debug] [Thread-2  ]: Opening a new connection, currently in state init
20:44:11.382934 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
20:44:11.383142 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:44:11.383213 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
20:44:11.384097 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
20:44:11.384223 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:44:11.384278 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)
select * from customers
  );
20:44:11.384363 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
20:44:11.384419 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:44:11.384467 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */


  create  table "erp_oltp"."public"."stg_orders__dbt_tmp"
  as (
    with orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
)
select * from orders
  );
20:44:11.385240 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.0 seconds
20:44:11.390574 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:44:11.390695 [debug] [Thread-4  ]: SQL status: SELECT 295 in 0.01 seconds
20:44:11.392025 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:44:11.392108 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
20:44:11.390755 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
20:44:11.393352 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:44:11.393448 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
20:44:11.393544 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:11.394528 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:44:11.394606 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
20:44:11.390823 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
20:44:11.394741 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:11.395796 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:44:11.395875 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
20:44:11.395960 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:11.401280 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
20:44:11.403210 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
20:44:11.403421 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:44:11.403525 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
20:44:11.404629 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
20:44:11.404708 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:44:11.403788 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:44:11.403865 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
20:44:11.404763 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
20:44:11.403625 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:44:11.406187 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
20:44:11.405990 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:44:11.406959 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
20:44:11.407234 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:11.408140 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
20:44:11.408220 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:44:11.408272 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
20:44:11.408510 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
20:44:11.412278 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:44:11.412431 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
20:44:11.412507 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
20:44:11.414828 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:44:11.414949 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:44:11.413561 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:44:11.415066 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
20:44:11.412680 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop table if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
20:44:11.412590 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
20:44:11.416001 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:44:11.416077 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
20:44:11.416258 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:11.417525 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:44:11.417609 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:44:11.418260 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
20:44:11.418412 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:11.419320 [debug] [Thread-4  ]: finished collecting timing info
20:44:11.419405 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
20:44:11.421925 [debug] [Thread-2  ]: finished collecting timing info
20:44:11.421196 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:44:11.422015 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
20:44:11.422481 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7b7fdb-bd7b-4807-911d-3cffed09fffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef88199700>]}
20:44:11.422701 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.09s]
20:44:11.422100 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:44:11.422978 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
20:44:11.419458 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
20:44:11.423797 [debug] [Thread-3  ]: finished collecting timing info
20:44:11.423153 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:44:11.423889 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
20:44:11.424254 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7b7fdb-bd7b-4807-911d-3cffed09fffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef881f47c0>]}
20:44:11.424473 [info ] [Thread-3  ]: 3 of 7 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.10s]
20:44:11.421349 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
20:44:11.424771 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7b7fdb-bd7b-4807-911d-3cffed09fffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8825d910>]}
20:44:11.424911 [info ] [Thread-4  ]: 4 of 7 OK created table model public.stg_orders ................................ [[32mSELECT 295[0m in 0.10s]
20:44:11.425095 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
20:44:11.425283 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
20:44:11.425456 [debug] [Thread-6  ]: Began running node model.first_project.customers2
20:44:11.425589 [info ] [Thread-6  ]: 5 of 7 START table model public.customers2 ..................................... [RUN]
20:44:11.425783 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
20:44:11.425852 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
20:44:11.425914 [debug] [Thread-6  ]: Compiling model.first_project.customers2
20:44:11.428498 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
20:44:11.428770 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:44:11.429783 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:44:11.429885 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
20:44:11.430576 [debug] [Thread-8  ]: Began running node model.first_project.customers
20:44:11.430780 [info ] [Thread-8  ]: 6 of 7 START table model public.customers ...................................... [RUN]
20:44:11.431179 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
20:44:11.431267 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
20:44:11.431334 [debug] [Thread-8  ]: Compiling model.first_project.customers
20:44:11.432895 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
20:44:11.433040 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:44:11.433353 [debug] [Thread-6  ]: finished collecting timing info
20:44:11.439164 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
20:44:11.440666 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
20:44:11.439018 [debug] [Thread-8  ]: finished collecting timing info
20:44:11.441009 [debug] [Thread-8  ]: Began executing node model.first_project.customers
20:44:11.442366 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
20:44:11.442538 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:44:11.442634 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
20:44:11.442691 [debug] [Thread-8  ]: Opening a new connection, currently in state init
20:44:11.440890 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
20:44:11.443570 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
20:44:11.443641 [debug] [Thread-6  ]: Opening a new connection, currently in state init
20:44:11.434951 [debug] [Thread-1  ]: finished collecting timing info
20:44:11.444250 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
20:44:11.444543 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7b7fdb-bd7b-4807-911d-3cffed09fffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef883c33a0>]}
20:44:11.444739 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.12s]
20:44:11.446386 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
20:44:11.446651 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
20:44:11.446828 [info ] [Thread-10 ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
20:44:11.447099 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
20:44:11.447171 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
20:44:11.447235 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
20:44:11.448532 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
20:44:11.448777 [debug] [Thread-10 ]: finished collecting timing info
20:44:11.448910 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
20:44:11.450523 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
20:44:11.450778 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:44:11.450945 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
20:44:11.451138 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
20:44:11.451034 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: BEGIN
20:44:11.451308 [debug] [Thread-10 ]: Opening a new connection, currently in state init
20:44:11.451214 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
20:44:11.464105 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.01 seconds
20:44:11.466332 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
20:44:11.466996 [debug] [Thread-10 ]: SQL status: BEGIN in 0.02 seconds
20:44:11.467223 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
20:44:11.467425 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:44:11.467576 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
20:44:11.467768 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:11.469412 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
20:44:11.469574 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
20:44:11.469884 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:11.470809 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
20:44:11.470911 [debug] [Thread-8  ]: SQL status: BEGIN in 0.03 seconds
20:44:11.470994 [debug] [Thread-10 ]: SQL status: CREATE VIEW in 0.0 seconds
20:44:11.471269 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:44:11.472462 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
 customers.state
 from customers
 left join customer_orders using (customer_id)
 WHERE customers.customer_id != 63
)
select * from final
  );
20:44:11.471174 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
20:44:11.472328 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:44:11.472579 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
20:44:11.472690 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:44:11.473949 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
20:44:11.474879 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
20:44:11.475018 [debug] [Thread-8  ]: SQL status: SELECT 98 in 0.0 seconds
20:44:11.475099 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:11.476367 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:44:11.477221 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
20:44:11.477113 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
20:44:11.475188 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
20:44:11.477344 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:44:11.477456 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
20:44:11.477798 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:11.479005 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:44:11.479118 [debug] [Thread-10 ]: SQL status: COMMIT in 0.0 seconds
20:44:11.479258 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
20:44:11.480136 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:44:11.480451 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
20:44:11.480818 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
20:44:11.481429 [debug] [Thread-6  ]: finished collecting timing info
20:44:11.481509 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:11.481584 [debug] [Thread-10 ]: SQL status: DROP VIEW in 0.0 seconds
20:44:11.482654 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
20:44:11.483945 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:44:11.483752 [debug] [Thread-10 ]: finished collecting timing info
20:44:11.484020 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
20:44:11.481688 [debug] [Thread-6  ]: On model.first_project.customers2: Close
20:44:11.484128 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: Close
20:44:11.484591 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7b7fdb-bd7b-4807-911d-3cffed09fffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef881e12e0>]}
20:44:11.484835 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.06s]
20:44:11.485137 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
20:44:11.486663 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7b7fdb-bd7b-4807-911d-3cffed09fffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8a1c2d60>]}
20:44:11.486983 [info ] [Thread-10 ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
20:44:11.487243 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
20:44:11.487476 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
20:44:11.488380 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:44:11.488453 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
20:44:11.490345 [debug] [Thread-8  ]: SQL status: DROP TABLE in 0.0 seconds
20:44:11.491290 [debug] [Thread-8  ]: finished collecting timing info
20:44:11.491390 [debug] [Thread-8  ]: On model.first_project.customers: Close
20:44:11.491740 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a7b7fdb-bd7b-4807-911d-3cffed09fffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef840e3f70>]}
20:44:11.491933 [info ] [Thread-8  ]: 6 of 7 OK created table model public.customers ................................. [[32mSELECT 98[0m in 0.06s]
20:44:11.492165 [debug] [Thread-8  ]: Finished running node model.first_project.customers
20:44:11.493358 [debug] [MainThread]: Acquiring new postgres connection "master"
20:44:11.493512 [debug] [MainThread]: Using postgres connection "master"
20:44:11.493592 [debug] [MainThread]: On master: BEGIN
20:44:11.493645 [debug] [MainThread]: Opening a new connection, currently in state closed
20:44:11.498068 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:44:11.498182 [debug] [MainThread]: On master: COMMIT
20:44:11.498248 [debug] [MainThread]: Using postgres connection "master"
20:44:11.498337 [debug] [MainThread]: On master: COMMIT
20:44:11.498457 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:44:11.498548 [debug] [MainThread]: On master: Close
20:44:11.498802 [info ] [MainThread]: 
20:44:11.498986 [info ] [MainThread]: Finished running 2 view models, 5 table models in 0.27s.
20:44:11.499086 [debug] [MainThread]: Connection 'master' was properly closed.
20:44:11.499155 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
20:44:11.499205 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
20:44:11.499249 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
20:44:11.499307 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
20:44:11.499356 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
20:44:11.499402 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
20:44:11.499449 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
20:44:11.508604 [info ] [MainThread]: 
20:44:11.508910 [info ] [MainThread]: [32mCompleted successfully[0m
20:44:11.509110 [info ] [MainThread]: 
20:44:11.509234 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
20:44:11.509414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef89c0fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef89c24b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef89c63ac0>]}


============================== 2022-06-07 20:44:32.543553 | 35f1fa6c-2ea8-40aa-b526-3986c018da6e ==============================
20:44:32.543570 [info ] [MainThread]: Running with dbt=1.1.0
20:44:32.543922 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
20:44:32.543997 [debug] [MainThread]: Tracking: tracking
20:44:32.546349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7637fa1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7637fa15b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7637fa1730>]}
20:44:32.563416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:44:32.563581 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:44:32.568076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35f1fa6c-2ea8-40aa-b526-3986c018da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7637e510d0>]}
20:44:32.571935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35f1fa6c-2ea8-40aa-b526-3986c018da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7637ec1520>]}
20:44:32.572213 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:44:32.572362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35f1fa6c-2ea8-40aa-b526-3986c018da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7637ec15b0>]}
20:44:32.573680 [info ] [MainThread]: 
20:44:32.574037 [debug] [MainThread]: Acquiring new postgres connection "master"
20:44:32.574718 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
20:44:32.589797 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
20:44:32.589967 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
20:44:32.590044 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:44:32.596390 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
20:44:32.597295 [debug] [ThreadPool]: On list_erp_oltp: Close
20:44:32.598575 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
20:44:32.603866 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:44:32.604049 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
20:44:32.604111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:44:32.614522 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:44:32.614821 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:44:32.614935 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:44:32.616863 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
20:44:32.618117 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
20:44:32.618448 [debug] [ThreadPool]: On list_erp_oltp_public: Close
20:44:32.621292 [debug] [MainThread]: Using postgres connection "master"
20:44:32.621386 [debug] [MainThread]: On master: BEGIN
20:44:32.621462 [debug] [MainThread]: Opening a new connection, currently in state init
20:44:32.625650 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:44:32.625752 [debug] [MainThread]: Using postgres connection "master"
20:44:32.625810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:44:32.636512 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
20:44:32.637450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35f1fa6c-2ea8-40aa-b526-3986c018da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7637f33940>]}
20:44:32.637665 [debug] [MainThread]: On master: ROLLBACK
20:44:32.638018 [debug] [MainThread]: Using postgres connection "master"
20:44:32.638114 [debug] [MainThread]: On master: BEGIN
20:44:32.638557 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:44:32.638653 [debug] [MainThread]: On master: COMMIT
20:44:32.638712 [debug] [MainThread]: Using postgres connection "master"
20:44:32.638763 [debug] [MainThread]: On master: COMMIT
20:44:32.639018 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:44:32.639115 [debug] [MainThread]: On master: Close
20:44:32.639447 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:44:32.639587 [info ] [MainThread]: 
20:44:32.643041 [debug] [Thread-1  ]: Began running node seed.first_project.code-country
20:44:32.643251 [info ] [Thread-1  ]: 1 of 1 START seed file public.code-country ..................................... [RUN]
20:44:32.643501 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.first_project.code-country"
20:44:32.643577 [debug] [Thread-1  ]: Began compiling node seed.first_project.code-country
20:44:32.643655 [debug] [Thread-1  ]: finished collecting timing info
20:44:32.643715 [debug] [Thread-1  ]: Began executing node seed.first_project.code-country
20:44:32.703466 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:44:32.703635 [debug] [Thread-1  ]: On seed.first_project.code-country: BEGIN
20:44:32.703697 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:44:32.708925 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:44:32.709067 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:44:32.709126 [debug] [Thread-1  ]: On seed.first_project.code-country: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "seed.first_project.code-country"} */

    create table "erp_oltp"."public"."code-country" ("Name" text,"Code" text)
  
20:44:32.714405 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
20:44:32.791428 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:44:32.791621 [debug] [Thread-1  ]: On seed.first_project.code-country: 
          insert into "erp_oltp"."public"."code-country" ("Name", "Code") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,...
20:44:32.793164 [debug] [Thread-1  ]: SQL status: INSERT 0 249 in 0.0 seconds
20:44:32.795811 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.first_project.code-country"
20:44:32.803207 [debug] [Thread-1  ]: On seed.first_project.code-country: COMMIT
20:44:32.803343 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:44:32.803406 [debug] [Thread-1  ]: On seed.first_project.code-country: COMMIT
20:44:32.804391 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:44:32.804717 [debug] [Thread-1  ]: finished collecting timing info
20:44:32.804814 [debug] [Thread-1  ]: On seed.first_project.code-country: Close
20:44:32.805116 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35f1fa6c-2ea8-40aa-b526-3986c018da6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f763759ecd0>]}
20:44:32.805316 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.code-country ................................. [[32mINSERT 249[0m in 0.16s]
20:44:32.805549 [debug] [Thread-1  ]: Finished running node seed.first_project.code-country
20:44:32.806581 [debug] [MainThread]: Acquiring new postgres connection "master"
20:44:32.806758 [debug] [MainThread]: Using postgres connection "master"
20:44:32.806826 [debug] [MainThread]: On master: BEGIN
20:44:32.806884 [debug] [MainThread]: Opening a new connection, currently in state closed
20:44:32.810336 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:44:32.810436 [debug] [MainThread]: On master: COMMIT
20:44:32.810495 [debug] [MainThread]: Using postgres connection "master"
20:44:32.810546 [debug] [MainThread]: On master: COMMIT
20:44:32.810648 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:44:32.810717 [debug] [MainThread]: On master: Close
20:44:32.810959 [info ] [MainThread]: 
20:44:32.811110 [info ] [MainThread]: Finished running 1 seed in 0.24s.
20:44:32.811211 [debug] [MainThread]: Connection 'master' was properly closed.
20:44:32.811259 [debug] [MainThread]: Connection 'seed.first_project.code-country' was properly closed.
20:44:32.814314 [info ] [MainThread]: 
20:44:32.814489 [info ] [MainThread]: [32mCompleted successfully[0m
20:44:32.814639 [info ] [MainThread]: 
20:44:32.814747 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
20:44:32.814950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7637e98d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7637f33d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7637de54c0>]}


============================== 2022-06-07 20:44:54.381946 | d91b29e8-ece3-4539-8e2b-0c97f7c8c9ac ==============================
20:44:54.381962 [info ] [MainThread]: Running with dbt=1.1.0
20:44:54.382437 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:44:54.382546 [debug] [MainThread]: Tracking: tracking
20:44:54.386201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b4dbb5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b4dbb5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b4dbb5400>]}
20:44:54.403367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:44:54.403516 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:44:54.407534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd91b29e8-ece3-4539-8e2b-0c97f7c8c9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b4da640d0>]}
20:44:54.411870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd91b29e8-ece3-4539-8e2b-0c97f7c8c9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b4db19220>]}
20:44:54.412255 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:44:54.412446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd91b29e8-ece3-4539-8e2b-0c97f7c8c9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b4daaed60>]}
20:44:54.413804 [info ] [MainThread]: 
20:44:54.414265 [debug] [MainThread]: Acquiring new postgres connection "master"
20:44:54.415637 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
20:44:54.428363 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
20:44:54.428848 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
20:44:54.428926 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:44:54.436922 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
20:44:54.437906 [debug] [ThreadPool]: On list_erp_oltp: Close
20:44:54.439978 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
20:44:54.443933 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:44:54.444101 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
20:44:54.444299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:44:54.448374 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:44:54.448533 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:44:54.448593 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:44:54.456443 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.01 seconds
20:44:54.457657 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
20:44:54.458092 [debug] [ThreadPool]: On list_erp_oltp_public: Close
20:44:54.461054 [debug] [MainThread]: Using postgres connection "master"
20:44:54.461145 [debug] [MainThread]: On master: BEGIN
20:44:54.461201 [debug] [MainThread]: Opening a new connection, currently in state init
20:44:54.466269 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:44:54.466466 [debug] [MainThread]: Using postgres connection "master"
20:44:54.466535 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:44:54.476137 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
20:44:54.477099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd91b29e8-ece3-4539-8e2b-0c97f7c8c9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b4dab1d90>]}
20:44:54.477337 [debug] [MainThread]: On master: ROLLBACK
20:44:54.477602 [debug] [MainThread]: Using postgres connection "master"
20:44:54.477679 [debug] [MainThread]: On master: BEGIN
20:44:54.477864 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:44:54.477941 [debug] [MainThread]: On master: COMMIT
20:44:54.477994 [debug] [MainThread]: Using postgres connection "master"
20:44:54.478043 [debug] [MainThread]: On master: COMMIT
20:44:54.478157 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:44:54.478230 [debug] [MainThread]: On master: Close
20:44:54.478557 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:44:54.478701 [info ] [MainThread]: 
20:44:54.482097 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
20:44:54.482416 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
20:44:54.482697 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
20:44:54.482780 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
20:44:54.482858 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
20:44:54.485374 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
20:44:54.485618 [debug] [Thread-1  ]: finished collecting timing info
20:44:54.485706 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
20:44:54.497225 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
20:44:54.497733 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
20:44:54.533202 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
20:44:54.533605 [info ] [Thread-3  ]: 3 of 7 START table model public.stg_customers .................................. [RUN]
20:44:54.534007 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
20:44:54.534088 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
20:44:54.534156 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
20:44:54.534860 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
20:44:54.542399 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
20:44:54.542777 [info ] [Thread-4  ]: 4 of 7 START table model public.stg_orders ..................................... [RUN]
20:44:54.553980 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
20:44:54.554140 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
20:44:54.554266 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
20:44:54.555408 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
20:44:54.553572 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
20:44:54.558206 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
20:44:54.558460 [debug] [Thread-4  ]: finished collecting timing info
20:44:54.558885 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
20:44:54.560443 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
20:44:54.558567 [debug] [Thread-3  ]: finished collecting timing info
20:44:54.560696 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
20:44:54.560563 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:44:54.562062 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
20:44:54.562495 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:44:54.562176 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
20:44:54.562313 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:44:54.562857 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
20:44:54.562953 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:44:54.562696 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:44:54.562581 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
20:44:54.563873 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:44:54.558666 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
20:44:54.565723 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
20:44:54.567657 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
20:44:54.567950 [debug] [Thread-2  ]: finished collecting timing info
20:44:54.568392 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:44:54.568716 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:44:54.568808 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:44:54.568589 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
20:44:54.578246 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
20:44:54.582625 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:44:54.582796 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:44:54.588559 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
20:44:54.590737 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:44:54.590842 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:44:54.590983 [debug] [Thread-4  ]: SQL status: BEGIN in 0.03 seconds
20:44:54.591092 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:44:54.591167 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */


  create  table "erp_oltp"."public"."stg_orders__dbt_tmp"
  as (
    with orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
)
select * from orders
  );
20:44:54.591284 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
20:44:54.591341 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:44:54.591390 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)
select * from customers
  );
20:44:54.595400 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
20:44:54.595508 [debug] [Thread-4  ]: SQL status: SELECT 295 in 0.0 seconds
20:44:54.597256 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:44:54.595646 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:54.595565 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.0 seconds
20:44:54.597371 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
20:44:54.607624 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:44:54.607817 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
20:44:54.607880 [debug] [Thread-2  ]: Opening a new connection, currently in state init
20:44:54.604391 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:44:54.608231 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
20:44:54.608517 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:54.608101 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:54.610232 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:44:54.611529 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
20:44:54.611338 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:44:54.611719 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
20:44:54.611828 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:54.612703 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
20:44:54.612783 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:44:54.612836 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
20:44:54.612915 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:54.607407 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:44:54.613837 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
20:44:54.614057 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:44:54.614540 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:44:54.614373 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
20:44:54.614714 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:44:54.614797 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
20:44:54.614272 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:44:54.614962 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
20:44:54.615117 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
20:44:54.618549 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:44:54.618667 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
20:44:54.618767 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
20:44:54.619714 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:44:54.619806 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop table if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
20:44:54.620168 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
20:44:54.621429 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:44:54.621535 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
20:44:54.622579 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:44:54.621725 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
20:44:54.622661 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
20:44:54.621649 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
20:44:54.622731 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
20:44:54.624205 [debug] [Thread-3  ]: finished collecting timing info
20:44:54.625124 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
20:44:54.624923 [debug] [Thread-4  ]: finished collecting timing info
20:44:54.625265 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
20:44:54.625567 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd91b29e8-ece3-4539-8e2b-0c97f7c8c9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b4f3cceb0>]}
20:44:54.625778 [info ] [Thread-4  ]: 4 of 7 OK created table model public.stg_orders ................................ [[32mSELECT 295[0m in 0.07s]
20:44:54.626004 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
20:44:54.624316 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:44:54.626897 [debug] [Thread-1  ]: finished collecting timing info
20:44:54.626984 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
20:44:54.625019 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:54.628521 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:44:54.628616 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
20:44:54.628837 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd91b29e8-ece3-4539-8e2b-0c97f7c8c9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b4dba4850>]}
20:44:54.629242 [info ] [Thread-3  ]: 3 of 7 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.09s]
20:44:54.629454 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
20:44:54.629004 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd91b29e8-ece3-4539-8e2b-0c97f7c8c9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b4d1af2e0>]}
20:44:54.629563 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:54.630626 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.15s]
20:44:54.631512 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
20:44:54.631653 [debug] [Thread-6  ]: Began running node model.first_project.customers
20:44:54.632291 [info ] [Thread-6  ]: 5 of 7 START table model public.customers ...................................... [RUN]
20:44:54.632552 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers"
20:44:54.632105 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:44:54.632634 [debug] [Thread-6  ]: Began compiling node model.first_project.customers
20:44:54.632875 [debug] [Thread-6  ]: Compiling model.first_project.customers
20:44:54.634416 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers"
20:44:54.632765 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
20:44:54.631748 [debug] [Thread-7  ]: Began running node model.first_project.customers2
20:44:54.634707 [info ] [Thread-7  ]: 6 of 7 START table model public.customers2 ..................................... [RUN]
20:44:54.634999 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers2"
20:44:54.635077 [debug] [Thread-7  ]: Began compiling node model.first_project.customers2
20:44:54.635135 [debug] [Thread-7  ]: Compiling model.first_project.customers2
20:44:54.636461 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers2"
20:44:54.631979 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
20:44:54.636598 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
20:44:54.636781 [debug] [Thread-7  ]: finished collecting timing info
20:44:54.638176 [debug] [Thread-7  ]: Began executing node model.first_project.customers2
20:44:54.638087 [debug] [Thread-9  ]: Began running node model.first_project.my_second_dbt_model
20:44:54.637911 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:44:54.636930 [debug] [Thread-6  ]: finished collecting timing info
20:44:54.640920 [info ] [Thread-9  ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
20:44:54.641375 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
20:44:54.641025 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
20:44:54.641455 [debug] [Thread-9  ]: Began compiling node model.first_project.my_second_dbt_model
20:44:54.641851 [debug] [Thread-9  ]: Compiling model.first_project.my_second_dbt_model
20:44:54.641134 [debug] [Thread-6  ]: Began executing node model.first_project.customers
20:44:54.653530 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers"
20:44:54.653913 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
20:44:54.654007 [debug] [Thread-6  ]: On model.first_project.customers: BEGIN
20:44:54.654062 [debug] [Thread-6  ]: Opening a new connection, currently in state init
20:44:54.640776 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.customers2"
20:44:54.654692 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
20:44:54.654813 [debug] [Thread-7  ]: On model.first_project.customers2: BEGIN
20:44:54.654901 [debug] [Thread-7  ]: Opening a new connection, currently in state init
20:44:54.651146 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
20:44:54.655426 [debug] [Thread-9  ]: finished collecting timing info
20:44:54.655543 [debug] [Thread-9  ]: Began executing node model.first_project.my_second_dbt_model
20:44:54.651392 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
20:44:54.664702 [debug] [Thread-2  ]: finished collecting timing info
20:44:54.664974 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
20:44:54.665495 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd91b29e8-ece3-4539-8e2b-0c97f7c8c9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b4d9ef850>]}
20:44:54.667253 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.17s]
20:44:54.667644 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
20:44:54.667860 [debug] [Thread-7  ]: SQL status: BEGIN in 0.01 seconds
20:44:54.667959 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
20:44:54.668036 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
20:44:54.670667 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
20:44:54.670952 [debug] [Thread-7  ]: SQL status: SELECT 100 in 0.0 seconds
20:44:54.673530 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
20:44:54.673659 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
20:44:54.673969 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:44:54.674106 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: BEGIN
20:44:54.674166 [debug] [Thread-9  ]: Opening a new connection, currently in state init
20:44:54.674273 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:54.675519 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
20:44:54.675604 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
20:44:54.675798 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
20:44:54.675909 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
20:44:54.675966 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
 customers.state
 from customers
 left join customer_orders using (customer_id)
 WHERE customers.customer_id != 63
)
select * from final
  );
20:44:54.677977 [debug] [Thread-6  ]: SQL status: SELECT 98 in 0.0 seconds
20:44:54.679959 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
20:44:54.680078 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
20:44:54.680412 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:54.683022 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
20:44:54.683229 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
20:44:54.683624 [debug] [Thread-9  ]: SQL status: BEGIN in 0.01 seconds
20:44:54.683801 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:44:54.683878 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
20:44:54.683975 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.01 seconds
20:44:54.685005 [debug] [Thread-7  ]: On model.first_project.customers2: COMMIT
20:44:54.685134 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
20:44:54.685194 [debug] [Thread-7  ]: On model.first_project.customers2: COMMIT
20:44:54.685750 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
20:44:54.695267 [debug] [Thread-9  ]: SQL status: CREATE VIEW in 0.01 seconds
20:44:54.697251 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:44:54.697822 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:44:54.697982 [debug] [Thread-7  ]: SQL status: COMMIT in 0.01 seconds
20:44:54.697645 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
20:44:54.699102 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
20:44:54.699517 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
20:44:54.699368 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
20:44:54.700111 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
20:44:54.701353 [debug] [Thread-7  ]: SQL status: DROP TABLE in 0.0 seconds
20:44:54.702662 [debug] [Thread-7  ]: finished collecting timing info
20:44:54.702801 [debug] [Thread-7  ]: On model.first_project.customers2: Close
20:44:54.702940 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
20:44:54.705357 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
20:44:54.708991 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
20:44:54.709117 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.01 seconds
20:44:54.710182 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
20:44:54.710474 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
20:44:54.710575 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:44:54.711652 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
20:44:54.711510 [debug] [Thread-6  ]: finished collecting timing info
20:44:54.710808 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd91b29e8-ece3-4539-8e2b-0c97f7c8c9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b4c12bcd0>]}
20:44:54.711770 [debug] [Thread-6  ]: On model.first_project.customers: Close
20:44:54.712027 [info ] [Thread-7  ]: 6 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.08s]
20:44:54.712359 [debug] [Thread-7  ]: Finished running node model.first_project.customers2
20:44:54.712805 [debug] [Thread-9  ]: SQL status: COMMIT in 0.0 seconds
20:44:54.713719 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:44:54.713858 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
20:44:54.714131 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd91b29e8-ece3-4539-8e2b-0c97f7c8c9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b4c0d5c10>]}
20:44:54.714396 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customers ................................. [[32mSELECT 98[0m in 0.08s]
20:44:54.714824 [debug] [Thread-6  ]: Finished running node model.first_project.customers
20:44:54.715034 [debug] [Thread-9  ]: SQL status: DROP VIEW in 0.0 seconds
20:44:54.716603 [debug] [Thread-9  ]: finished collecting timing info
20:44:54.719374 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: Close
20:44:54.719808 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd91b29e8-ece3-4539-8e2b-0c97f7c8c9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b4c131d30>]}
20:44:54.720048 [info ] [Thread-9  ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.08s]
20:44:54.720268 [debug] [Thread-9  ]: Finished running node model.first_project.my_second_dbt_model
20:44:54.721582 [debug] [MainThread]: Acquiring new postgres connection "master"
20:44:54.721701 [debug] [MainThread]: Using postgres connection "master"
20:44:54.721788 [debug] [MainThread]: On master: BEGIN
20:44:54.721896 [debug] [MainThread]: Opening a new connection, currently in state closed
20:44:54.731601 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:44:54.731840 [debug] [MainThread]: On master: COMMIT
20:44:54.731920 [debug] [MainThread]: Using postgres connection "master"
20:44:54.731987 [debug] [MainThread]: On master: COMMIT
20:44:54.732161 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:44:54.732502 [debug] [MainThread]: On master: Close
20:44:54.732859 [info ] [MainThread]: 
20:44:54.733033 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0.32s.
20:44:54.733151 [debug] [MainThread]: Connection 'master' was properly closed.
20:44:54.733202 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
20:44:54.733248 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
20:44:54.733292 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
20:44:54.733337 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
20:44:54.733393 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
20:44:54.733440 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
20:44:54.733484 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
20:44:54.736385 [info ] [MainThread]: 
20:44:54.736543 [info ] [MainThread]: [32mCompleted successfully[0m
20:44:54.736676 [info ] [MainThread]: 
20:44:54.736769 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
20:44:54.736926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b4dbb5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b4dbacd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b4d17f8e0>]}


============================== 2022-06-07 20:54:30.142988 | b69b4208-4bc3-4a98-97b6-4819af73079e ==============================
20:54:30.142995 [info ] [MainThread]: Running with dbt=1.1.0
20:54:30.143286 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_name': 'redshift-test', 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
20:54:30.143365 [debug] [MainThread]: Tracking: tracking
20:54:30.145797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da66e0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da66e08b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da66e0790>]}
20:54:30.146227 [info ] [MainThread]: Setting up your profile.
20:54:38.735795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da66ee9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da66ee550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da66eee50>]}


============================== 2022-06-10 18:39:47.420804 | f2ad044e-b532-4ca3-a536-61414cb38206 ==============================
18:39:47.420812 [info ] [MainThread]: Running with dbt=1.1.0
18:39:47.421386 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
18:39:47.421456 [debug] [MainThread]: Tracking: tracking
18:39:47.423586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd2ae6c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd2ae6820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd2ae6730>]}
18:39:47.506078 [debug] [MainThread]: Executing "git --help"
18:39:47.508753 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
18:39:47.508982 [debug] [MainThread]: STDERR: "b''"
18:39:47.512784 [debug] [MainThread]: Acquiring new postgres connection "debug"
18:39:47.513569 [debug] [MainThread]: Using postgres connection "debug"
18:39:47.513924 [debug] [MainThread]: On debug: select 1 as id
18:39:47.513986 [debug] [MainThread]: Opening a new connection, currently in state init
18:39:47.541976 [debug] [MainThread]: SQL status: SELECT 1 in 0.03 seconds
18:39:47.542831 [debug] [MainThread]: On debug: Close
18:39:47.545700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd1280d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd1280c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd1280070>]}
18:39:48.307197 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-10 19:00:43.175940 | e362868d-bc5f-4423-8336-bbb179a528f7 ==============================
19:00:43.175951 [info ] [MainThread]: Running with dbt=1.1.0
19:00:43.176360 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
19:00:43.176450 [debug] [MainThread]: Tracking: tracking
19:00:43.181049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5de0f71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5de0f7070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5de0f7610>]}
19:00:43.192753 [info ] [MainThread]: Unable to do partial parsing because profile has changed
19:00:43.193052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e362868d-bc5f-4423-8336-bbb179a528f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5df906e20>]}
19:00:43.211809 [debug] [MainThread]: Parsing macros/catalog.sql
19:00:43.213784 [debug] [MainThread]: Parsing macros/relations.sql
19:00:43.214593 [debug] [MainThread]: Parsing macros/adapters.sql
19:00:43.226590 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
19:00:43.227622 [debug] [MainThread]: Parsing macros/materializations/configs.sql
19:00:43.229021 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
19:00:43.231166 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
19:00:43.237557 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
19:00:43.246977 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
19:00:43.256329 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
19:00:43.259116 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
19:00:43.260112 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
19:00:43.260971 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
19:00:43.262406 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
19:00:43.264014 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
19:00:43.268139 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
19:00:43.272374 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
19:00:43.274043 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
19:00:43.283299 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
19:00:43.286883 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
19:00:43.287945 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
19:00:43.290622 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
19:00:43.291747 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
19:00:43.299162 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
19:00:43.308964 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
19:00:43.315142 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
19:00:43.316248 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
19:00:43.317791 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
19:00:43.318768 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
19:00:43.319657 [debug] [MainThread]: Parsing macros/adapters/columns.sql
19:00:43.325309 [debug] [MainThread]: Parsing macros/adapters/relation.sql
19:00:43.330738 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
19:00:43.332443 [debug] [MainThread]: Parsing macros/adapters/schema.sql
19:00:43.333798 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
19:00:43.335671 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
19:00:43.339976 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
19:00:43.342821 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
19:00:43.343319 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
19:00:43.343832 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
19:00:43.344258 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
19:00:43.345077 [debug] [MainThread]: Parsing macros/etc/datetime.sql
19:00:43.349904 [debug] [MainThread]: Parsing macros/etc/statement.sql
19:00:43.352613 [debug] [MainThread]: Parsing tests/generic/builtin.sql
19:00:43.482678 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers2.sql
19:00:43.490115 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
19:00:43.491633 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
19:00:43.493409 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
19:00:43.494899 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
19:00:43.496399 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
19:00:43.497865 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
19:00:43.549175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e362868d-bc5f-4423-8336-bbb179a528f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5de0739d0>]}
19:00:43.552424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e362868d-bc5f-4423-8336-bbb179a528f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5de0f7280>]}
19:00:43.552699 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
19:00:43.552994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e362868d-bc5f-4423-8336-bbb179a528f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5de0fe6d0>]}
19:00:43.554190 [info ] [MainThread]: 
19:00:43.554559 [debug] [MainThread]: Acquiring new postgres connection "master"
19:00:43.555403 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
19:00:43.562238 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
19:00:43.562370 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
19:00:43.562452 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:00:43.567962 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:00:43.568089 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
19:00:43.568209 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:00:43.587694 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.02 seconds
19:00:43.590460 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
19:00:43.594438 [debug] [ThreadPool]: On list_erp_oltp_public: Close
19:00:43.597862 [debug] [MainThread]: Using postgres connection "master"
19:00:43.598046 [debug] [MainThread]: On master: BEGIN
19:00:43.598135 [debug] [MainThread]: Opening a new connection, currently in state init
19:00:43.602061 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:00:43.602203 [debug] [MainThread]: Using postgres connection "master"
19:00:43.602266 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:00:43.616063 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
19:00:43.617176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e362868d-bc5f-4423-8336-bbb179a528f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5de06fcd0>]}
19:00:43.617368 [debug] [MainThread]: On master: ROLLBACK
19:00:43.617561 [debug] [MainThread]: On master: Close
19:00:43.617873 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
19:00:43.618016 [info ] [MainThread]: 
19:00:43.622191 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
19:00:43.622513 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
19:00:43.622619 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
19:00:43.622743 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
19:00:43.624302 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
19:00:43.624455 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
19:00:43.624569 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
19:00:43.625194 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
19:00:43.625277 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
19:00:43.624988 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
19:00:43.625341 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
19:00:43.626183 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
19:00:43.626418 [debug] [Thread-3  ]: finished collecting timing info
19:00:43.625432 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
19:00:43.624710 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
19:00:43.626848 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
19:00:43.626926 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
19:00:43.626986 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
19:00:43.626665 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
19:00:43.627601 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
19:00:43.629446 [debug] [Thread-5  ]: finished collecting timing info
19:00:43.629536 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
19:00:43.629604 [debug] [Thread-5  ]: finished collecting timing info
19:00:43.628894 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
19:00:43.630033 [debug] [Thread-2  ]: finished collecting timing info
19:00:43.624654 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
19:00:43.630388 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
19:00:43.630482 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
19:00:43.630542 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
19:00:43.630193 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
19:00:43.631234 [debug] [Thread-2  ]: finished collecting timing info
19:00:43.631087 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
19:00:43.639652 [debug] [Thread-4  ]: finished collecting timing info
19:00:43.639879 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
19:00:43.639955 [debug] [Thread-4  ]: finished collecting timing info
19:00:43.638245 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
19:00:43.629807 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
19:00:43.626505 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
19:00:43.640394 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
19:00:43.626577 [debug] [Thread-1  ]: finished collecting timing info
19:00:43.640646 [debug] [Thread-3  ]: finished collecting timing info
19:00:43.640840 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
19:00:43.641258 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
19:00:43.641420 [debug] [Thread-1  ]: finished collecting timing info
19:00:43.641823 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
19:00:43.642284 [debug] [Thread-7  ]: Began running node model.first_project.customers
19:00:43.642465 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers"
19:00:43.642540 [debug] [Thread-7  ]: Began compiling node model.first_project.customers
19:00:43.642609 [debug] [Thread-7  ]: Compiling model.first_project.customers
19:00:43.644045 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers"
19:00:43.644341 [debug] [Thread-7  ]: finished collecting timing info
19:00:43.644432 [debug] [Thread-7  ]: Began executing node model.first_project.customers
19:00:43.644498 [debug] [Thread-7  ]: finished collecting timing info
19:00:43.644690 [debug] [Thread-7  ]: Finished running node model.first_project.customers
19:00:43.644791 [debug] [Thread-7  ]: Began running node model.first_project.customers2
19:00:43.645056 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers2"
19:00:43.645145 [debug] [Thread-7  ]: Began compiling node model.first_project.customers2
19:00:43.645207 [debug] [Thread-7  ]: Compiling model.first_project.customers2
19:00:43.647693 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers2"
19:00:43.647855 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
19:00:43.648605 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
19:00:43.648696 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
19:00:43.649456 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
19:00:43.650888 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
19:00:43.651147 [debug] [Thread-8  ]: finished collecting timing info
19:00:43.651277 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
19:00:43.651350 [debug] [Thread-8  ]: finished collecting timing info
19:00:43.651566 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
19:00:43.647934 [debug] [Thread-9  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:00:43.651744 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
19:00:43.651831 [debug] [Thread-9  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:00:43.652015 [debug] [Thread-9  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:00:43.647993 [debug] [Thread-10 ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:00:43.657578 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
19:00:43.658178 [debug] [Thread-10 ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:00:43.658312 [debug] [Thread-10 ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
19:00:43.661832 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
19:00:43.662361 [debug] [Thread-5  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:00:43.662586 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
19:00:43.662664 [debug] [Thread-5  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:00:43.662723 [debug] [Thread-5  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:00:43.665411 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
19:00:43.665529 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:00:43.666249 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:00:43.668968 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
19:00:43.669056 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:00:43.668451 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
19:00:43.669217 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:00:43.669289 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:00:43.669126 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:00:43.666311 [debug] [Thread-10 ]: finished collecting timing info
19:00:43.666156 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
19:00:43.671972 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
19:00:43.668657 [debug] [Thread-5  ]: finished collecting timing info
19:00:43.675106 [debug] [Thread-5  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:00:43.673969 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
19:00:43.674219 [debug] [Thread-10 ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:00:43.676858 [debug] [Thread-10 ]: finished collecting timing info
19:00:43.677147 [debug] [Thread-10 ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:00:43.676717 [debug] [Thread-4  ]: finished collecting timing info
19:00:43.676490 [debug] [Thread-9  ]: finished collecting timing info
19:00:43.677270 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:00:43.677718 [debug] [Thread-4  ]: finished collecting timing info
19:00:43.678037 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:00:43.668746 [debug] [Thread-7  ]: finished collecting timing info
19:00:43.677484 [debug] [Thread-9  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:00:43.678192 [debug] [Thread-7  ]: Began executing node model.first_project.customers2
19:00:43.678531 [debug] [Thread-7  ]: finished collecting timing info
19:00:43.678786 [debug] [Thread-7  ]: Finished running node model.first_project.customers2
19:00:43.675416 [debug] [Thread-2  ]: finished collecting timing info
19:00:43.675240 [debug] [Thread-5  ]: finished collecting timing info
19:00:43.679129 [debug] [Thread-5  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:00:43.678928 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:00:43.679251 [debug] [Thread-2  ]: finished collecting timing info
19:00:43.678399 [debug] [Thread-9  ]: finished collecting timing info
19:00:43.679469 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:00:43.679717 [debug] [Thread-9  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:00:43.680712 [debug] [MainThread]: Connection 'master' was properly closed.
19:00:43.680797 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
19:00:43.680851 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
19:00:43.680899 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
19:00:43.680946 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
19:00:43.680993 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
19:00:43.681037 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
19:00:43.681088 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
19:00:43.681134 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
19:00:43.681178 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
19:00:43.683856 [info ] [MainThread]: Done.
19:00:43.689910 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
19:00:43.690082 [info ] [MainThread]: Building catalog
19:00:43.691394 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
19:00:43.702112 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
19:00:43.702336 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
19:00:43.702405 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:00:43.706707 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:00:43.706914 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
19:00:43.707006 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
19:00:43.721049 [debug] [ThreadPool]: SQL status: SELECT 77 in 0.01 seconds
19:00:43.732106 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
19:00:43.732720 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
19:00:43.740935 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/dbt_first_project/target/catalog.json
19:00:43.741380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5de0f71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ddae6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ddae6850>]}
19:00:44.628550 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
19:00:44.629718 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 19:01:49.602249 | 29615a87-ac90-424e-a24d-6ee905eba684 ==============================
19:01:49.602262 [info ] [MainThread]: Running with dbt=1.1.0
19:01:49.602629 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
19:01:49.602723 [debug] [MainThread]: Tracking: tracking
19:01:49.605022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b0491e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b0491ef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b0491e070>]}
19:01:49.606655 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
19:01:49.606846 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
19:01:49.606954 [info ] [MainThread]: 
19:01:49.607050 [info ] [MainThread]: 
19:01:49.607145 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-10 19:17:00.375108 | f01c92e3-0052-41f4-aa0f-401f150ee7d8 ==============================
19:17:00.375120 [info ] [MainThread]: Running with dbt=1.1.0
19:17:00.377013 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:17:00.377106 [debug] [MainThread]: Tracking: tracking
19:17:00.379468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9131188c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9131188f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91311880d0>]}
19:17:00.392665 [info ] [MainThread]: Unable to do partial parsing because profile has changed
19:17:00.392990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f01c92e3-0052-41f4-aa0f-401f150ee7d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913118c6a0>]}
19:17:00.399759 [debug] [MainThread]: Parsing macros/catalog.sql
19:17:00.401745 [debug] [MainThread]: Parsing macros/relations.sql
19:17:00.402536 [debug] [MainThread]: Parsing macros/adapters.sql
19:17:00.416905 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
19:17:00.417936 [debug] [MainThread]: Parsing macros/materializations/configs.sql
19:17:00.419211 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
19:17:00.421370 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
19:17:00.427032 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
19:17:00.435597 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
19:17:00.444552 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
19:17:00.447169 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
19:17:00.448073 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
19:17:00.448896 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
19:17:00.450262 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
19:17:00.451728 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
19:17:00.455575 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
19:17:00.459610 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
19:17:00.461258 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
19:17:00.470288 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
19:17:00.473873 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
19:17:00.474962 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
19:17:00.477570 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
19:17:00.478603 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
19:17:00.485594 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
19:17:00.494902 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
19:17:00.500926 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
19:17:00.501855 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
19:17:00.503275 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
19:17:00.504156 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
19:17:00.505028 [debug] [MainThread]: Parsing macros/adapters/columns.sql
19:17:00.510494 [debug] [MainThread]: Parsing macros/adapters/relation.sql
19:17:00.515680 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
19:17:00.517341 [debug] [MainThread]: Parsing macros/adapters/schema.sql
19:17:00.518619 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
19:17:00.520163 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
19:17:00.524047 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
19:17:00.526763 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
19:17:00.527257 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
19:17:00.527726 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
19:17:00.528110 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
19:17:00.528947 [debug] [MainThread]: Parsing macros/etc/datetime.sql
19:17:00.533571 [debug] [MainThread]: Parsing macros/etc/statement.sql
19:17:00.536103 [debug] [MainThread]: Parsing tests/generic/builtin.sql
19:17:00.662113 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers2.sql
19:17:00.669355 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
19:17:00.670849 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
19:17:00.672508 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
19:17:00.673879 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
19:17:00.675181 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
19:17:00.676530 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
19:17:00.723623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f01c92e3-0052-41f4-aa0f-401f150ee7d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91311095e0>]}
19:17:00.726747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f01c92e3-0052-41f4-aa0f-401f150ee7d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9131188ee0>]}
19:17:00.726932 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
19:17:00.727161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f01c92e3-0052-41f4-aa0f-401f150ee7d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913118c1f0>]}
19:17:00.728097 [info ] [MainThread]: 
19:17:00.728484 [debug] [MainThread]: Acquiring new postgres connection "master"
19:17:00.729170 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
19:17:00.735032 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
19:17:00.735143 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
19:17:00.735234 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:17:00.741770 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
19:17:00.742562 [debug] [ThreadPool]: On list_erp_oltp: Close
19:17:00.744013 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
19:17:00.749977 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
19:17:00.750187 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
19:17:00.750254 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:17:00.759675 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:17:00.759857 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
19:17:00.759918 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:17:00.761373 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
19:17:00.762274 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
19:17:00.762705 [debug] [ThreadPool]: On list_erp_oltp_public: Close
19:17:00.766152 [debug] [MainThread]: Using postgres connection "master"
19:17:00.766326 [debug] [MainThread]: On master: BEGIN
19:17:00.766396 [debug] [MainThread]: Opening a new connection, currently in state init
19:17:00.771597 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:17:00.771748 [debug] [MainThread]: Using postgres connection "master"
19:17:00.771809 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:17:00.781527 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
19:17:00.782441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f01c92e3-0052-41f4-aa0f-401f150ee7d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913106a850>]}
19:17:00.782653 [debug] [MainThread]: On master: ROLLBACK
19:17:00.782987 [debug] [MainThread]: Using postgres connection "master"
19:17:00.783078 [debug] [MainThread]: On master: BEGIN
19:17:00.783550 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:17:00.783643 [debug] [MainThread]: On master: COMMIT
19:17:00.783704 [debug] [MainThread]: Using postgres connection "master"
19:17:00.783755 [debug] [MainThread]: On master: COMMIT
19:17:00.783978 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:17:00.784076 [debug] [MainThread]: On master: Close
19:17:00.784457 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
19:17:00.784651 [info ] [MainThread]: 
19:17:00.790052 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
19:17:00.790240 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
19:17:00.790488 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
19:17:00.790562 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
19:17:00.790653 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
19:17:00.792068 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
19:17:00.792355 [debug] [Thread-1  ]: finished collecting timing info
19:17:00.792447 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
19:17:00.802253 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
19:17:00.802576 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
19:17:00.802916 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
19:17:00.803016 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
19:17:00.803095 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
19:17:00.806115 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
19:17:00.806371 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
19:17:00.806546 [info ] [Thread-3  ]: 3 of 7 START table model public.stg_customers .................................. [RUN]
19:17:00.806807 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
19:17:00.806881 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
19:17:00.806948 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
19:17:00.807607 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
19:17:00.807798 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
19:17:00.807940 [info ] [Thread-4  ]: 4 of 7 START table model public.stg_orders ..................................... [RUN]
19:17:00.808360 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
19:17:00.808443 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
19:17:00.808528 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
19:17:00.809175 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
19:17:00.809372 [debug] [Thread-4  ]: finished collecting timing info
19:17:00.809526 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
19:17:00.815605 [debug] [Thread-3  ]: finished collecting timing info
19:17:00.815830 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
19:17:00.829452 [debug] [Thread-2  ]: finished collecting timing info
19:17:00.829840 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
19:17:00.847945 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
19:17:00.852142 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
19:17:00.853022 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
19:17:00.857388 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
19:17:00.857776 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
19:17:00.857981 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
19:17:00.858190 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
19:17:00.858608 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
19:17:00.858457 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
19:17:00.858687 [debug] [Thread-4  ]: Opening a new connection, currently in state init
19:17:00.858346 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
19:17:00.859299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:17:00.859632 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
19:17:00.859750 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
19:17:00.859804 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:17:00.858799 [debug] [Thread-3  ]: Opening a new connection, currently in state init
19:17:00.864323 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
19:17:00.864588 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
19:17:00.864659 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
19:17:00.866078 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
19:17:00.866288 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
19:17:00.866353 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
19:17:00.866444 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
19:17:00.866506 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
19:17:00.866555 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */


  create  table "erp_oltp"."public"."stg_orders__dbt_tmp"
  as (
    with orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
)
select * from orders
  );
19:17:00.870742 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
19:17:00.870892 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
19:17:00.870955 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)
select * from customers
  );
19:17:00.875644 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
19:17:00.880006 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
19:17:00.880139 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.02 seconds
19:17:00.881640 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
19:17:00.881735 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
19:17:00.880223 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
19:17:00.882114 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
19:17:00.883435 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
19:17:00.883515 [debug] [Thread-4  ]: SQL status: SELECT 295 in 0.02 seconds
19:17:00.884726 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
19:17:00.884814 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
19:17:00.883585 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
19:17:00.884917 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.01 seconds
19:17:00.886112 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
19:17:00.886202 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
19:17:00.886291 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:17:00.887767 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
19:17:00.887856 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
19:17:00.889633 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
19:17:00.889718 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
19:17:00.887917 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
19:17:00.888058 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
19:17:00.894378 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
19:17:00.894482 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
19:17:00.894571 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
19:17:00.893185 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
19:17:00.897938 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
19:17:00.897684 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
19:17:00.897848 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
19:17:00.898026 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
19:17:00.887984 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
19:17:00.898911 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
19:17:00.899445 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
19:17:00.899526 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
19:17:00.898116 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
19:17:00.899883 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:17:00.899996 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
19:17:00.900854 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
19:17:00.900999 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
19:17:00.901121 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
19:17:00.905173 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
19:17:00.904182 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
19:17:00.905357 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
19:17:00.905272 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
19:17:00.901234 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
19:17:00.904338 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
19:17:00.905720 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
19:17:00.906546 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
19:17:00.907048 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop table if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
19:17:00.907499 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
19:17:00.908156 [debug] [Thread-3  ]: finished collecting timing info
19:17:00.908317 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
19:17:00.909698 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
19:17:00.909801 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
19:17:00.911413 [debug] [Thread-4  ]: finished collecting timing info
19:17:00.910130 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:17:00.910773 [debug] [Thread-2  ]: finished collecting timing info
19:17:00.912483 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
19:17:00.910055 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f01c92e3-0052-41f4-aa0f-401f150ee7d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9130312e50>]}
19:17:00.912370 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
19:17:00.913878 [info ] [Thread-3  ]: 3 of 7 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.10s]
19:17:00.914473 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
19:17:00.914001 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
19:17:00.914221 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f01c92e3-0052-41f4-aa0f-401f150ee7d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91310d97f0>]}
19:17:00.915481 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.11s]
19:17:00.914801 [debug] [Thread-6  ]: Began running node model.first_project.customers2
19:17:00.911511 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
19:17:00.916223 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
19:17:00.915856 [info ] [Thread-6  ]: 5 of 7 START table model public.customers2 ..................................... [RUN]
19:17:00.917189 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
19:17:00.917269 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
19:17:00.915714 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
19:17:00.917338 [debug] [Thread-6  ]: Compiling model.first_project.customers2
19:17:00.919314 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
19:17:00.917545 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f01c92e3-0052-41f4-aa0f-401f150ee7d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9131109fd0>]}
19:17:00.916882 [debug] [Thread-1  ]: finished collecting timing info
19:17:00.919588 [info ] [Thread-4  ]: 4 of 7 OK created table model public.stg_orders ................................ [[32mSELECT 295[0m in 0.11s]
19:17:00.919754 [debug] [Thread-6  ]: finished collecting timing info
19:17:00.920240 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
19:17:00.920127 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
19:17:00.921993 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
19:17:00.919892 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
19:17:00.922366 [debug] [Thread-8  ]: Began running node model.first_project.customers
19:17:00.922685 [info ] [Thread-8  ]: 6 of 7 START table model public.customers ...................................... [RUN]
19:17:00.922917 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
19:17:00.922998 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
19:17:00.923058 [debug] [Thread-8  ]: Compiling model.first_project.customers
19:17:00.924447 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
19:17:00.924617 [debug] [Thread-8  ]: finished collecting timing info
19:17:00.924735 [debug] [Thread-8  ]: Began executing node model.first_project.customers
19:17:00.926060 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
19:17:00.926231 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
19:17:00.926338 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
19:17:00.926389 [debug] [Thread-8  ]: Opening a new connection, currently in state init
19:17:00.922542 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
19:17:00.927609 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
19:17:00.927685 [debug] [Thread-6  ]: Opening a new connection, currently in state init
19:17:00.928331 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f01c92e3-0052-41f4-aa0f-401f150ee7d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913035ab80>]}
19:17:00.928525 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.14s]
19:17:00.928795 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
19:17:00.929590 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
19:17:00.929767 [info ] [Thread-10 ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
19:17:00.929995 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
19:17:00.930065 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
19:17:00.930126 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
19:17:00.931446 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
19:17:00.931692 [debug] [Thread-10 ]: finished collecting timing info
19:17:00.931828 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
19:17:00.933135 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
19:17:00.933323 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
19:17:00.933430 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: BEGIN
19:17:00.933484 [debug] [Thread-10 ]: Opening a new connection, currently in state init
19:17:00.935963 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
19:17:00.936064 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
19:17:00.936120 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
 customers.state
 from customers
 left join customer_orders using (customer_id)
 WHERE customers.customer_id != 63
)
select * from final
  );
19:17:00.940960 [debug] [Thread-10 ]: SQL status: BEGIN in 0.01 seconds
19:17:00.941090 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
19:17:00.941149 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
19:17:00.942336 [debug] [Thread-8  ]: SQL status: SELECT 98 in 0.01 seconds
19:17:00.943935 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
19:17:00.944030 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
19:17:00.944296 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
19:17:00.945456 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
19:17:00.945534 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
19:17:00.945710 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
19:17:00.946617 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
19:17:00.946697 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
19:17:00.946752 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
19:17:00.949553 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
19:17:00.953564 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
19:17:00.953743 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
19:17:00.954328 [debug] [Thread-10 ]: SQL status: CREATE VIEW in 0.01 seconds
19:17:00.955775 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
19:17:00.955879 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
19:17:00.956409 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
19:17:00.956502 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
19:17:00.956566 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
19:17:00.956669 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
19:17:00.957450 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
19:17:00.957531 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
19:17:00.957584 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
19:17:00.957988 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
19:17:00.959635 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
19:17:00.959750 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
19:17:00.959880 [debug] [Thread-8  ]: SQL status: DROP TABLE in 0.01 seconds
19:17:00.960039 [debug] [Thread-10 ]: SQL status: COMMIT in 0.0 seconds
19:17:00.961554 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
19:17:00.961636 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
19:17:00.960680 [debug] [Thread-8  ]: finished collecting timing info
19:17:00.961750 [debug] [Thread-8  ]: On model.first_project.customers: Close
19:17:00.963202 [debug] [Thread-10 ]: SQL status: DROP VIEW in 0.0 seconds
19:17:00.963317 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
19:17:00.964288 [debug] [Thread-10 ]: finished collecting timing info
19:17:00.966201 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: Close
19:17:00.966033 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
19:17:00.966335 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
19:17:00.966701 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
19:17:00.964574 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f01c92e3-0052-41f4-aa0f-401f150ee7d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913035abb0>]}
19:17:00.967531 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
19:17:00.967860 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f01c92e3-0052-41f4-aa0f-401f150ee7d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913025ffd0>]}
19:17:00.968494 [info ] [Thread-10 ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
19:17:00.968281 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
19:17:00.968757 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
19:17:00.968109 [info ] [Thread-8  ]: 6 of 7 OK created table model public.customers ................................. [[32mSELECT 98[0m in 0.04s]
19:17:00.968852 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
19:17:00.969195 [debug] [Thread-8  ]: Finished running node model.first_project.customers
19:17:00.970295 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
19:17:00.971403 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
19:17:00.971513 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
19:17:00.973238 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
19:17:00.974648 [debug] [Thread-6  ]: finished collecting timing info
19:17:00.974770 [debug] [Thread-6  ]: On model.first_project.customers2: Close
19:17:00.975077 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f01c92e3-0052-41f4-aa0f-401f150ee7d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91302a22e0>]}
19:17:00.975293 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.06s]
19:17:00.976495 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
19:17:00.978660 [debug] [MainThread]: Acquiring new postgres connection "master"
19:17:00.978969 [debug] [MainThread]: Using postgres connection "master"
19:17:00.979101 [debug] [MainThread]: On master: BEGIN
19:17:00.979192 [debug] [MainThread]: Opening a new connection, currently in state closed
19:17:00.991588 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:17:00.991864 [debug] [MainThread]: On master: COMMIT
19:17:00.991945 [debug] [MainThread]: Using postgres connection "master"
19:17:00.992030 [debug] [MainThread]: On master: COMMIT
19:17:00.992262 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:17:00.992384 [debug] [MainThread]: On master: Close
19:17:00.992985 [info ] [MainThread]: 
19:17:00.993200 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0.26s.
19:17:00.993307 [debug] [MainThread]: Connection 'master' was properly closed.
19:17:00.993358 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
19:17:00.993404 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
19:17:00.993449 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
19:17:00.993495 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
19:17:00.993540 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
19:17:00.993586 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
19:17:00.993631 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
19:17:00.997555 [info ] [MainThread]: 
19:17:00.997786 [info ] [MainThread]: [32mCompleted successfully[0m
19:17:00.997988 [info ] [MainThread]: 
19:17:00.998087 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
19:17:00.998277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9131109730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91311096d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9130baba90>]}


============================== 2022-06-10 19:17:16.566414 | 46ef6583-f01d-46bd-860f-a2ee22d92253 ==============================
19:17:16.566425 [info ] [MainThread]: Running with dbt=1.1.0
19:17:16.566890 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
19:17:16.566976 [debug] [MainThread]: Tracking: tracking
19:17:16.569311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097e849460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097e849250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097e849310>]}
19:17:16.587358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:17:16.587510 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:17:16.591470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46ef6583-f01d-46bd-860f-a2ee22d92253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097e6fd0d0>]}
19:17:16.598571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46ef6583-f01d-46bd-860f-a2ee22d92253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097e7514f0>]}
19:17:16.598872 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
19:17:16.599009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46ef6583-f01d-46bd-860f-a2ee22d92253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097e751580>]}
19:17:16.600249 [info ] [MainThread]: 
19:17:16.600595 [debug] [MainThread]: Acquiring new postgres connection "master"
19:17:16.605439 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
19:17:16.612311 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
19:17:16.612505 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
19:17:16.612570 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:17:16.617449 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:17:16.617630 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
19:17:16.617694 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:17:16.618972 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
19:17:16.620040 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
19:17:16.620209 [debug] [ThreadPool]: On list_erp_oltp_public: Close
19:17:16.622915 [debug] [MainThread]: Using postgres connection "master"
19:17:16.623002 [debug] [MainThread]: On master: BEGIN
19:17:16.623059 [debug] [MainThread]: Opening a new connection, currently in state init
19:17:16.637019 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:17:16.637241 [debug] [MainThread]: Using postgres connection "master"
19:17:16.637322 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:17:16.647537 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
19:17:16.648649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46ef6583-f01d-46bd-860f-a2ee22d92253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097e7511f0>]}
19:17:16.648858 [debug] [MainThread]: On master: ROLLBACK
19:17:16.649560 [debug] [MainThread]: On master: Close
19:17:16.649883 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
19:17:16.650093 [info ] [MainThread]: 
19:17:16.653367 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
19:17:16.653658 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
19:17:16.653760 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
19:17:16.653846 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
19:17:16.655482 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
19:17:16.655752 [debug] [Thread-1  ]: finished collecting timing info
19:17:16.655903 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
19:17:16.656005 [debug] [Thread-1  ]: finished collecting timing info
19:17:16.656322 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
19:17:16.656433 [debug] [Thread-1  ]: Began running node model.first_project.postgres_sample_source_customers
19:17:16.656593 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
19:17:16.656659 [debug] [Thread-1  ]: Began compiling node model.first_project.postgres_sample_source_customers
19:17:16.656720 [debug] [Thread-1  ]: Compiling model.first_project.postgres_sample_source_customers
19:17:16.664393 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
19:17:16.664628 [debug] [Thread-2  ]: Began running node model.first_project.stg_customers
19:17:16.665625 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.stg_customers"
19:17:16.665778 [debug] [Thread-2  ]: Began compiling node model.first_project.stg_customers
19:17:16.665898 [debug] [Thread-2  ]: Compiling model.first_project.stg_customers
19:17:16.664716 [debug] [Thread-3  ]: Began running node model.first_project.stg_orders
19:17:16.665291 [debug] [Thread-8  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:17:16.664816 [debug] [Thread-4  ]: Began running node seed.first_project.code-country
19:17:16.665232 [debug] [Thread-7  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:17:16.694861 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
19:17:16.694953 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:17:16.693441 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.stg_customers"
19:17:16.694098 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
19:17:16.695303 [debug] [Thread-8  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:17:16.694608 [debug] [Thread-4  ]: Acquiring new postgres connection "seed.first_project.code-country"
19:17:16.695574 [debug] [Thread-4  ]: Began compiling node seed.first_project.code-country
19:17:16.695048 [debug] [Thread-7  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:17:16.665149 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
19:17:16.695410 [debug] [Thread-8  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
19:17:16.707801 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
19:17:16.693766 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_orders"
19:17:16.708094 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_orders
19:17:16.695658 [debug] [Thread-4  ]: Compiling seed.first_project.code-country
19:17:16.709084 [debug] [Thread-4  ]: Writing injected SQL for node "seed.first_project.code-country"
19:17:16.709175 [debug] [Thread-4  ]: finished collecting timing info
19:17:16.709241 [debug] [Thread-4  ]: Began executing node seed.first_project.code-country
19:17:16.709308 [debug] [Thread-4  ]: finished collecting timing info
19:17:16.709515 [debug] [Thread-4  ]: Finished running node seed.first_project.code-country
19:17:16.701917 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
19:17:16.709748 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
19:17:16.709827 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
19:17:16.710933 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
19:17:16.711127 [debug] [Thread-6  ]: finished collecting timing info
19:17:16.711242 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
19:17:16.711321 [debug] [Thread-6  ]: finished collecting timing info
19:17:16.711515 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
19:17:16.708195 [debug] [Thread-3  ]: Compiling model.first_project.stg_orders
19:17:16.712129 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_orders"
19:17:16.712775 [debug] [Thread-3  ]: finished collecting timing info
19:17:16.712881 [debug] [Thread-3  ]: Began executing node model.first_project.stg_orders
19:17:16.713006 [debug] [Thread-3  ]: finished collecting timing info
19:17:16.713212 [debug] [Thread-3  ]: Finished running node model.first_project.stg_orders
19:17:16.712421 [debug] [Thread-10 ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:17:16.713480 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
19:17:16.713557 [debug] [Thread-10 ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:17:16.713618 [debug] [Thread-10 ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:17:16.715531 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
19:17:16.715741 [debug] [Thread-10 ]: finished collecting timing info
19:17:16.715823 [debug] [Thread-10 ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:17:16.715928 [debug] [Thread-10 ]: finished collecting timing info
19:17:16.716114 [debug] [Thread-10 ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:17:16.712535 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:17:16.716305 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
19:17:16.716381 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:17:16.716438 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:17:16.718317 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
19:17:16.719403 [debug] [Thread-5  ]: finished collecting timing info
19:17:16.719492 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:17:16.719562 [debug] [Thread-5  ]: finished collecting timing info
19:17:16.719744 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:17:16.708347 [debug] [Thread-8  ]: finished collecting timing info
19:17:16.719861 [debug] [Thread-8  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:17:16.719943 [debug] [Thread-8  ]: finished collecting timing info
19:17:16.720113 [debug] [Thread-8  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:17:16.694286 [debug] [Thread-1  ]: finished collecting timing info
19:17:16.720228 [debug] [Thread-1  ]: Began executing node model.first_project.postgres_sample_source_customers
19:17:16.720317 [debug] [Thread-1  ]: finished collecting timing info
19:17:16.720494 [debug] [Thread-1  ]: Finished running node model.first_project.postgres_sample_source_customers
19:17:16.704507 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
19:17:16.702125 [debug] [Thread-2  ]: finished collecting timing info
19:17:16.720940 [debug] [Thread-2  ]: Began executing node model.first_project.stg_customers
19:17:16.721044 [debug] [Thread-2  ]: finished collecting timing info
19:17:16.721228 [debug] [Thread-2  ]: Finished running node model.first_project.stg_customers
19:17:16.720827 [debug] [Thread-7  ]: finished collecting timing info
19:17:16.721323 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:17:16.721384 [debug] [Thread-7  ]: finished collecting timing info
19:17:16.721546 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:17:16.721999 [debug] [Thread-4  ]: Began running node model.first_project.customers
19:17:16.722168 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.customers"
19:17:16.722245 [debug] [Thread-4  ]: Began compiling node model.first_project.customers
19:17:16.722305 [debug] [Thread-4  ]: Compiling model.first_project.customers
19:17:16.723507 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.customers"
19:17:16.723695 [debug] [Thread-4  ]: finished collecting timing info
19:17:16.723843 [debug] [Thread-4  ]: Began executing node model.first_project.customers
19:17:16.723920 [debug] [Thread-4  ]: finished collecting timing info
19:17:16.724101 [debug] [Thread-4  ]: Finished running node model.first_project.customers
19:17:16.724188 [debug] [Thread-4  ]: Began running node model.first_project.customers2
19:17:16.724440 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.customers2"
19:17:16.724513 [debug] [Thread-4  ]: Began compiling node model.first_project.customers2
19:17:16.724574 [debug] [Thread-4  ]: Compiling model.first_project.customers2
19:17:16.725699 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.customers2"
19:17:16.725865 [debug] [Thread-4  ]: finished collecting timing info
19:17:16.725951 [debug] [Thread-4  ]: Began executing node model.first_project.customers2
19:17:16.726093 [debug] [Thread-4  ]: finished collecting timing info
19:17:16.726279 [debug] [Thread-4  ]: Finished running node model.first_project.customers2
19:17:16.726567 [debug] [Thread-6  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:17:16.726736 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
19:17:16.726807 [debug] [Thread-6  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:17:16.726863 [debug] [Thread-6  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:17:16.732304 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
19:17:16.732655 [debug] [Thread-6  ]: finished collecting timing info
19:17:16.732762 [debug] [Thread-6  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:17:16.732858 [debug] [Thread-6  ]: finished collecting timing info
19:17:16.733066 [debug] [Thread-6  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:17:16.734194 [debug] [MainThread]: Connection 'master' was properly closed.
19:17:16.734277 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
19:17:16.734330 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
19:17:16.734399 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
19:17:16.734447 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
19:17:16.734493 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
19:17:16.734538 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
19:17:16.734583 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
19:17:16.734629 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
19:17:16.734675 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
19:17:16.737812 [info ] [MainThread]: Done.
19:17:16.739341 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
19:17:16.739444 [info ] [MainThread]: Building catalog
19:17:16.740874 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
19:17:16.744675 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
19:17:16.744767 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
19:17:16.744824 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:17:16.749696 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:17:16.749847 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
19:17:16.749906 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
19:17:16.757722 [debug] [ThreadPool]: SQL status: SELECT 77 in 0.01 seconds
19:17:16.764533 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
19:17:16.768020 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
19:17:16.774538 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/dbt_first_project/target/catalog.json
19:17:16.774910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f097e849460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098006a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f098006a340>]}
19:17:17.397206 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
19:17:17.398137 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 19:17:28.226417 | cc3bcde4-54c1-441e-b6a8-3e628d0bfa4a ==============================
19:17:28.226429 [info ] [MainThread]: Running with dbt=1.1.0
19:17:28.226737 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
19:17:28.226815 [debug] [MainThread]: Tracking: tracking
19:17:28.229315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97b3f755b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97b3f75f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97b3f75070>]}
19:17:28.230864 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
19:17:28.231069 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
19:17:28.231175 [info ] [MainThread]: 
19:17:28.231266 [info ] [MainThread]: 
19:17:28.231360 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-10 19:33:15.099654 | 8c33be0a-ad56-40ce-8e55-3a5e4f55b970 ==============================
19:33:15.099679 [info ] [MainThread]: Running with dbt=1.1.0
19:33:15.100142 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
19:33:15.100247 [debug] [MainThread]: Tracking: tracking
19:33:15.102732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae2ed47f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae2ed4a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae2ed4f70>]}
19:33:15.120964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
19:33:15.121276 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/docs.md
19:33:15.127618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c33be0a-ad56-40ce-8e55-3a5e4f55b970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae2d1cf70>]}
19:33:15.131001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c33be0a-ad56-40ce-8e55-3a5e4f55b970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae2dd1e20>]}
19:33:15.131260 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
19:33:15.131404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c33be0a-ad56-40ce-8e55-3a5e4f55b970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae2dcadc0>]}
19:33:15.132959 [info ] [MainThread]: 
19:33:15.133325 [debug] [MainThread]: Acquiring new postgres connection "master"
19:33:15.134341 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
19:33:15.142282 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
19:33:15.142459 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
19:33:15.142524 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:33:15.147012 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:33:15.147136 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
19:33:15.147193 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:33:15.148471 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
19:33:15.149518 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
19:33:15.149809 [debug] [ThreadPool]: On list_erp_oltp_public: Close
19:33:15.152950 [debug] [MainThread]: Using postgres connection "master"
19:33:15.153212 [debug] [MainThread]: On master: BEGIN
19:33:15.153368 [debug] [MainThread]: Opening a new connection, currently in state init
19:33:15.161064 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:33:15.161281 [debug] [MainThread]: Using postgres connection "master"
19:33:15.161357 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:33:15.173465 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
19:33:15.174374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c33be0a-ad56-40ce-8e55-3a5e4f55b970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae2dd1ca0>]}
19:33:15.174588 [debug] [MainThread]: On master: ROLLBACK
19:33:15.174867 [debug] [MainThread]: On master: Close
19:33:15.175214 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
19:33:15.175365 [info ] [MainThread]: 
19:33:15.180615 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
19:33:15.180863 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
19:33:15.180945 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
19:33:15.181020 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
19:33:15.182777 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
19:33:15.183010 [debug] [Thread-1  ]: finished collecting timing info
19:33:15.183167 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
19:33:15.183586 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
19:33:15.183655 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
19:33:15.183717 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
19:33:15.183285 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
19:33:15.215678 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
19:33:15.215848 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
19:33:15.215928 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
19:33:15.183230 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
19:33:15.216589 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
19:33:15.218381 [debug] [Thread-4  ]: finished collecting timing info
19:33:15.218492 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
19:33:15.218596 [debug] [Thread-4  ]: finished collecting timing info
19:33:15.218837 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
19:33:15.183340 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
19:33:15.219202 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
19:33:15.219303 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
19:33:15.218079 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
19:33:15.219743 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
19:33:15.219827 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
19:33:15.219406 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
19:33:15.221413 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
19:33:15.221516 [debug] [Thread-5  ]: finished collecting timing info
19:33:15.221591 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
19:33:15.220624 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
19:33:15.221661 [debug] [Thread-5  ]: finished collecting timing info
19:33:15.222146 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
19:33:15.183415 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
19:33:15.222263 [debug] [Thread-1  ]: finished collecting timing info
19:33:15.222453 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
19:33:15.217877 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
19:33:15.222993 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
19:33:15.223190 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
19:33:15.223264 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
19:33:15.223322 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
19:33:15.224548 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
19:33:15.224789 [debug] [Thread-7  ]: finished collecting timing info
19:33:15.224909 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
19:33:15.224977 [debug] [Thread-7  ]: finished collecting timing info
19:33:15.225161 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
19:33:15.225254 [debug] [Thread-7  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:33:15.225495 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
19:33:15.225740 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:33:15.225822 [debug] [Thread-7  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:33:15.225344 [debug] [Thread-3  ]: finished collecting timing info
19:33:15.234517 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
19:33:15.231266 [debug] [Thread-8  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:33:15.234835 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
19:33:15.234919 [debug] [Thread-8  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:33:15.234588 [debug] [Thread-3  ]: finished collecting timing info
19:33:15.235483 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
19:33:15.234978 [debug] [Thread-8  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
19:33:15.231352 [debug] [Thread-2  ]: finished collecting timing info
19:33:15.235118 [debug] [Thread-10 ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:33:15.239623 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
19:33:15.239700 [debug] [Thread-10 ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:33:15.239111 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
19:33:15.240175 [debug] [Thread-8  ]: finished collecting timing info
19:33:15.240299 [debug] [Thread-8  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:33:15.239757 [debug] [Thread-10 ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:33:15.242361 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
19:33:15.239917 [debug] [Thread-5  ]: Began running node model.first_project.customers
19:33:15.242819 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customers"
19:33:15.235208 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:33:15.240448 [debug] [Thread-8  ]: finished collecting timing info
19:33:15.243394 [debug] [Thread-8  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:33:15.234404 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
19:33:15.242532 [debug] [Thread-10 ]: finished collecting timing info
19:33:15.242906 [debug] [Thread-5  ]: Began compiling node model.first_project.customers
19:33:15.243919 [debug] [Thread-5  ]: Compiling model.first_project.customers
19:33:15.243093 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
19:33:15.243577 [debug] [Thread-7  ]: finished collecting timing info
19:33:15.245529 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:33:15.243812 [debug] [Thread-10 ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:33:15.245786 [debug] [Thread-10 ]: finished collecting timing info
19:33:15.245206 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customers"
19:33:15.245364 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:33:15.245618 [debug] [Thread-7  ]: finished collecting timing info
19:33:15.246670 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:33:15.239447 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
19:33:15.246774 [debug] [Thread-2  ]: finished collecting timing info
19:33:15.246268 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:33:15.246425 [debug] [Thread-5  ]: finished collecting timing info
19:33:15.249123 [debug] [Thread-5  ]: Began executing node model.first_project.customers
19:33:15.249217 [debug] [Thread-5  ]: finished collecting timing info
19:33:15.239998 [debug] [Thread-1  ]: Began running node model.first_project.customers2
19:33:15.249636 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers2"
19:33:15.249717 [debug] [Thread-1  ]: Began compiling node model.first_project.customers2
19:33:15.249780 [debug] [Thread-1  ]: Compiling model.first_project.customers2
19:33:15.249404 [debug] [Thread-5  ]: Finished running node model.first_project.customers
19:33:15.246947 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
19:33:15.250991 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers2"
19:33:15.248903 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
19:33:15.251429 [debug] [Thread-6  ]: finished collecting timing info
19:33:15.251551 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:33:15.251616 [debug] [Thread-6  ]: finished collecting timing info
19:33:15.251792 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:33:15.246002 [debug] [Thread-10 ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:33:15.252050 [debug] [Thread-1  ]: finished collecting timing info
19:33:15.252194 [debug] [Thread-1  ]: Began executing node model.first_project.customers2
19:33:15.252287 [debug] [Thread-1  ]: finished collecting timing info
19:33:15.252498 [debug] [Thread-1  ]: Finished running node model.first_project.customers2
19:33:15.252880 [debug] [Thread-4  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:33:15.253077 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
19:33:15.253169 [debug] [Thread-4  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:33:15.253232 [debug] [Thread-4  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:33:15.258051 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
19:33:15.258257 [debug] [Thread-4  ]: finished collecting timing info
19:33:15.258337 [debug] [Thread-4  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:33:15.258405 [debug] [Thread-4  ]: finished collecting timing info
19:33:15.258635 [debug] [Thread-4  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:33:15.260318 [debug] [MainThread]: Connection 'master' was properly closed.
19:33:15.260414 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
19:33:15.260466 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
19:33:15.260513 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
19:33:15.260557 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
19:33:15.260619 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
19:33:15.260666 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
19:33:15.260711 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
19:33:15.260754 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
19:33:15.260798 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
19:33:15.263343 [info ] [MainThread]: Done.
19:33:15.264798 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
19:33:15.264878 [info ] [MainThread]: Building catalog
19:33:15.266339 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
19:33:15.270186 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
19:33:15.270282 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
19:33:15.270353 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:33:15.275770 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:33:15.275905 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
19:33:15.275967 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
19:33:15.278328 [debug] [ThreadPool]: SQL status: SELECT 77 in 0.0 seconds
19:33:15.285175 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
19:33:15.285582 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
19:33:15.292847 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/dbt_first_project/target/catalog.json
19:33:15.293235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae2ed0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae2d531f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ae2d53160>]}
19:33:16.149790 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
19:33:16.150469 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 19:33:24.707636 | d3353036-f017-432b-aabb-122e01cc7e20 ==============================
19:33:24.707647 [info ] [MainThread]: Running with dbt=1.1.0
19:33:24.707948 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
19:33:24.708024 [debug] [MainThread]: Tracking: tracking
19:33:24.710385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92117f3be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92117f3370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92117f3310>]}
19:33:24.711888 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
19:33:24.712123 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
19:33:24.712247 [info ] [MainThread]: 
19:33:24.712344 [info ] [MainThread]: 
19:33:24.712438 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-10 19:37:23.153742 | cddc6992-8e83-4889-8985-248f4899ab6f ==============================
19:37:23.153753 [info ] [MainThread]: Running with dbt=1.1.0
19:37:23.154173 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
19:37:23.154263 [debug] [MainThread]: Tracking: tracking
19:37:23.156655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab22135430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab221357c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab22135bb0>]}
19:37:23.174933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
19:37:23.175280 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
19:37:23.175458 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/docs.md
19:37:23.184384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cddc6992-8e83-4889-8985-248f4899ab6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab21f8e0d0>]}
19:37:23.187614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cddc6992-8e83-4889-8985-248f4899ab6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab22030bb0>]}
19:37:23.187826 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
19:37:23.187953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cddc6992-8e83-4889-8985-248f4899ab6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab22030f10>]}
19:37:23.188985 [info ] [MainThread]: 
19:37:23.189241 [debug] [MainThread]: Acquiring new postgres connection "master"
19:37:23.190006 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
19:37:23.197444 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
19:37:23.197625 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
19:37:23.197692 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:37:23.202315 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:37:23.202452 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
19:37:23.202512 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:37:23.203841 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
19:37:23.204939 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
19:37:23.205114 [debug] [ThreadPool]: On list_erp_oltp_public: Close
19:37:23.208132 [debug] [MainThread]: Using postgres connection "master"
19:37:23.208224 [debug] [MainThread]: On master: BEGIN
19:37:23.208310 [debug] [MainThread]: Opening a new connection, currently in state init
19:37:23.214780 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:37:23.215009 [debug] [MainThread]: Using postgres connection "master"
19:37:23.215075 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:37:23.226588 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
19:37:23.227833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cddc6992-8e83-4889-8985-248f4899ab6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab2212d8b0>]}
19:37:23.228063 [debug] [MainThread]: On master: ROLLBACK
19:37:23.228249 [debug] [MainThread]: On master: Close
19:37:23.228748 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
19:37:23.228952 [info ] [MainThread]: 
19:37:23.262764 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
19:37:23.263392 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
19:37:23.263514 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
19:37:23.263597 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
19:37:23.265398 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
19:37:23.265674 [debug] [Thread-1  ]: finished collecting timing info
19:37:23.265765 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
19:37:23.265859 [debug] [Thread-1  ]: finished collecting timing info
19:37:23.266437 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
19:37:23.266543 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
19:37:23.266876 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
19:37:23.266965 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
19:37:23.267028 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
19:37:23.268375 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
19:37:23.268630 [debug] [Thread-2  ]: finished collecting timing info
19:37:23.268737 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
19:37:23.268803 [debug] [Thread-2  ]: finished collecting timing info
19:37:23.269187 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
19:37:23.269313 [debug] [Thread-2  ]: Began running node seed.first_project.code-country
19:37:23.269462 [debug] [Thread-2  ]: Acquiring new postgres connection "seed.first_project.code-country"
19:37:23.269545 [debug] [Thread-2  ]: Began compiling node seed.first_project.code-country
19:37:23.269613 [debug] [Thread-2  ]: Compiling seed.first_project.code-country
19:37:23.266610 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
19:37:23.270590 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
19:37:23.270661 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
19:37:23.270716 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
19:37:23.271278 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
19:37:23.270412 [debug] [Thread-2  ]: Writing injected SQL for node "seed.first_project.code-country"
19:37:23.266695 [debug] [Thread-1  ]: Began running node model.first_project.stg_orders
19:37:23.271420 [debug] [Thread-2  ]: finished collecting timing info
19:37:23.272277 [debug] [Thread-2  ]: Began executing node seed.first_project.code-country
19:37:23.271600 [debug] [Thread-3  ]: finished collecting timing info
19:37:23.272044 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
19:37:23.272819 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
19:37:23.272904 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
19:37:23.271801 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.stg_orders"
19:37:23.272360 [debug] [Thread-2  ]: finished collecting timing info
19:37:23.272524 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
19:37:23.272985 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
19:37:23.274821 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
19:37:23.274988 [debug] [Thread-5  ]: finished collecting timing info
19:37:23.273161 [debug] [Thread-1  ]: Began compiling node model.first_project.stg_orders
19:37:23.273459 [debug] [Thread-2  ]: Finished running node seed.first_project.code-country
19:37:23.273617 [debug] [Thread-3  ]: finished collecting timing info
19:37:23.275104 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
19:37:23.276225 [debug] [Thread-5  ]: finished collecting timing info
19:37:23.272132 [debug] [Thread-6  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:37:23.275201 [debug] [Thread-1  ]: Compiling model.first_project.stg_orders
19:37:23.277334 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.stg_orders"
19:37:23.272195 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:37:23.277805 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
19:37:23.277887 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:37:23.277501 [debug] [Thread-1  ]: finished collecting timing info
19:37:23.276701 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
19:37:23.278217 [debug] [Thread-6  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:37:23.278296 [debug] [Thread-6  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:37:23.278067 [debug] [Thread-1  ]: Began executing node model.first_project.stg_orders
19:37:23.283745 [debug] [Thread-1  ]: finished collecting timing info
19:37:23.284058 [debug] [Thread-1  ]: Finished running node model.first_project.stg_orders
19:37:23.276047 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
19:37:23.277950 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
19:37:23.276516 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
19:37:23.287560 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
19:37:23.290301 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
19:37:23.290726 [debug] [Thread-7  ]: finished collecting timing info
19:37:23.290824 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:37:23.290927 [debug] [Thread-7  ]: finished collecting timing info
19:37:23.291159 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:37:23.291776 [debug] [Thread-6  ]: finished collecting timing info
19:37:23.291887 [debug] [Thread-6  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:37:23.291962 [debug] [Thread-6  ]: finished collecting timing info
19:37:23.292164 [debug] [Thread-9  ]: Began running node model.first_project.customers
19:37:23.292607 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers"
19:37:23.292681 [debug] [Thread-9  ]: Began compiling node model.first_project.customers
19:37:23.292743 [debug] [Thread-9  ]: Compiling model.first_project.customers
19:37:23.294092 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers"
19:37:23.292434 [debug] [Thread-6  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:37:23.294318 [debug] [Thread-10 ]: Began running node model.first_project.customers2
19:37:23.294460 [debug] [Thread-9  ]: finished collecting timing info
19:37:23.295064 [debug] [Thread-9  ]: Began executing node model.first_project.customers
19:37:23.295149 [debug] [Thread-9  ]: finished collecting timing info
19:37:23.294909 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers2"
19:37:23.295518 [debug] [Thread-9  ]: Finished running node model.first_project.customers
19:37:23.294615 [debug] [Thread-8  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:37:23.296034 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
19:37:23.295714 [debug] [Thread-10 ]: Began compiling node model.first_project.customers2
19:37:23.296117 [debug] [Thread-8  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:37:23.296530 [debug] [Thread-8  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:37:23.296291 [debug] [Thread-10 ]: Compiling model.first_project.customers2
19:37:23.298516 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
19:37:23.294548 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:37:23.300704 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers2"
19:37:23.302634 [debug] [Thread-10 ]: finished collecting timing info
19:37:23.302733 [debug] [Thread-10 ]: Began executing node model.first_project.customers2
19:37:23.301024 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
19:37:23.302020 [debug] [Thread-1  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:37:23.302831 [debug] [Thread-8  ]: finished collecting timing info
19:37:23.302951 [debug] [Thread-10 ]: finished collecting timing info
19:37:23.303123 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:37:23.303417 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
19:37:23.303604 [debug] [Thread-8  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:37:23.304026 [debug] [Thread-10 ]: Finished running node model.first_project.customers2
19:37:23.304282 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:37:23.304390 [debug] [Thread-1  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:37:23.304509 [debug] [Thread-8  ]: finished collecting timing info
19:37:23.307348 [debug] [Thread-8  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:37:23.307095 [debug] [Thread-1  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:37:23.306985 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
19:37:23.311744 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
19:37:23.312481 [debug] [Thread-4  ]: finished collecting timing info
19:37:23.312744 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:37:23.312858 [debug] [Thread-4  ]: finished collecting timing info
19:37:23.313243 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:37:23.313355 [debug] [Thread-1  ]: finished collecting timing info
19:37:23.313569 [debug] [Thread-1  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:37:23.313656 [debug] [Thread-1  ]: finished collecting timing info
19:37:23.313920 [debug] [Thread-1  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:37:23.314801 [debug] [MainThread]: Connection 'master' was properly closed.
19:37:23.314879 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
19:37:23.314930 [debug] [MainThread]: Connection 'seed.first_project.code-country' was properly closed.
19:37:23.314976 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
19:37:23.315022 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
19:37:23.315067 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
19:37:23.315111 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
19:37:23.315156 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
19:37:23.315200 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
19:37:23.315244 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
19:37:23.315289 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
19:37:23.317960 [info ] [MainThread]: Done.
19:37:23.319807 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
19:37:23.319883 [info ] [MainThread]: Building catalog
19:37:23.321201 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
19:37:23.325100 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
19:37:23.325186 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
19:37:23.325246 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:37:23.330853 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:37:23.331036 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
19:37:23.331107 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
19:37:23.333376 [debug] [ThreadPool]: SQL status: SELECT 77 in 0.0 seconds
19:37:23.339039 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
19:37:23.342023 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
19:37:23.348212 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/dbt_first_project/target/catalog.json
19:37:23.348602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab22135430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab2211eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab2211ebe0>]}
19:37:24.236780 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
19:37:24.237628 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 19:37:29.621861 | f081dd89-1c0c-4607-8d42-4fc650e6075f ==============================
19:37:29.621872 [info ] [MainThread]: Running with dbt=1.1.0
19:37:29.622288 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
19:37:29.622368 [debug] [MainThread]: Tracking: tracking
19:37:29.624774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f10edec40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f10edeb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f10ede430>]}
19:37:29.626293 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
19:37:29.626487 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
19:37:29.626627 [info ] [MainThread]: 
19:37:29.626723 [info ] [MainThread]: 
19:37:29.626817 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-10 19:40:06.483582 | 2152c70d-3fa3-469b-bae2-0dbb9fca9355 ==============================
19:40:06.483595 [info ] [MainThread]: Running with dbt=1.1.0
19:40:06.484269 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:40:06.484376 [debug] [MainThread]: Tracking: tracking
19:40:06.487359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f324f2b4520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f324f2b49a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f324f2b4400>]}
19:40:06.505580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:40:06.505800 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:40:06.510235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2152c70d-3fa3-469b-bae2-0dbb9fca9355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f324f1650d0>]}
19:40:06.514565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2152c70d-3fa3-469b-bae2-0dbb9fca9355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f324f20e730>]}
19:40:06.514865 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
19:40:06.515029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2152c70d-3fa3-469b-bae2-0dbb9fca9355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f324f20e7c0>]}
19:40:06.516108 [info ] [MainThread]: 
19:40:06.516524 [debug] [MainThread]: Acquiring new postgres connection "master"
19:40:06.517389 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
19:40:06.532882 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
19:40:06.533149 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
19:40:06.533244 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:40:06.540333 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
19:40:06.544804 [debug] [ThreadPool]: On list_erp_oltp: Close
19:40:06.553459 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
19:40:06.557256 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
19:40:06.557418 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
19:40:06.557517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:40:06.562111 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:40:06.562353 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
19:40:06.562451 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:40:06.563783 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
19:40:06.564866 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
19:40:06.565193 [debug] [ThreadPool]: On list_erp_oltp_public: Close
19:40:06.568131 [debug] [MainThread]: Using postgres connection "master"
19:40:06.568286 [debug] [MainThread]: On master: BEGIN
19:40:06.568352 [debug] [MainThread]: Opening a new connection, currently in state init
19:40:06.571963 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:40:06.572078 [debug] [MainThread]: Using postgres connection "master"
19:40:06.572159 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:40:06.581880 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
19:40:06.582913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2152c70d-3fa3-469b-bae2-0dbb9fca9355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3250abfd30>]}
19:40:06.583167 [debug] [MainThread]: On master: ROLLBACK
19:40:06.583475 [debug] [MainThread]: Using postgres connection "master"
19:40:06.583567 [debug] [MainThread]: On master: BEGIN
19:40:06.583985 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:40:06.584166 [debug] [MainThread]: On master: COMMIT
19:40:06.584290 [debug] [MainThread]: Using postgres connection "master"
19:40:06.584363 [debug] [MainThread]: On master: COMMIT
19:40:06.584648 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:40:06.584759 [debug] [MainThread]: On master: Close
19:40:06.585070 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
19:40:06.585271 [info ] [MainThread]: 
19:40:06.590286 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
19:40:06.590499 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
19:40:06.590877 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
19:40:06.590991 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
19:40:06.591098 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
19:40:06.592963 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
19:40:06.593180 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
19:40:06.593323 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
19:40:06.593582 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
19:40:06.593799 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
19:40:06.593886 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
19:40:06.632511 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
19:40:06.632969 [info ] [Thread-3  ]: 3 of 7 START table model public.stg_customers .................................. [RUN]
19:40:06.633356 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
19:40:06.633449 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
19:40:06.633517 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
19:40:06.634194 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
19:40:06.634359 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
19:40:06.634614 [info ] [Thread-4  ]: 4 of 7 START table model public.stg_orders ..................................... [RUN]
19:40:06.635075 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
19:40:06.635169 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
19:40:06.635385 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
19:40:06.636087 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
19:40:06.636350 [debug] [Thread-4  ]: finished collecting timing info
19:40:06.636477 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
19:40:06.641919 [debug] [Thread-1  ]: finished collecting timing info
19:40:06.642712 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
19:40:06.657956 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
19:40:06.658379 [debug] [Thread-2  ]: finished collecting timing info
19:40:06.665523 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
19:40:06.674572 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
19:40:06.675976 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
19:40:06.681746 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
19:40:06.681928 [debug] [Thread-3  ]: finished collecting timing info
19:40:06.682571 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
19:40:06.684118 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
19:40:06.684434 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
19:40:06.682292 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
19:40:06.684815 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
19:40:06.684555 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
19:40:06.684692 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
19:40:06.685337 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
19:40:06.685412 [debug] [Thread-3  ]: Opening a new connection, currently in state init
19:40:06.685184 [debug] [Thread-2  ]: Opening a new connection, currently in state init
19:40:06.684898 [debug] [Thread-4  ]: Opening a new connection, currently in state init
19:40:06.685013 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
19:40:06.687231 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
19:40:06.687310 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:40:06.691370 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
19:40:06.691567 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
19:40:06.691671 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)
select * from customers
  );
19:40:06.693077 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
19:40:06.693223 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
19:40:06.693294 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
19:40:06.694775 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.0 seconds
19:40:06.700392 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
19:40:06.700590 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
19:40:06.700903 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
19:40:06.702246 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
19:40:06.702417 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
19:40:06.702773 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
19:40:06.702855 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */


  create  table "erp_oltp"."public"."stg_orders__dbt_tmp"
  as (
    with orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
)
select * from orders
  );
19:40:06.702656 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
19:40:06.702487 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
19:40:06.703114 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
19:40:06.703175 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
19:40:06.702998 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
19:40:06.704912 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
19:40:06.705040 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
19:40:06.706406 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
19:40:06.706490 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
19:40:06.705097 [debug] [Thread-4  ]: SQL status: SELECT 295 in 0.0 seconds
19:40:06.705175 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
19:40:06.707781 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
19:40:06.709466 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
19:40:06.707874 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
19:40:06.709008 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
19:40:06.710636 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
19:40:06.710994 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
19:40:06.705329 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
19:40:06.710893 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
19:40:06.712183 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
19:40:06.712301 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
19:40:06.710798 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
19:40:06.712641 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
19:40:06.718121 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
19:40:06.720703 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
19:40:06.720797 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
19:40:06.720857 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
19:40:06.721027 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
19:40:06.721712 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
19:40:06.721790 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
19:40:06.721853 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
19:40:06.721975 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
19:40:06.722725 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
19:40:06.722806 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
19:40:06.722896 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
19:40:06.724136 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
19:40:06.724376 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
19:40:06.726970 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
19:40:06.724454 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
19:40:06.727090 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
19:40:06.728321 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
19:40:06.727228 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
19:40:06.730155 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
19:40:06.728411 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop table if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
19:40:06.727154 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
19:40:06.727335 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
19:40:06.730242 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
19:40:06.732506 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
19:40:06.733550 [debug] [Thread-4  ]: finished collecting timing info
19:40:06.733656 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
19:40:06.734556 [debug] [Thread-1  ]: finished collecting timing info
19:40:06.733833 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
19:40:06.735083 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2152c70d-3fa3-469b-bae2-0dbb9fca9355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f325141ef70>]}
19:40:06.734664 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
19:40:06.735622 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2152c70d-3fa3-469b-bae2-0dbb9fca9355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f324f0db4f0>]}
19:40:06.735327 [info ] [Thread-4  ]: 4 of 7 OK created table model public.stg_orders ................................ [[32mSELECT 295[0m in 0.10s]
19:40:06.733737 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
19:40:06.735815 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.14s]
19:40:06.736184 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
19:40:06.733908 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
19:40:06.739600 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
19:40:06.737872 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
19:40:06.740368 [debug] [Thread-2  ]: finished collecting timing info
19:40:06.740583 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
19:40:06.740747 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
19:40:06.741113 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
19:40:06.741358 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
19:40:06.741435 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
19:40:06.741502 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
19:40:06.742844 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
19:40:06.743100 [debug] [Thread-6  ]: finished collecting timing info
19:40:06.743232 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
19:40:06.740888 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
19:40:06.745273 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
19:40:06.745371 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
19:40:06.745674 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2152c70d-3fa3-469b-bae2-0dbb9fca9355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f324f165fa0>]}
19:40:06.749016 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.15s]
19:40:06.748762 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
19:40:06.749178 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
19:40:06.749238 [debug] [Thread-6  ]: Opening a new connection, currently in state init
19:40:06.748548 [debug] [Thread-3  ]: finished collecting timing info
19:40:06.749819 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
19:40:06.750116 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
19:40:06.750546 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2152c70d-3fa3-469b-bae2-0dbb9fca9355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f324f2434c0>]}
19:40:06.750756 [info ] [Thread-3  ]: 3 of 7 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.12s]
19:40:06.750957 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
19:40:06.751701 [debug] [Thread-8  ]: Began running node model.first_project.customers
19:40:06.751810 [debug] [Thread-9  ]: Began running node model.first_project.customers2
19:40:06.752095 [info ] [Thread-8  ]: 6 of 7 START table model public.customers ...................................... [RUN]
19:40:06.752268 [info ] [Thread-9  ]: 7 of 7 START table model public.customers2 ..................................... [RUN]
19:40:06.752561 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
19:40:06.752807 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers2"
19:40:06.752911 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
19:40:06.753012 [debug] [Thread-9  ]: Began compiling node model.first_project.customers2
19:40:06.753117 [debug] [Thread-8  ]: Compiling model.first_project.customers
19:40:06.753210 [debug] [Thread-9  ]: Compiling model.first_project.customers2
19:40:06.754821 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
19:40:06.756610 [debug] [Thread-8  ]: finished collecting timing info
19:40:06.756747 [debug] [Thread-8  ]: Began executing node model.first_project.customers
19:40:06.759161 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
19:40:06.759419 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
19:40:06.759542 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
19:40:06.759603 [debug] [Thread-8  ]: Opening a new connection, currently in state init
19:40:06.761233 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
19:40:06.761362 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
19:40:06.761425 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
19:40:06.762834 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
19:40:06.764301 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
19:40:06.764402 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
19:40:06.764659 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
19:40:06.765355 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
19:40:06.765430 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
19:40:06.765481 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
19:40:06.766810 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
19:40:06.756221 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers2"
19:40:06.767797 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
19:40:06.768049 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
19:40:06.768259 [debug] [Thread-9  ]: finished collecting timing info
19:40:06.768412 [debug] [Thread-9  ]: Began executing node model.first_project.customers2
19:40:06.769964 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.customers2"
19:40:06.770083 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
19:40:06.773602 [debug] [Thread-6  ]: finished collecting timing info
19:40:06.773732 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
19:40:06.774036 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2152c70d-3fa3-469b-bae2-0dbb9fca9355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f324c04b2b0>]}
19:40:06.774432 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
19:40:06.774689 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
19:40:06.774959 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
19:40:06.775056 [debug] [Thread-9  ]: On model.first_project.customers2: BEGIN
19:40:06.775121 [debug] [Thread-9  ]: Opening a new connection, currently in state init
19:40:06.771560 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
19:40:06.777535 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
19:40:06.777648 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
 customers.state
 from customers
 left join customer_orders using (customer_id)
 WHERE customers.customer_id != 63
)
select * from final
  );
19:40:06.780429 [debug] [Thread-9  ]: SQL status: BEGIN in 0.01 seconds
19:40:06.780691 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
19:40:06.780804 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
19:40:06.783287 [debug] [Thread-8  ]: SQL status: SELECT 98 in 0.01 seconds
19:40:06.785098 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
19:40:06.785188 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
19:40:06.785443 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
19:40:06.786493 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
19:40:06.786576 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
19:40:06.786797 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
19:40:06.787521 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
19:40:06.787602 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
19:40:06.787685 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
19:40:06.790198 [debug] [Thread-9  ]: SQL status: SELECT 100 in 0.01 seconds
19:40:06.791861 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
19:40:06.792064 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
19:40:06.793913 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
19:40:06.795869 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
19:40:06.796038 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
19:40:06.796557 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
19:40:06.797710 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
19:40:06.797869 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
19:40:06.797934 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
19:40:06.799146 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
19:40:06.805142 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
19:40:06.805371 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
19:40:06.806255 [debug] [Thread-9  ]: SQL status: COMMIT in 0.01 seconds
19:40:06.807756 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
19:40:06.807913 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
19:40:06.808097 [debug] [Thread-8  ]: SQL status: DROP TABLE in 0.0 seconds
19:40:06.809185 [debug] [Thread-8  ]: finished collecting timing info
19:40:06.809376 [debug] [Thread-8  ]: On model.first_project.customers: Close
19:40:06.811980 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2152c70d-3fa3-469b-bae2-0dbb9fca9355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3234743c10>]}
19:40:06.812191 [debug] [Thread-9  ]: SQL status: DROP TABLE in 0.0 seconds
19:40:06.813304 [info ] [Thread-8  ]: 6 of 7 OK created table model public.customers ................................. [[32mSELECT 98[0m in 0.06s]
19:40:06.814353 [debug] [Thread-9  ]: finished collecting timing info
19:40:06.814750 [debug] [Thread-8  ]: Finished running node model.first_project.customers
19:40:06.814881 [debug] [Thread-9  ]: On model.first_project.customers2: Close
19:40:06.815405 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2152c70d-3fa3-469b-bae2-0dbb9fca9355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323473ca60>]}
19:40:06.815614 [info ] [Thread-9  ]: 7 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.06s]
19:40:06.816438 [debug] [Thread-9  ]: Finished running node model.first_project.customers2
19:40:06.818145 [debug] [MainThread]: Acquiring new postgres connection "master"
19:40:06.818300 [debug] [MainThread]: Using postgres connection "master"
19:40:06.818371 [debug] [MainThread]: On master: BEGIN
19:40:06.818427 [debug] [MainThread]: Opening a new connection, currently in state closed
19:40:06.822593 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
19:40:06.822700 [debug] [MainThread]: On master: COMMIT
19:40:06.822763 [debug] [MainThread]: Using postgres connection "master"
19:40:06.822819 [debug] [MainThread]: On master: COMMIT
19:40:06.822943 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
19:40:06.823022 [debug] [MainThread]: On master: Close
19:40:06.823298 [info ] [MainThread]: 
19:40:06.823436 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0.31s.
19:40:06.823541 [debug] [MainThread]: Connection 'master' was properly closed.
19:40:06.823594 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
19:40:06.823641 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
19:40:06.823687 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
19:40:06.823732 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
19:40:06.823777 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
19:40:06.823822 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
19:40:06.823868 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
19:40:06.828262 [info ] [MainThread]: 
19:40:06.829667 [info ] [MainThread]: [32mCompleted successfully[0m
19:40:06.829874 [info ] [MainThread]: 
19:40:06.829990 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
19:40:06.830170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f324f20e1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f324f20e400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f324e880d00>]}


============================== 2022-06-10 19:40:12.692795 | b8e62361-ff3d-41d0-9bc9-4f4d005102c6 ==============================
19:40:12.692806 [info ] [MainThread]: Running with dbt=1.1.0
19:40:12.693232 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
19:40:12.693322 [debug] [MainThread]: Tracking: tracking
19:40:12.695795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d9009d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d9009d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d9009dd00>]}
19:40:12.713155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
19:40:12.713433 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
19:40:12.717633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8e62361-ff3d-41d0-9bc9-4f4d005102c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d8ff480d0>]}
19:40:12.721436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8e62361-ff3d-41d0-9bc9-4f4d005102c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d8ffaa790>]}
19:40:12.721753 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
19:40:12.721938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8e62361-ff3d-41d0-9bc9-4f4d005102c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d8ffaa820>]}
19:40:12.723183 [info ] [MainThread]: 
19:40:12.723541 [debug] [MainThread]: Acquiring new postgres connection "master"
19:40:12.733177 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
19:40:12.740543 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
19:40:12.740778 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
19:40:12.740903 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:40:12.746449 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:40:12.746638 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
19:40:12.746708 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:40:12.748137 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
19:40:12.749225 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
19:40:12.749392 [debug] [ThreadPool]: On list_erp_oltp_public: Close
19:40:12.752353 [debug] [MainThread]: Using postgres connection "master"
19:40:12.752506 [debug] [MainThread]: On master: BEGIN
19:40:12.752570 [debug] [MainThread]: Opening a new connection, currently in state init
19:40:12.764811 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:40:12.765021 [debug] [MainThread]: Using postgres connection "master"
19:40:12.765096 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:40:12.775580 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
19:40:12.776651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8e62361-ff3d-41d0-9bc9-4f4d005102c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d8ffaa400>]}
19:40:12.776876 [debug] [MainThread]: On master: ROLLBACK
19:40:12.777233 [debug] [MainThread]: On master: Close
19:40:12.777561 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
19:40:12.777923 [info ] [MainThread]: 
19:40:12.790884 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
19:40:12.791473 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
19:40:12.791698 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
19:40:12.791802 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
19:40:12.793823 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
19:40:12.794186 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
19:40:12.794507 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
19:40:12.794592 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
19:40:12.794661 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
19:40:12.796483 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
19:40:12.796672 [debug] [Thread-1  ]: finished collecting timing info
19:40:12.796781 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
19:40:12.796870 [debug] [Thread-1  ]: finished collecting timing info
19:40:12.797102 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
19:40:12.797204 [debug] [Thread-1  ]: Began running node model.first_project.stg_customers
19:40:12.797357 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.stg_customers"
19:40:12.797451 [debug] [Thread-1  ]: Began compiling node model.first_project.stg_customers
19:40:12.797517 [debug] [Thread-1  ]: Compiling model.first_project.stg_customers
19:40:12.821283 [debug] [Thread-3  ]: Began running node model.first_project.stg_orders
19:40:12.821638 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_orders"
19:40:12.821749 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_orders
19:40:12.821814 [debug] [Thread-3  ]: Compiling model.first_project.stg_orders
19:40:12.822422 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_orders"
19:40:12.823083 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.stg_customers"
19:40:12.823302 [debug] [Thread-4  ]: Began running node seed.first_project.code-country
19:40:12.823571 [debug] [Thread-4  ]: Acquiring new postgres connection "seed.first_project.code-country"
19:40:12.823667 [debug] [Thread-4  ]: Began compiling node seed.first_project.code-country
19:40:12.823790 [debug] [Thread-1  ]: finished collecting timing info
19:40:12.823981 [debug] [Thread-4  ]: Compiling seed.first_project.code-country
19:40:12.825761 [debug] [Thread-4  ]: Writing injected SQL for node "seed.first_project.code-country"
19:40:12.825859 [debug] [Thread-4  ]: finished collecting timing info
19:40:12.824644 [debug] [Thread-1  ]: Began executing node model.first_project.stg_customers
19:40:12.824788 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
19:40:12.826330 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
19:40:12.826418 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
19:40:12.826490 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
19:40:12.827784 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
19:40:12.828009 [debug] [Thread-6  ]: finished collecting timing info
19:40:12.828157 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
19:40:12.824945 [debug] [Thread-8  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:40:12.826039 [debug] [Thread-1  ]: finished collecting timing info
19:40:12.828796 [debug] [Thread-1  ]: Finished running node model.first_project.stg_customers
19:40:12.824089 [debug] [Thread-3  ]: finished collecting timing info
19:40:12.829467 [debug] [Thread-3  ]: Began executing node model.first_project.stg_orders
19:40:12.829547 [debug] [Thread-3  ]: finished collecting timing info
19:40:12.829736 [debug] [Thread-3  ]: Finished running node model.first_project.stg_orders
19:40:12.824882 [debug] [Thread-7  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:40:12.829903 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
19:40:12.829971 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:40:12.830027 [debug] [Thread-7  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:40:12.828506 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
19:40:12.837115 [debug] [Thread-8  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:40:12.837181 [debug] [Thread-8  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
19:40:12.824347 [debug] [Thread-2  ]: finished collecting timing info
19:40:12.825924 [debug] [Thread-4  ]: Began executing node seed.first_project.code-country
19:40:12.828267 [debug] [Thread-6  ]: finished collecting timing info
19:40:12.836989 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
19:40:12.840778 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
19:40:12.841075 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
19:40:12.841376 [debug] [Thread-4  ]: finished collecting timing info
19:40:12.842770 [debug] [Thread-4  ]: Finished running node seed.first_project.code-country
19:40:12.841801 [debug] [Thread-5  ]: Began running node model.first_project.customers2
19:40:12.842152 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
19:40:12.842473 [debug] [Thread-2  ]: finished collecting timing info
19:40:12.842964 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customers2"
19:40:12.843675 [debug] [Thread-5  ]: Began compiling node model.first_project.customers2
19:40:12.843766 [debug] [Thread-5  ]: Compiling model.first_project.customers2
19:40:12.843481 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
19:40:12.841635 [debug] [Thread-10 ]: Began running node model.first_project.customers
19:40:12.845143 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customers2"
19:40:12.846101 [debug] [Thread-5  ]: finished collecting timing info
19:40:12.846221 [debug] [Thread-5  ]: Began executing node model.first_project.customers2
19:40:12.846303 [debug] [Thread-5  ]: finished collecting timing info
19:40:12.845566 [debug] [Thread-1  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:40:12.846712 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
19:40:12.846800 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:40:12.846480 [debug] [Thread-5  ]: Finished running node model.first_project.customers2
19:40:12.845934 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
19:40:12.847037 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
19:40:12.847119 [debug] [Thread-10 ]: Compiling model.first_project.customers
19:40:12.846860 [debug] [Thread-1  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:40:12.851160 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
19:40:12.843176 [debug] [Thread-8  ]: finished collecting timing info
19:40:12.851585 [debug] [Thread-8  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:40:12.851678 [debug] [Thread-8  ]: finished collecting timing info
19:40:12.845688 [debug] [Thread-2  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:40:12.851358 [debug] [Thread-1  ]: finished collecting timing info
19:40:12.852294 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:40:12.852379 [debug] [Thread-1  ]: finished collecting timing info
19:40:12.852550 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:40:12.851876 [debug] [Thread-8  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:40:12.845256 [debug] [Thread-7  ]: finished collecting timing info
19:40:12.852132 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
19:40:12.852659 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:40:12.852996 [debug] [Thread-7  ]: finished collecting timing info
19:40:12.852814 [debug] [Thread-2  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:40:12.853259 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:40:12.848544 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
19:40:12.853418 [debug] [Thread-2  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:40:12.855428 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
19:40:12.855701 [debug] [Thread-10 ]: finished collecting timing info
19:40:12.855836 [debug] [Thread-10 ]: Began executing node model.first_project.customers
19:40:12.855907 [debug] [Thread-10 ]: finished collecting timing info
19:40:12.856108 [debug] [Thread-10 ]: Finished running node model.first_project.customers
19:40:12.856252 [debug] [Thread-2  ]: finished collecting timing info
19:40:12.856350 [debug] [Thread-2  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:40:12.856421 [debug] [Thread-2  ]: finished collecting timing info
19:40:12.856599 [debug] [Thread-2  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:40:12.857317 [debug] [Thread-9  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:40:12.857616 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
19:40:12.857696 [debug] [Thread-9  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:40:12.857764 [debug] [Thread-9  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:40:12.862354 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
19:40:12.862690 [debug] [Thread-9  ]: finished collecting timing info
19:40:12.863008 [debug] [Thread-9  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:40:12.863115 [debug] [Thread-9  ]: finished collecting timing info
19:40:12.863381 [debug] [Thread-9  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:40:12.864502 [debug] [MainThread]: Connection 'master' was properly closed.
19:40:12.864591 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
19:40:12.864646 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
19:40:12.864695 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
19:40:12.864742 [debug] [MainThread]: Connection 'seed.first_project.code-country' was properly closed.
19:40:12.864789 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
19:40:12.864850 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
19:40:12.864902 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
19:40:12.864948 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
19:40:12.864994 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
19:40:12.865040 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
19:40:12.868344 [info ] [MainThread]: Done.
19:40:12.871113 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
19:40:12.871209 [info ] [MainThread]: Building catalog
19:40:12.872477 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
19:40:12.876464 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
19:40:12.876565 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
19:40:12.876626 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:40:12.880202 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
19:40:12.880351 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
19:40:12.880417 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
19:40:12.888439 [debug] [ThreadPool]: SQL status: SELECT 77 in 0.01 seconds
19:40:12.894754 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
19:40:12.895583 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
19:40:12.909936 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/dbt_first_project/target/catalog.json
19:40:12.910393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d9009d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d8c63dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d8c63dd00>]}
19:40:13.523302 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
19:40:13.523744 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 19:40:18.269103 | c4e95cfd-2362-428a-89be-1a50c29aac9b ==============================
19:40:18.269118 [info ] [MainThread]: Running with dbt=1.1.0
19:40:18.270270 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
19:40:18.270419 [debug] [MainThread]: Tracking: tracking
19:40:18.274259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9a17a5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9a17a700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda9a17a040>]}
19:40:18.275879 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
19:40:18.276620 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
19:40:18.276826 [info ] [MainThread]: 
19:40:18.276943 [info ] [MainThread]: 
19:40:18.277097 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-10 19:45:57.300856 | 17371fe4-8fb3-425b-8658-e23aef7cd493 ==============================
19:45:57.300868 [info ] [MainThread]: Running with dbt=1.1.0
19:45:57.301177 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
19:45:57.301264 [debug] [MainThread]: Tracking: tracking
19:45:57.303521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bf97b7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bf97ba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bf97bf70>]}
19:45:57.320317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
19:45:57.320739 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
19:45:57.321003 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/docs.md
19:45:57.381259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17371fe4-8fb3-425b-8658-e23aef7cd493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c11df910>]}
19:45:57.384987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17371fe4-8fb3-425b-8658-e23aef7cd493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bf87ecd0>]}
19:45:57.385227 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
19:45:57.385363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17371fe4-8fb3-425b-8658-e23aef7cd493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bf87efa0>]}
19:45:57.386374 [info ] [MainThread]: 
19:45:57.386666 [debug] [MainThread]: Acquiring new postgres connection "master"
19:45:57.387457 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
19:45:57.394396 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
19:45:57.394502 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
19:45:57.394569 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:45:57.399659 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:45:57.399815 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
19:45:57.399881 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
19:45:57.401259 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
19:45:57.402468 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
19:45:57.402684 [debug] [ThreadPool]: On list_erp_oltp_public: Close
19:45:57.405349 [debug] [MainThread]: Using postgres connection "master"
19:45:57.405447 [debug] [MainThread]: On master: BEGIN
19:45:57.405505 [debug] [MainThread]: Opening a new connection, currently in state init
19:45:57.415222 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
19:45:57.415578 [debug] [MainThread]: Using postgres connection "master"
19:45:57.415685 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
19:45:57.433731 [debug] [MainThread]: SQL status: SELECT 2 in 0.02 seconds
19:45:57.434770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17371fe4-8fb3-425b-8658-e23aef7cd493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bf87efa0>]}
19:45:57.434988 [debug] [MainThread]: On master: ROLLBACK
19:45:57.435261 [debug] [MainThread]: On master: Close
19:45:57.435599 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
19:45:57.435760 [info ] [MainThread]: 
19:45:57.440844 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
19:45:57.441110 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
19:45:57.441196 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
19:45:57.441267 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
19:45:57.442739 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
19:45:57.442972 [debug] [Thread-1  ]: finished collecting timing info
19:45:57.443102 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
19:45:57.443191 [debug] [Thread-1  ]: finished collecting timing info
19:45:57.443415 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
19:45:57.443504 [debug] [Thread-1  ]: Began running node model.first_project.postgres_sample_source_customers
19:45:57.443652 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
19:45:57.443723 [debug] [Thread-1  ]: Began compiling node model.first_project.postgres_sample_source_customers
19:45:57.444099 [debug] [Thread-1  ]: Compiling model.first_project.postgres_sample_source_customers
19:45:57.445532 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
19:45:57.446701 [debug] [Thread-2  ]: Began running node model.first_project.stg_customers
19:45:57.455182 [debug] [Thread-3  ]: Began running node model.first_project.stg_orders
19:45:57.455691 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.stg_customers"
19:45:57.455823 [debug] [Thread-4  ]: Began running node seed.first_project.code-country
19:45:57.457433 [debug] [Thread-4  ]: Acquiring new postgres connection "seed.first_project.code-country"
19:45:57.457504 [debug] [Thread-4  ]: Began compiling node seed.first_project.code-country
19:45:57.457590 [debug] [Thread-4  ]: Compiling seed.first_project.code-country
19:45:57.456884 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:45:57.457021 [debug] [Thread-2  ]: Began compiling node model.first_project.stg_customers
19:45:57.459320 [debug] [Thread-2  ]: Compiling model.first_project.stg_customers
19:45:57.456803 [debug] [Thread-6  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:45:57.460529 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
19:45:57.460619 [debug] [Thread-6  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:45:57.460681 [debug] [Thread-6  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:45:57.456720 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
19:45:57.467898 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
19:45:57.468022 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
19:45:57.460088 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.stg_customers"
19:45:57.468464 [debug] [Thread-2  ]: finished collecting timing info
19:45:57.468591 [debug] [Thread-2  ]: Began executing node model.first_project.stg_customers
19:45:57.468694 [debug] [Thread-2  ]: finished collecting timing info
19:45:57.468933 [debug] [Thread-2  ]: Finished running node model.first_project.stg_customers
19:45:57.459085 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
19:45:57.469074 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:45:57.469137 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
19:45:57.468129 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
19:45:57.473965 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
19:45:57.457162 [debug] [Thread-1  ]: finished collecting timing info
19:45:57.474623 [debug] [Thread-1  ]: Began executing node model.first_project.postgres_sample_source_customers
19:45:57.458831 [debug] [Thread-4  ]: Writing injected SQL for node "seed.first_project.code-country"
19:45:57.474833 [debug] [Thread-4  ]: finished collecting timing info
19:45:57.467549 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
19:45:57.474437 [debug] [Thread-9  ]: Began running node model.first_project.customers2
19:45:57.475176 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers2"
19:45:57.475262 [debug] [Thread-9  ]: Began compiling node model.first_project.customers2
19:45:57.475323 [debug] [Thread-9  ]: Compiling model.first_project.customers2
19:45:57.474518 [debug] [Thread-5  ]: finished collecting timing info
19:45:57.476747 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
19:45:57.476846 [debug] [Thread-5  ]: finished collecting timing info
19:45:57.477074 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
19:45:57.456583 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_orders"
19:45:57.476572 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers2"
19:45:57.474696 [debug] [Thread-1  ]: finished collecting timing info
19:45:57.474940 [debug] [Thread-4  ]: Began executing node seed.first_project.code-country
19:45:57.478378 [debug] [Thread-4  ]: finished collecting timing info
19:45:57.478717 [debug] [Thread-4  ]: Finished running node seed.first_project.code-country
19:45:57.477195 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_orders
19:45:57.478854 [debug] [Thread-3  ]: Compiling model.first_project.stg_orders
19:45:57.477391 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:45:57.479638 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
19:45:57.479725 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:45:57.479826 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:45:57.477570 [debug] [Thread-2  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:45:57.482402 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
19:45:57.482504 [debug] [Thread-2  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:45:57.482571 [debug] [Thread-2  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:45:57.481962 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
19:45:57.485058 [debug] [Thread-8  ]: finished collecting timing info
19:45:57.485217 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:45:57.485293 [debug] [Thread-8  ]: finished collecting timing info
19:45:57.472642 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
19:45:57.477708 [debug] [Thread-6  ]: finished collecting timing info
19:45:57.484729 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
19:45:57.479386 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_orders"
19:45:57.485502 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
19:45:57.477951 [debug] [Thread-9  ]: finished collecting timing info
19:45:57.486424 [debug] [Thread-9  ]: Began executing node model.first_project.customers2
19:45:57.485826 [debug] [Thread-7  ]: finished collecting timing info
19:45:57.486014 [debug] [Thread-6  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:45:57.486888 [debug] [Thread-6  ]: finished collecting timing info
19:45:57.486548 [debug] [Thread-9  ]: finished collecting timing info
19:45:57.486628 [debug] [Thread-3  ]: finished collecting timing info
19:45:57.487437 [debug] [Thread-3  ]: Began executing node model.first_project.stg_orders
19:45:57.478215 [debug] [Thread-1  ]: Finished running node model.first_project.postgres_sample_source_customers
19:45:57.487092 [debug] [Thread-6  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
19:45:57.487338 [debug] [Thread-9  ]: Finished running node model.first_project.customers2
19:45:57.486795 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:45:57.487534 [debug] [Thread-3  ]: finished collecting timing info
19:45:57.488117 [debug] [Thread-3  ]: Finished running node model.first_project.stg_orders
19:45:57.487910 [debug] [Thread-7  ]: finished collecting timing info
19:45:57.488581 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
19:45:57.488354 [debug] [Thread-5  ]: Began running node model.first_project.customers
19:45:57.488750 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customers"
19:45:57.488822 [debug] [Thread-5  ]: Began compiling node model.first_project.customers
19:45:57.488881 [debug] [Thread-5  ]: Compiling model.first_project.customers
19:45:57.490205 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customers"
19:45:57.490419 [debug] [Thread-5  ]: finished collecting timing info
19:45:57.490532 [debug] [Thread-5  ]: Began executing node model.first_project.customers
19:45:57.490603 [debug] [Thread-5  ]: finished collecting timing info
19:45:57.490790 [debug] [Thread-5  ]: Finished running node model.first_project.customers
19:45:57.487651 [debug] [Thread-2  ]: finished collecting timing info
19:45:57.491023 [debug] [Thread-4  ]: Began running node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
19:45:57.491472 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a"
19:45:57.491181 [debug] [Thread-8  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
19:45:57.491726 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
19:45:57.491803 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
19:45:57.491565 [debug] [Thread-4  ]: Began compiling node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
19:45:57.491949 [debug] [Thread-4  ]: Compiling test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
19:45:57.491860 [debug] [Thread-8  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
19:45:57.498308 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
19:45:57.491255 [debug] [Thread-1  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:45:57.499508 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
19:45:57.496411 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a"
19:45:57.499595 [debug] [Thread-1  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:45:57.499796 [debug] [Thread-1  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:45:57.491314 [debug] [Thread-6  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
19:45:57.491095 [debug] [Thread-2  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:45:57.503988 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
19:45:57.504171 [debug] [Thread-4  ]: finished collecting timing info
19:45:57.504299 [debug] [Thread-8  ]: finished collecting timing info
19:45:57.504498 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
19:45:57.504612 [debug] [Thread-2  ]: finished collecting timing info
19:45:57.504754 [debug] [Thread-4  ]: Began executing node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
19:45:57.504854 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
19:45:57.504955 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
19:45:57.505637 [debug] [Thread-6  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
19:45:57.505344 [debug] [Thread-2  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
19:45:57.505454 [debug] [Thread-4  ]: finished collecting timing info
19:45:57.505550 [debug] [Thread-8  ]: finished collecting timing info
19:45:57.507388 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
19:45:57.505119 [debug] [Thread-1  ]: finished collecting timing info
19:45:57.507738 [debug] [Thread-4  ]: Finished running node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
19:45:57.507975 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
19:45:57.508168 [debug] [Thread-6  ]: finished collecting timing info
19:45:57.508312 [debug] [Thread-1  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:45:57.509521 [debug] [Thread-6  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
19:45:57.509621 [debug] [Thread-1  ]: finished collecting timing info
19:45:57.509726 [debug] [Thread-6  ]: finished collecting timing info
19:45:57.509968 [debug] [Thread-1  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
19:45:57.510249 [debug] [Thread-6  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
19:45:57.511185 [debug] [MainThread]: Connection 'master' was properly closed.
19:45:57.511282 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
19:45:57.511335 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
19:45:57.511382 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
19:45:57.511429 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a' was properly closed.
19:45:57.511476 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
19:45:57.511522 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
19:45:57.511569 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
19:45:57.511616 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
19:45:57.511663 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
19:45:57.515000 [info ] [MainThread]: Done.
19:45:57.516636 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
19:45:57.516773 [info ] [MainThread]: Building catalog
19:45:57.518057 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
19:45:57.523017 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
19:45:57.523114 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
19:45:57.523177 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:45:57.535353 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
19:45:57.535613 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
19:45:57.535686 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
19:45:57.538156 [debug] [ThreadPool]: SQL status: SELECT 77 in 0.0 seconds
19:45:57.545459 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
19:45:57.545799 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
19:45:57.553138 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/dbt_first_project/target/catalog.json
19:45:57.553559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bf8d9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bf8d9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1bf8d9400>]}
19:45:58.834990 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
19:45:58.836098 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 19:46:21.862240 | 86c628f2-cd2f-4d81-8122-4dbc687ab739 ==============================
19:46:21.862256 [info ] [MainThread]: Running with dbt=1.1.0
19:46:21.862660 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
19:46:21.862788 [debug] [MainThread]: Tracking: tracking
19:46:21.866018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f97f7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f97f7f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f97f7070>]}
19:46:21.867817 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
19:46:21.868056 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
19:46:21.868167 [info ] [MainThread]: 
19:46:21.868336 [info ] [MainThread]: 
19:46:21.868439 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-10 20:01:12.355776 | 9d85cf4e-f31f-45b8-a1e0-f52a6042135d ==============================
20:01:12.355788 [info ] [MainThread]: Running with dbt=1.1.0
20:01:12.356583 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
20:01:12.356678 [debug] [MainThread]: Tracking: tracking
20:01:12.359644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a6759d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a6759dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a6759d5e0>]}
20:01:12.377838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
20:01:12.378206 [debug] [MainThread]: Partial parsing: added file: first_project://models/overview.md
20:01:12.385384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d85cf4e-f31f-45b8-a1e0-f52a6042135d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a673e70d0>]}
20:01:12.389163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d85cf4e-f31f-45b8-a1e0-f52a6042135d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a674d0e20>]}
20:01:12.389615 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:01:12.389801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d85cf4e-f31f-45b8-a1e0-f52a6042135d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a674d0f40>]}
20:01:12.391055 [info ] [MainThread]: 
20:01:12.391421 [debug] [MainThread]: Acquiring new postgres connection "master"
20:01:12.392295 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
20:01:12.400502 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:01:12.400667 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
20:01:12.400734 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:01:12.405935 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:01:12.406282 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:01:12.406357 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:01:12.408328 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
20:01:12.409560 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
20:01:12.409859 [debug] [ThreadPool]: On list_erp_oltp_public: Close
20:01:12.412864 [debug] [MainThread]: Using postgres connection "master"
20:01:12.412972 [debug] [MainThread]: On master: BEGIN
20:01:12.413035 [debug] [MainThread]: Opening a new connection, currently in state init
20:01:12.420015 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:01:12.420321 [debug] [MainThread]: Using postgres connection "master"
20:01:12.420451 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:01:12.431167 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
20:01:12.432171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d85cf4e-f31f-45b8-a1e0-f52a6042135d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a674d0c10>]}
20:01:12.432428 [debug] [MainThread]: On master: ROLLBACK
20:01:12.432804 [debug] [MainThread]: On master: Close
20:01:12.433194 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:01:12.433363 [info ] [MainThread]: 
20:01:12.437567 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
20:01:12.437796 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
20:01:12.437888 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
20:01:12.438002 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
20:01:12.467118 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
20:01:12.467461 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
20:01:12.467557 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
20:01:12.467633 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
20:01:12.469009 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
20:01:12.469341 [debug] [Thread-2  ]: finished collecting timing info
20:01:12.469470 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
20:01:12.469548 [debug] [Thread-2  ]: finished collecting timing info
20:01:12.469749 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
20:01:12.469838 [debug] [Thread-2  ]: Began running node model.first_project.stg_customers
20:01:12.469961 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.stg_customers"
20:01:12.470048 [debug] [Thread-2  ]: Began compiling node model.first_project.stg_customers
20:01:12.470112 [debug] [Thread-2  ]: Compiling model.first_project.stg_customers
20:01:12.470244 [debug] [Thread-3  ]: Began running node model.first_project.stg_orders
20:01:12.473033 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_orders"
20:01:12.473163 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_orders
20:01:12.473274 [debug] [Thread-3  ]: Compiling model.first_project.stg_orders
20:01:12.472436 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.stg_customers"
20:01:12.470367 [debug] [Thread-4  ]: Began running node seed.first_project.code-country
20:01:12.474438 [debug] [Thread-4  ]: Acquiring new postgres connection "seed.first_project.code-country"
20:01:12.474540 [debug] [Thread-4  ]: Began compiling node seed.first_project.code-country
20:01:12.474029 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_orders"
20:01:12.474602 [debug] [Thread-4  ]: Compiling seed.first_project.code-country
20:01:12.475526 [debug] [Thread-4  ]: Writing injected SQL for node "seed.first_project.code-country"
20:01:12.475635 [debug] [Thread-4  ]: finished collecting timing info
20:01:12.475701 [debug] [Thread-4  ]: Began executing node seed.first_project.code-country
20:01:12.475783 [debug] [Thread-4  ]: finished collecting timing info
20:01:12.476025 [debug] [Thread-4  ]: Finished running node seed.first_project.code-country
20:01:12.471517 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
20:01:12.476258 [debug] [Thread-2  ]: finished collecting timing info
20:01:12.476429 [debug] [Thread-2  ]: Began executing node model.first_project.stg_customers
20:01:12.476506 [debug] [Thread-2  ]: finished collecting timing info
20:01:12.476740 [debug] [Thread-2  ]: Finished running node model.first_project.stg_customers
20:01:12.477048 [debug] [Thread-6  ]: Began running node model.first_project.customers2
20:01:12.477261 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
20:01:12.477338 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
20:01:12.477417 [debug] [Thread-6  ]: Compiling model.first_project.customers2
20:01:12.478855 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
20:01:12.479046 [debug] [Thread-1  ]: finished collecting timing info
20:01:12.479454 [debug] [Thread-3  ]: finished collecting timing info
20:01:12.480034 [debug] [Thread-3  ]: Began executing node model.first_project.stg_orders
20:01:12.480109 [debug] [Thread-3  ]: finished collecting timing info
20:01:12.479655 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
20:01:12.480357 [debug] [Thread-3  ]: Finished running node model.first_project.stg_orders
20:01:12.479839 [debug] [Thread-6  ]: finished collecting timing info
20:01:12.480563 [debug] [Thread-1  ]: finished collecting timing info
20:01:12.480797 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
20:01:12.481052 [debug] [Thread-8  ]: Began running node model.first_project.customers
20:01:12.481302 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
20:01:12.481577 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
20:01:12.481820 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
20:01:12.481899 [debug] [Thread-8  ]: Compiling model.first_project.customers
20:01:12.483253 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
20:01:12.483465 [debug] [Thread-8  ]: finished collecting timing info
20:01:12.483553 [debug] [Thread-8  ]: Began executing node model.first_project.customers
20:01:12.483619 [debug] [Thread-8  ]: finished collecting timing info
20:01:12.483800 [debug] [Thread-8  ]: Finished running node model.first_project.customers
20:01:12.483923 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
20:01:12.484363 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
20:01:12.484022 [debug] [Thread-5  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
20:01:12.484888 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
20:01:12.481413 [debug] [Thread-6  ]: finished collecting timing info
20:01:12.484518 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
20:01:12.485338 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
20:01:12.486424 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
20:01:12.486630 [debug] [Thread-10 ]: finished collecting timing info
20:01:12.484126 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
20:01:12.486888 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
20:01:12.486961 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
20:01:12.486716 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
20:01:12.487104 [debug] [Thread-10 ]: finished collecting timing info
20:01:12.487297 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
20:01:12.484709 [debug] [Thread-9  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
20:01:12.487586 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
20:01:12.487020 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
20:01:12.484972 [debug] [Thread-5  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
20:01:12.493867 [debug] [Thread-5  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
20:01:12.484594 [debug] [Thread-7  ]: Began running node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
20:01:12.499683 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a"
20:01:12.499792 [debug] [Thread-7  ]: Began compiling node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
20:01:12.499861 [debug] [Thread-7  ]: Compiling test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
20:01:12.484657 [debug] [Thread-3  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
20:01:12.485043 [debug] [Thread-1  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
20:01:12.493974 [debug] [Thread-8  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
20:01:12.498769 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
20:01:12.508511 [debug] [Thread-5  ]: finished collecting timing info
20:01:12.508642 [debug] [Thread-5  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
20:01:12.508717 [debug] [Thread-5  ]: finished collecting timing info
20:01:12.508915 [debug] [Thread-5  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
20:01:12.505849 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
20:01:12.509026 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
20:01:12.509087 [debug] [Thread-3  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
20:01:12.487664 [debug] [Thread-9  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
20:01:12.511175 [debug] [Thread-9  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
20:01:12.508166 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
20:01:12.493740 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
20:01:12.515784 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
20:01:12.515866 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
20:01:12.515938 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
20:01:12.510954 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
20:01:12.485255 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
20:01:12.515374 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
20:01:12.515584 [debug] [Thread-8  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
20:01:12.518189 [debug] [Thread-8  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
20:01:12.520046 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
20:01:12.520280 [debug] [Thread-8  ]: finished collecting timing info
20:01:12.517782 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
20:01:12.520415 [debug] [Thread-8  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
20:01:12.520917 [debug] [Thread-8  ]: finished collecting timing info
20:01:12.521166 [debug] [Thread-8  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
20:01:12.507999 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
20:01:12.521322 [debug] [Thread-1  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
20:01:12.521450 [debug] [Thread-1  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
20:01:12.523302 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
20:01:12.520580 [debug] [Thread-3  ]: finished collecting timing info
20:01:12.523542 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
20:01:12.523635 [debug] [Thread-3  ]: finished collecting timing info
20:01:12.523896 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
20:01:12.507817 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a"
20:01:12.498911 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
20:01:12.524080 [debug] [Thread-2  ]: finished collecting timing info
20:01:12.524993 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
20:01:12.524399 [debug] [Thread-1  ]: finished collecting timing info
20:01:12.525215 [debug] [Thread-1  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
20:01:12.525303 [debug] [Thread-1  ]: finished collecting timing info
20:01:12.524177 [debug] [Thread-9  ]: finished collecting timing info
20:01:12.525643 [debug] [Thread-9  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
20:01:12.525730 [debug] [Thread-9  ]: finished collecting timing info
20:01:12.524813 [debug] [Thread-7  ]: finished collecting timing info
20:01:12.526086 [debug] [Thread-7  ]: Began executing node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
20:01:12.526180 [debug] [Thread-7  ]: finished collecting timing info
20:01:12.525913 [debug] [Thread-9  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
20:01:12.525089 [debug] [Thread-2  ]: finished collecting timing info
20:01:12.524717 [debug] [Thread-4  ]: finished collecting timing info
20:01:12.526895 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
20:01:12.527010 [debug] [Thread-4  ]: finished collecting timing info
20:01:12.526703 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
20:01:12.525491 [debug] [Thread-1  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
20:01:12.527201 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
20:01:12.526370 [debug] [Thread-7  ]: Finished running node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
20:01:12.528647 [debug] [MainThread]: Connection 'master' was properly closed.
20:01:12.528734 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
20:01:12.528788 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
20:01:12.528837 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
20:01:12.528901 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
20:01:12.528949 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
20:01:12.528995 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
20:01:12.529040 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
20:01:12.529084 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
20:01:12.529129 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
20:01:12.529174 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a' was properly closed.
20:01:12.531778 [info ] [MainThread]: Done.
20:01:12.533413 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
20:01:12.533506 [info ] [MainThread]: Building catalog
20:01:12.535352 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
20:01:12.540097 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
20:01:12.540196 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
20:01:12.540296 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:01:12.547226 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:01:12.547500 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
20:01:12.547603 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
20:01:12.550885 [debug] [ThreadPool]: SQL status: SELECT 77 in 0.0 seconds
20:01:12.556660 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
20:01:12.557190 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
20:01:12.565016 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/dbt_first_project/target/catalog.json
20:01:12.565486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a6759d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a6740b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a64358610>]}
20:01:13.420245 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
20:01:13.420613 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 20:01:19.182012 | 0c7af15b-6ef8-4eb6-a9a7-1485d38de42c ==============================
20:01:19.182024 [info ] [MainThread]: Running with dbt=1.1.0
20:01:19.182361 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
20:01:19.182440 [debug] [MainThread]: Tracking: tracking
20:01:19.185006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2039b36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2039b3f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2039b3070>]}
20:01:19.186673 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
20:01:19.186860 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
20:01:19.187313 [info ] [MainThread]: 
20:01:19.187412 [info ] [MainThread]: 
20:01:19.187543 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-10 20:55:05.595479 | 088ac8ab-0ff5-4e13-9c61-4007aec6a16c ==============================
20:55:05.595493 [info ] [MainThread]: Running with dbt=1.1.0
20:55:05.596910 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:55:05.597002 [debug] [MainThread]: Tracking: tracking
20:55:05.599200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f60b5460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f60b5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f60b5310>]}
20:55:05.635563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:55:05.635970 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
20:55:05.642592 [debug] [MainThread]: 1603: static parser failed on erp/customers.sql
20:55:05.651474 [debug] [MainThread]: 1602: parser fallback to jinja rendering on erp/customers.sql
20:55:05.698890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '088ac8ab-0ff5-4e13-9c61-4007aec6a16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f79197c0>]}
20:55:05.702381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '088ac8ab-0ff5-4e13-9c61-4007aec6a16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f5f85280>]}
20:55:05.702614 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:55:05.702759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '088ac8ab-0ff5-4e13-9c61-4007aec6a16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f5fb0220>]}
20:55:05.703703 [info ] [MainThread]: 
20:55:05.704002 [debug] [MainThread]: Acquiring new postgres connection "master"
20:55:05.704784 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
20:55:05.709986 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
20:55:05.710105 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
20:55:05.710290 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:55:05.748879 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.04 seconds
20:55:05.750391 [debug] [ThreadPool]: On list_erp_oltp: Close
20:55:05.752057 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
20:55:05.756111 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:55:05.756240 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
20:55:05.756306 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:55:05.760184 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:55:05.760300 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:55:05.760376 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:55:05.769717 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.01 seconds
20:55:05.770930 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
20:55:05.771160 [debug] [ThreadPool]: On list_erp_oltp_public: Close
20:55:05.775104 [debug] [MainThread]: Using postgres connection "master"
20:55:05.775217 [debug] [MainThread]: On master: BEGIN
20:55:05.775283 [debug] [MainThread]: Opening a new connection, currently in state init
20:55:05.778905 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:55:05.779010 [debug] [MainThread]: Using postgres connection "master"
20:55:05.779074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:55:05.792380 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
20:55:05.793337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '088ac8ab-0ff5-4e13-9c61-4007aec6a16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f6012f10>]}
20:55:05.793568 [debug] [MainThread]: On master: ROLLBACK
20:55:05.793756 [debug] [MainThread]: Using postgres connection "master"
20:55:05.793837 [debug] [MainThread]: On master: BEGIN
20:55:05.794027 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:55:05.794106 [debug] [MainThread]: On master: COMMIT
20:55:05.794162 [debug] [MainThread]: Using postgres connection "master"
20:55:05.794214 [debug] [MainThread]: On master: COMMIT
20:55:05.794357 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:55:05.794437 [debug] [MainThread]: On master: Close
20:55:05.794753 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:55:05.794900 [info ] [MainThread]: 
20:55:05.801485 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
20:55:05.801744 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
20:55:05.802055 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
20:55:05.802169 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
20:55:05.802243 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
20:55:05.803970 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
20:55:05.804226 [debug] [Thread-1  ]: finished collecting timing info
20:55:05.804338 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
20:55:05.810628 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
20:55:05.810820 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
20:55:05.821703 [info ] [Thread-3  ]: 3 of 7 START table model public.stg_customers .................................. [RUN]
20:55:05.821973 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
20:55:05.822065 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
20:55:05.822149 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
20:55:05.821330 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
20:55:05.823621 [info ] [Thread-4  ]: 4 of 7 START table model public.stg_orders ..................................... [RUN]
20:55:05.823007 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
20:55:05.821194 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
20:55:05.823864 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
20:55:05.826102 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
20:55:05.826689 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
20:55:05.826864 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
20:55:05.827136 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
20:55:05.827290 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
20:55:05.828612 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
20:55:05.827590 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
20:55:05.830066 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
20:55:05.827400 [debug] [Thread-3  ]: finished collecting timing info
20:55:05.830237 [debug] [Thread-2  ]: finished collecting timing info
20:55:05.830768 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
20:55:05.830418 [debug] [Thread-4  ]: finished collecting timing info
20:55:05.836301 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
20:55:05.830588 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
20:55:05.838077 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
20:55:05.844288 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:55:05.843838 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
20:55:05.842457 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
20:55:05.844424 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
20:55:05.845059 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:55:05.844912 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:55:05.845412 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
20:55:05.845508 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:55:05.827759 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:55:05.846192 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
20:55:05.846433 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:55:05.846534 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:55:05.847124 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
20:55:05.847275 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:55:05.851111 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
20:55:05.851298 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
20:55:05.851433 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:55:05.851950 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */


  create  table "erp_oltp"."public"."stg_orders__dbt_tmp"
  as (
    with orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
)
select * from orders
  );
20:55:05.851543 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:55:05.852148 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
20:55:05.852398 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:55:05.852475 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
20:55:05.852274 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)
select * from customers
  );
20:55:05.857273 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:55:05.857439 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:55:05.857504 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:55:05.864196 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.01 seconds
20:55:05.864487 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
20:55:05.868527 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:55:05.870046 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:55:05.870481 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:55:05.870252 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.02 seconds
20:55:05.870353 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
20:55:05.872296 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:55:05.872550 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
20:55:05.870192 [debug] [Thread-4  ]: SQL status: SELECT 295 in 0.02 seconds
20:55:05.873700 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:55:05.873789 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
20:55:05.872395 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:55:05.873864 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
20:55:05.874872 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:55:05.876237 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:55:05.875033 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
20:55:05.876096 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:55:05.874978 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
20:55:05.878634 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:55:05.878713 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
20:55:05.877575 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
20:55:05.877502 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:55:05.877380 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:55:05.885166 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
20:55:05.885011 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
20:55:05.878969 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
20:55:05.888067 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
20:55:05.888946 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
20:55:05.889397 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:55:05.889198 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
20:55:05.890105 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
20:55:05.889465 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
20:55:05.889121 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:55:05.890317 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:55:05.890386 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:55:05.890187 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:55:05.890597 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
20:55:05.889306 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:55:05.890770 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
20:55:05.892811 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
20:55:05.895660 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:55:05.895764 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop table if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
20:55:05.895867 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
20:55:05.895949 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
20:55:05.896049 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
20:55:05.897046 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:55:05.898728 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:55:05.900085 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
20:55:05.899895 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
20:55:05.899976 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
20:55:05.899760 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:55:05.900995 [debug] [Thread-4  ]: finished collecting timing info
20:55:05.901303 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
20:55:05.903019 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '088ac8ab-0ff5-4e13-9c61-4007aec6a16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f463dd30>]}
20:55:05.903396 [info ] [Thread-4  ]: 4 of 7 OK created table model public.stg_orders ................................ [[32mSELECT 295[0m in 0.08s]
20:55:05.903132 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
20:55:05.901199 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
20:55:05.903722 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
20:55:05.903789 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
20:55:05.904442 [debug] [Thread-2  ]: finished collecting timing info
20:55:05.905255 [debug] [Thread-3  ]: finished collecting timing info
20:55:05.905598 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
20:55:05.905792 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:55:05.906359 [debug] [Thread-1  ]: finished collecting timing info
20:55:05.906456 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
20:55:05.905463 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
20:55:05.906864 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '088ac8ab-0ff5-4e13-9c61-4007aec6a16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f81a1040>]}
20:55:05.907850 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.10s]
20:55:05.907068 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '088ac8ab-0ff5-4e13-9c61-4007aec6a16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f5ea7e20>]}
20:55:05.908252 [info ] [Thread-3  ]: 3 of 7 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.09s]
20:55:05.908104 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
20:55:05.908478 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
20:55:05.908794 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '088ac8ab-0ff5-4e13-9c61-4007aec6a16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f5ea7850>]}
20:55:05.909121 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
20:55:05.909434 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
20:55:05.909670 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
20:55:05.909748 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
20:55:05.909814 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
20:55:05.911193 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
20:55:05.911501 [debug] [Thread-6  ]: finished collecting timing info
20:55:05.911624 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
20:55:05.909268 [debug] [Thread-9  ]: Began running node model.first_project.customers2
20:55:05.913338 [info ] [Thread-9  ]: 7 of 7 START table model public.customers2 ..................................... [RUN]
20:55:05.913684 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers2"
20:55:05.913158 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.08s]
20:55:05.913987 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
20:55:05.909208 [debug] [Thread-8  ]: Began running node model.first_project.customers
20:55:05.914197 [info ] [Thread-8  ]: 6 of 7 START table model public.customers ...................................... [RUN]
20:55:05.914447 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
20:55:05.914523 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
20:55:05.914585 [debug] [Thread-8  ]: Compiling model.first_project.customers
20:55:05.915988 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
20:55:05.916186 [debug] [Thread-8  ]: finished collecting timing info
20:55:05.916313 [debug] [Thread-8  ]: Began executing node model.first_project.customers
20:55:05.913771 [debug] [Thread-9  ]: Began compiling node model.first_project.customers2
20:55:05.912958 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
20:55:05.921693 [debug] [Thread-9  ]: Compiling model.first_project.customers2
20:55:05.923562 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers2"
20:55:05.921431 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
20:55:05.923939 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:55:05.924050 [debug] [Thread-9  ]: finished collecting timing info
20:55:05.924224 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
20:55:05.924381 [debug] [Thread-9  ]: Began executing node model.first_project.customers2
20:55:05.926292 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.customers2"
20:55:05.924559 [debug] [Thread-6  ]: Opening a new connection, currently in state init
20:55:05.924472 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:55:05.926714 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
20:55:05.926771 [debug] [Thread-8  ]: Opening a new connection, currently in state init
20:55:05.926629 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
20:55:05.927100 [debug] [Thread-9  ]: On model.first_project.customers2: BEGIN
20:55:05.927167 [debug] [Thread-9  ]: Opening a new connection, currently in state init
20:55:05.932409 [debug] [Thread-9  ]: SQL status: BEGIN in 0.01 seconds
20:55:05.932568 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
20:55:05.932640 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
20:55:05.934562 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
20:55:05.934761 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:55:05.934847 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    

with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
   customers.customer_id,
   customers.first_name,
   customers.last_name,
   customer_orders.first_order_date,
   customer_orders.most_recent_order_date,
   coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
   customers.state
 from customers
 left join customer_orders using (customer_id)
 WHERE customers.customer_id != 63
)
select * from final
  );
20:55:05.934946 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
20:55:05.935052 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:55:05.935149 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
20:55:05.939680 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
20:55:05.941548 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:55:05.941682 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:55:05.942000 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
20:55:05.942759 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
20:55:05.942848 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:55:05.942908 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
20:55:05.942991 [debug] [Thread-8  ]: SQL status: SELECT 98 in 0.01 seconds
20:55:05.944252 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:55:05.944335 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
20:55:05.944439 [debug] [Thread-9  ]: SQL status: SELECT 100 in 0.01 seconds
20:55:05.945473 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
20:55:05.945625 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
20:55:05.945864 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
20:55:05.946856 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
20:55:05.946944 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
20:55:05.947158 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
20:55:05.947947 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
20:55:05.948033 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
20:55:05.948092 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
20:55:05.948233 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
20:55:05.948332 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
20:55:05.949174 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:55:05.950664 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:55:05.951183 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
20:55:05.951057 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
20:55:05.950942 [debug] [Thread-9  ]: SQL status: COMMIT in 0.0 seconds
20:55:05.952149 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
20:55:05.952234 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
20:55:05.952499 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
20:55:05.953223 [debug] [Thread-6  ]: finished collecting timing info
20:55:05.953382 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
20:55:05.953494 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
20:55:05.954363 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
20:55:05.954519 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:55:05.954813 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '088ac8ab-0ff5-4e13-9c61-4007aec6a16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f456ef40>]}
20:55:05.955654 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
20:55:05.955914 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
20:55:05.956266 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
20:55:05.956644 [debug] [Thread-9  ]: SQL status: DROP TABLE in 0.0 seconds
20:55:05.957342 [debug] [Thread-9  ]: finished collecting timing info
20:55:05.957438 [debug] [Thread-9  ]: On model.first_project.customers2: Close
20:55:05.957695 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '088ac8ab-0ff5-4e13-9c61-4007aec6a16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f4614e50>]}
20:55:05.957902 [info ] [Thread-9  ]: 7 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.04s]
20:55:05.958159 [debug] [Thread-9  ]: Finished running node model.first_project.customers2
20:55:05.959747 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
20:55:05.960620 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:55:05.960708 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
20:55:05.962254 [debug] [Thread-8  ]: SQL status: DROP TABLE in 0.0 seconds
20:55:05.963154 [debug] [Thread-8  ]: finished collecting timing info
20:55:05.963262 [debug] [Thread-8  ]: On model.first_project.customers: Close
20:55:05.963528 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '088ac8ab-0ff5-4e13-9c61-4007aec6a16c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f4614610>]}
20:55:05.963730 [info ] [Thread-8  ]: 6 of 7 OK created table model public.customers ................................. [[32mSELECT 98[0m in 0.05s]
20:55:05.964905 [debug] [Thread-8  ]: Finished running node model.first_project.customers
20:55:05.966064 [debug] [MainThread]: Acquiring new postgres connection "master"
20:55:05.966176 [debug] [MainThread]: Using postgres connection "master"
20:55:05.966242 [debug] [MainThread]: On master: BEGIN
20:55:05.966312 [debug] [MainThread]: Opening a new connection, currently in state closed
20:55:05.972505 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:55:05.972785 [debug] [MainThread]: On master: COMMIT
20:55:05.972867 [debug] [MainThread]: Using postgres connection "master"
20:55:05.972929 [debug] [MainThread]: On master: COMMIT
20:55:05.973092 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:55:05.973201 [debug] [MainThread]: On master: Close
20:55:05.973580 [info ] [MainThread]: 
20:55:05.973768 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0.27s.
20:55:05.973891 [debug] [MainThread]: Connection 'master' was properly closed.
20:55:05.973949 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
20:55:05.974002 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
20:55:05.974055 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
20:55:05.974106 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
20:55:05.974157 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
20:55:05.974207 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
20:55:05.974323 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
20:55:05.977346 [info ] [MainThread]: 
20:55:05.977508 [info ] [MainThread]: [32mCompleted successfully[0m
20:55:05.977688 [info ] [MainThread]: 
20:55:05.977797 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
20:55:05.977968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f5f85160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f6012e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6f5e883d0>]}


============================== 2022-06-10 20:55:51.783738 | 9017b78a-7606-47d6-beae-89c29979c046 ==============================
20:55:51.783750 [info ] [MainThread]: Running with dbt=1.1.0
20:55:51.784174 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
20:55:51.784293 [debug] [MainThread]: Tracking: tracking
20:55:51.786499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd320fe4640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd320fe4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd320fe4430>]}
20:55:51.812819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:55:51.813062 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:55:51.817065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9017b78a-7606-47d6-beae-89c29979c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd320e9d0d0>]}
20:55:51.820308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9017b78a-7606-47d6-beae-89c29979c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd320f3ff40>]}
20:55:51.820511 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:55:51.820650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9017b78a-7606-47d6-beae-89c29979c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd320efd040>]}
20:55:51.821903 [info ] [MainThread]: 
20:55:51.822524 [debug] [MainThread]: Acquiring new postgres connection "master"
20:55:51.823348 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
20:55:51.829745 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:55:51.829853 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
20:55:51.829919 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:55:51.834179 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:55:51.834293 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:55:51.834358 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:55:51.835562 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
20:55:51.836522 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
20:55:51.836673 [debug] [ThreadPool]: On list_erp_oltp_public: Close
20:55:51.840032 [debug] [MainThread]: Using postgres connection "master"
20:55:51.840205 [debug] [MainThread]: On master: BEGIN
20:55:51.840272 [debug] [MainThread]: Opening a new connection, currently in state init
20:55:51.844609 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:55:51.844809 [debug] [MainThread]: Using postgres connection "master"
20:55:51.844896 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:55:51.855093 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
20:55:51.856171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9017b78a-7606-47d6-beae-89c29979c046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd320f3fcd0>]}
20:55:51.856376 [debug] [MainThread]: On master: ROLLBACK
20:55:51.856666 [debug] [MainThread]: On master: Close
20:55:51.857054 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:55:51.857272 [info ] [MainThread]: 
20:55:51.861506 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
20:55:51.861724 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
20:55:51.861810 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
20:55:51.861883 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
20:55:51.863250 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
20:55:51.863491 [debug] [Thread-1  ]: finished collecting timing info
20:55:51.863576 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
20:55:51.863659 [debug] [Thread-1  ]: finished collecting timing info
20:55:51.863781 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
20:55:51.864317 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
20:55:51.864402 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
20:55:51.864460 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
20:55:51.863891 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
20:55:51.866335 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
20:55:51.866422 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
20:55:51.866481 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
20:55:51.866041 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
20:55:51.897080 [debug] [Thread-2  ]: finished collecting timing info
20:55:51.897231 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
20:55:51.863943 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
20:55:51.897650 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
20:55:51.897766 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
20:55:51.897851 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
20:55:51.897309 [debug] [Thread-2  ]: finished collecting timing info
20:55:51.898920 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
20:55:51.863840 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
20:55:51.864165 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
20:55:51.898582 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
20:55:51.899370 [debug] [Thread-5  ]: finished collecting timing info
20:55:51.899107 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
20:55:51.899452 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
20:55:51.900090 [debug] [Thread-5  ]: finished collecting timing info
20:55:51.900292 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
20:55:51.900383 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
20:55:51.899972 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
20:55:51.900811 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
20:55:51.900897 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
20:55:51.900506 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
20:55:51.901105 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
20:55:51.901185 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
20:55:51.900959 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
20:55:51.899884 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
20:55:51.912762 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
20:55:51.896658 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
20:55:51.907589 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
20:55:51.912505 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
20:55:51.913471 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
20:55:51.899726 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
20:55:51.914394 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
20:55:51.914482 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
20:55:51.914546 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
20:55:51.915548 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
20:55:51.915732 [debug] [Thread-7  ]: finished collecting timing info
20:55:51.915844 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
20:55:51.916121 [debug] [Thread-7  ]: finished collecting timing info
20:55:51.915949 [debug] [Thread-8  ]: finished collecting timing info
20:55:51.916830 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
20:55:51.916433 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
20:55:51.914139 [debug] [Thread-3  ]: finished collecting timing info
20:55:51.917126 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
20:55:51.916922 [debug] [Thread-8  ]: finished collecting timing info
20:55:51.917755 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
20:55:51.916549 [debug] [Thread-5  ]: finished collecting timing info
20:55:51.917346 [debug] [Thread-3  ]: finished collecting timing info
20:55:51.917498 [debug] [Thread-10 ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
20:55:51.918498 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
20:55:51.918584 [debug] [Thread-10 ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
20:55:51.918653 [debug] [Thread-10 ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
20:55:51.918255 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
20:55:51.917859 [debug] [Thread-8  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
20:55:51.918044 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
20:55:51.920445 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
20:55:51.916025 [debug] [Thread-4  ]: finished collecting timing info
20:55:51.921374 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
20:55:51.921042 [debug] [Thread-5  ]: finished collecting timing info
20:55:51.921192 [debug] [Thread-2  ]: Began running node model.first_project.customers2
20:55:51.922303 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers2"
20:55:51.922411 [debug] [Thread-2  ]: Began compiling node model.first_project.customers2
20:55:51.922474 [debug] [Thread-2  ]: Compiling model.first_project.customers2
20:55:51.922065 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
20:55:51.923782 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers2"
20:55:51.920871 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
20:55:51.924285 [debug] [Thread-8  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
20:55:51.924355 [debug] [Thread-8  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
20:55:51.924156 [debug] [Thread-2  ]: finished collecting timing info
20:55:51.926248 [debug] [Thread-2  ]: Began executing node model.first_project.customers2
20:55:51.921732 [debug] [Thread-10 ]: finished collecting timing info
20:55:51.926322 [debug] [Thread-2  ]: finished collecting timing info
20:55:51.926664 [debug] [Thread-2  ]: Finished running node model.first_project.customers2
20:55:51.921514 [debug] [Thread-4  ]: finished collecting timing info
20:55:51.926427 [debug] [Thread-10 ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
20:55:51.926145 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
20:55:51.927037 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
20:55:51.927485 [debug] [Thread-10 ]: finished collecting timing info
20:55:51.927837 [debug] [Thread-9  ]: Began running node model.first_project.customers
20:55:51.928203 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers"
20:55:51.928393 [debug] [Thread-9  ]: Began compiling node model.first_project.customers
20:55:51.928308 [debug] [Thread-8  ]: finished collecting timing info
20:55:51.928466 [debug] [Thread-9  ]: Compiling model.first_project.customers
20:55:51.930054 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers"
20:55:51.928554 [debug] [Thread-8  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
20:55:51.928030 [debug] [Thread-10 ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
20:55:51.930242 [debug] [Thread-8  ]: finished collecting timing info
20:55:51.930359 [debug] [Thread-9  ]: finished collecting timing info
20:55:51.930723 [debug] [Thread-8  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
20:55:51.930820 [debug] [Thread-9  ]: Began executing node model.first_project.customers
20:55:51.930982 [debug] [Thread-9  ]: finished collecting timing info
20:55:51.931171 [debug] [Thread-9  ]: Finished running node model.first_project.customers
20:55:51.931507 [debug] [Thread-6  ]: Began running node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
20:55:51.931699 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a"
20:55:51.931789 [debug] [Thread-6  ]: Began compiling node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
20:55:51.931847 [debug] [Thread-6  ]: Compiling test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
20:55:51.938670 [debug] [Thread-3  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
20:55:51.938806 [debug] [Thread-1  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
20:55:51.940119 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
20:55:51.939938 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
20:55:51.940292 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
20:55:51.940201 [debug] [Thread-1  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
20:55:51.940459 [debug] [Thread-1  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
20:55:51.940374 [debug] [Thread-3  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
20:55:51.946529 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
20:55:51.944564 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
20:55:51.947035 [debug] [Thread-1  ]: finished collecting timing info
20:55:51.946758 [debug] [Thread-3  ]: finished collecting timing info
20:55:51.947301 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
20:55:51.947390 [debug] [Thread-3  ]: finished collecting timing info
20:55:51.947153 [debug] [Thread-1  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
20:55:51.947746 [debug] [Thread-1  ]: finished collecting timing info
20:55:51.939775 [debug] [Thread-5  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
20:55:51.948208 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
20:55:51.948297 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
20:55:51.947949 [debug] [Thread-1  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
20:55:51.948361 [debug] [Thread-5  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
20:55:51.950222 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
20:55:51.950426 [debug] [Thread-5  ]: finished collecting timing info
20:55:51.950511 [debug] [Thread-5  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
20:55:51.950585 [debug] [Thread-5  ]: finished collecting timing info
20:55:51.950763 [debug] [Thread-5  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
20:55:51.947582 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
20:55:51.939642 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a"
20:55:51.951029 [debug] [Thread-6  ]: finished collecting timing info
20:55:51.951121 [debug] [Thread-6  ]: Began executing node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
20:55:51.951186 [debug] [Thread-6  ]: finished collecting timing info
20:55:51.951367 [debug] [Thread-6  ]: Finished running node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
20:55:51.952217 [debug] [MainThread]: Connection 'master' was properly closed.
20:55:51.952307 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
20:55:51.952363 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
20:55:51.952414 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
20:55:51.952462 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
20:55:51.952510 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
20:55:51.952557 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
20:55:51.952605 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
20:55:51.952652 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
20:55:51.952700 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
20:55:51.952773 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a' was properly closed.
20:55:51.955463 [info ] [MainThread]: Done.
20:55:51.960910 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
20:55:51.961025 [info ] [MainThread]: Building catalog
20:55:51.962229 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
20:55:51.966083 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
20:55:51.966183 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
20:55:51.966252 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:55:51.971604 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:55:51.971827 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
20:55:51.971897 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
20:55:51.979343 [debug] [ThreadPool]: SQL status: SELECT 77 in 0.01 seconds
20:55:51.986426 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
20:55:51.986882 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
20:55:51.993412 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/dbt_first_project/target/catalog.json
20:55:51.993703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd320fe4640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3227fc7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3227fcf40>]}
20:55:52.607910 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
20:55:52.608901 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 20:56:00.545839 | ebdb9284-6d47-4c36-92bb-85be109a3b23 ==============================
20:56:00.545851 [info ] [MainThread]: Running with dbt=1.1.0
20:56:00.546185 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
20:56:00.546270 [debug] [MainThread]: Tracking: tracking
20:56:00.548761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d5030580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d5030730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d5030c10>]}
20:56:00.550297 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
20:56:00.550512 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
20:56:00.550617 [info ] [MainThread]: 
20:56:00.550708 [info ] [MainThread]: 
20:56:00.550812 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-10 21:07:56.573834 | b3ace032-f737-47a1-9ac1-ab414e93fadb ==============================
21:07:56.573855 [info ] [MainThread]: Running with dbt=1.1.0
21:07:56.574336 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
21:07:56.574447 [debug] [MainThread]: Tracking: tracking
21:07:56.576875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b51a5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b51a5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b51a5d00>]}
21:07:56.595462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
21:07:56.595832 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
21:07:56.603864 [debug] [MainThread]: 1603: static parser failed on erp/customers.sql
21:07:56.614956 [debug] [MainThread]: 1602: parser fallback to jinja rendering on erp/customers.sql
21:07:56.666772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3ace032-f737-47a1-9ac1-ab414e93fadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b6f9bf70>]}
21:07:56.670280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3ace032-f737-47a1-9ac1-ab414e93fadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b5070490>]}
21:07:56.670511 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
21:07:56.670667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3ace032-f737-47a1-9ac1-ab414e93fadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b509b220>]}
21:07:56.671662 [info ] [MainThread]: 
21:07:56.671991 [debug] [MainThread]: Acquiring new postgres connection "master"
21:07:56.672919 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
21:07:56.679106 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
21:07:56.679236 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
21:07:56.679300 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:07:56.685510 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
21:07:56.686379 [debug] [ThreadPool]: On list_erp_oltp: Close
21:07:56.687512 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
21:07:56.692188 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
21:07:56.692559 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
21:07:56.692664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:07:56.697692 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
21:07:56.697920 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
21:07:56.697995 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
21:07:56.699460 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
21:07:56.700350 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
21:07:56.700692 [debug] [ThreadPool]: On list_erp_oltp_public: Close
21:07:56.703478 [debug] [MainThread]: Using postgres connection "master"
21:07:56.703576 [debug] [MainThread]: On master: BEGIN
21:07:56.703640 [debug] [MainThread]: Opening a new connection, currently in state init
21:07:56.709052 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
21:07:56.709364 [debug] [MainThread]: Using postgres connection "master"
21:07:56.709474 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
21:07:56.719327 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
21:07:56.720346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3ace032-f737-47a1-9ac1-ab414e93fadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b50d3eb0>]}
21:07:56.720621 [debug] [MainThread]: On master: ROLLBACK
21:07:56.721021 [debug] [MainThread]: Using postgres connection "master"
21:07:56.721127 [debug] [MainThread]: On master: BEGIN
21:07:56.721302 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:07:56.721380 [debug] [MainThread]: On master: COMMIT
21:07:56.721460 [debug] [MainThread]: Using postgres connection "master"
21:07:56.721519 [debug] [MainThread]: On master: COMMIT
21:07:56.721624 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:07:56.721701 [debug] [MainThread]: On master: Close
21:07:56.721951 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
21:07:56.722091 [info ] [MainThread]: 
21:07:56.731085 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
21:07:56.731556 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
21:07:56.732148 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
21:07:56.732271 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
21:07:56.732380 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
21:07:56.735149 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
21:07:56.735322 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
21:07:56.735395 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
21:07:56.735851 [info ] [Thread-3  ]: 3 of 7 START table model public.stg_customers .................................. [RUN]
21:07:56.736260 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
21:07:56.736413 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
21:07:56.736495 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
21:07:56.735455 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
21:07:56.737874 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
21:07:56.735695 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
21:07:56.738332 [info ] [Thread-4  ]: 4 of 7 START table model public.stg_orders ..................................... [RUN]
21:07:56.738710 [debug] [Thread-1  ]: finished collecting timing info
21:07:56.739094 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
21:07:56.739427 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
21:07:56.739707 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
21:07:56.740085 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
21:07:56.741556 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
21:07:56.739894 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
21:07:56.739815 [debug] [Thread-3  ]: finished collecting timing info
21:07:56.742065 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
21:07:56.741722 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
21:07:56.741955 [debug] [Thread-2  ]: finished collecting timing info
21:07:56.739608 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
21:07:56.760365 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
21:07:56.757756 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
21:07:56.748312 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
21:07:56.758670 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
21:07:56.767848 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
21:07:56.771623 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
21:07:56.772078 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
21:07:56.772747 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:07:56.772470 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
21:07:56.772332 [debug] [Thread-4  ]: finished collecting timing info
21:07:56.773428 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
21:07:56.773125 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
21:07:56.775130 [debug] [Thread-3  ]: Opening a new connection, currently in state init
21:07:56.774975 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
21:07:56.775413 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
21:07:56.775510 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
21:07:56.775565 [debug] [Thread-4  ]: Opening a new connection, currently in state init
21:07:56.772866 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
21:07:56.776098 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
21:07:56.776174 [debug] [Thread-2  ]: Opening a new connection, currently in state init
21:07:56.778567 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
21:07:56.778692 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
21:07:56.778755 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
21:07:56.779780 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
21:07:56.784553 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
21:07:56.784791 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
21:07:56.785026 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
21:07:56.785170 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
21:07:56.785243 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)
select * from customers
  );
21:07:56.785328 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
21:07:56.787153 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
21:07:56.787296 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.0 seconds
21:07:56.788890 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
21:07:56.788979 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
21:07:56.787369 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
21:07:56.789073 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
21:07:56.787618 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
21:07:56.789129 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
21:07:56.789461 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
21:07:56.795334 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
21:07:56.795457 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
21:07:56.795610 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
21:07:56.798783 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
21:07:56.797362 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
21:07:56.797530 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
21:07:56.799080 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
21:07:56.799145 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */


  create  table "erp_oltp"."public"."stg_orders__dbt_tmp"
  as (
    with orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
)
select * from orders
  );
21:07:56.798971 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
21:07:56.798875 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
21:07:56.795886 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
21:07:56.799310 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
21:07:56.799585 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
21:07:56.800874 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
21:07:56.800956 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
21:07:56.801267 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
21:07:56.802029 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
21:07:56.802115 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
21:07:56.802174 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
21:07:56.802264 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
21:07:56.802915 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
21:07:56.803017 [debug] [Thread-4  ]: SQL status: SELECT 295 in 0.0 seconds
21:07:56.804586 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
21:07:56.803198 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
21:07:56.804693 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
21:07:56.804771 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
21:07:56.807506 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
21:07:56.804856 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
21:07:56.807608 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
21:07:56.803123 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
21:07:56.808797 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
21:07:56.808914 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
21:07:56.809045 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
21:07:56.809126 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
21:07:56.810231 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
21:07:56.811990 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
21:07:56.811779 [debug] [Thread-3  ]: finished collecting timing info
21:07:56.812138 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
21:07:56.810346 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
21:07:56.811885 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
21:07:56.814059 [debug] [Thread-1  ]: finished collecting timing info
21:07:56.813048 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
21:07:56.814573 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
21:07:56.814164 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
21:07:56.815674 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
21:07:56.813475 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
21:07:56.813350 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ace032-f737-47a1-9ac1-ab414e93fadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b4fa3c70>]}
21:07:56.816633 [debug] [Thread-2  ]: finished collecting timing info
21:07:56.817012 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ace032-f737-47a1-9ac1-ab414e93fadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b4fa4c70>]}
21:07:56.817879 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
21:07:56.818205 [info ] [Thread-3  ]: 3 of 7 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.08s]
21:07:56.818368 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
21:07:56.819102 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
21:07:56.818722 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
21:07:56.818584 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
21:07:56.821222 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
21:07:56.820457 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
21:07:56.820923 [debug] [Thread-6  ]: Began running node model.first_project.customers2
21:07:56.821815 [info ] [Thread-6  ]: 5 of 7 START table model public.customers2 ..................................... [RUN]
21:07:56.822061 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
21:07:56.822137 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
21:07:56.822201 [debug] [Thread-6  ]: Compiling model.first_project.customers2
21:07:56.823847 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
21:07:56.824108 [debug] [Thread-6  ]: finished collecting timing info
21:07:56.824245 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
21:07:56.821635 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
21:07:56.825979 [info ] [Thread-8  ]: 6 of 7 START view model public.my_second_dbt_model ............................. [RUN]
21:07:56.820717 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ace032-f737-47a1-9ac1-ab414e93fadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b5049d00>]}
21:07:56.826267 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
21:07:56.826715 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
21:07:56.826589 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.08s]
21:07:56.826795 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
21:07:56.828162 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
21:07:56.826862 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
21:07:56.829493 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
21:07:56.829577 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop table if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
21:07:56.828561 [debug] [Thread-8  ]: finished collecting timing info
21:07:56.829673 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
21:07:56.828390 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
21:07:56.831586 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
21:07:56.832568 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
21:07:56.832678 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
21:07:56.832778 [debug] [Thread-8  ]: Opening a new connection, currently in state init
21:07:56.825767 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
21:07:56.833534 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
21:07:56.833621 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
21:07:56.833692 [debug] [Thread-6  ]: Opening a new connection, currently in state init
21:07:56.834225 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
21:07:56.834903 [debug] [Thread-4  ]: finished collecting timing info
21:07:56.835004 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
21:07:56.835486 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ace032-f737-47a1-9ac1-ab414e93fadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b46f21f0>]}
21:07:56.835715 [info ] [Thread-4  ]: 4 of 7 OK created table model public.stg_orders ................................ [[32mSELECT 295[0m in 0.10s]
21:07:56.835934 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
21:07:56.836347 [debug] [Thread-10 ]: Began running node model.first_project.customers
21:07:56.836479 [info ] [Thread-10 ]: 7 of 7 START table model public.customers ...................................... [RUN]
21:07:56.836760 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
21:07:56.836845 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
21:07:56.836911 [debug] [Thread-10 ]: Compiling model.first_project.customers
21:07:56.838951 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
21:07:56.839272 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
21:07:56.839503 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
21:07:56.840986 [debug] [Thread-10 ]: finished collecting timing info
21:07:56.841120 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
21:07:56.841266 [debug] [Thread-10 ]: Began executing node model.first_project.customers
21:07:56.844305 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.customers"
21:07:56.844521 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
21:07:56.847620 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
21:07:56.847863 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
21:07:56.848441 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
21:07:56.848622 [debug] [Thread-10 ]: On model.first_project.customers: BEGIN
21:07:56.848817 [debug] [Thread-10 ]: Opening a new connection, currently in state init
21:07:56.849051 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
21:07:56.849865 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
21:07:56.850020 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
21:07:56.850106 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
21:07:56.850196 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
21:07:56.850382 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
21:07:56.850511 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
21:07:56.851936 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
21:07:56.853450 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
21:07:56.853542 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
21:07:56.853638 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
21:07:56.854565 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
21:07:56.855272 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
21:07:56.855367 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
21:07:56.858397 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
21:07:56.858575 [debug] [Thread-10 ]: SQL status: BEGIN in 0.01 seconds
21:07:56.858783 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
21:07:56.858837 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    



with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
   select
     customer_id,
     min(order_date) as first_order_date,
     max(order_date) as most_recent_order_date,
     count(order_id) as number_of_orders
   from orders
   group by 1
),
final as (
   select
     customers.customer_id,
     
     'customers.customers.first_name',
     
     'customers.customers.last_name',
     
     customer_orders.first_order_date,
     customer_orders.most_recent_order_date,
     coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
     customers.state
   from customers
     left join customer_orders using (customer_id)
     WHERE customers.customer_id != 63
)
select * from final
  );
21:07:56.858712 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
21:07:56.860323 [debug] [Thread-10 ]: Postgres adapter: Postgres error: column "?column?" specified more than once

21:07:56.859156 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
21:07:56.860427 [debug] [Thread-10 ]: On model.first_project.customers: ROLLBACK
21:07:56.860540 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
21:07:56.861385 [debug] [Thread-8  ]: finished collecting timing info
21:07:56.862356 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
21:07:56.862524 [debug] [Thread-10 ]: finished collecting timing info
21:07:56.862644 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
21:07:56.862833 [debug] [Thread-10 ]: On model.first_project.customers: Close
21:07:56.863299 [debug] [Thread-10 ]: Database Error in model customers (models/erp/customers.sql)
  column "?column?" specified more than once
  compiled SQL at target/run/first_project/models/erp/customers.sql
21:07:56.863505 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ace032-f737-47a1-9ac1-ab414e93fadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b46c7ca0>]}
21:07:56.863788 [error] [Thread-10 ]: 7 of 7 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.03s]
21:07:56.864270 [debug] [Thread-10 ]: Finished running node model.first_project.customers
21:07:56.862749 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
21:07:56.864595 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
21:07:56.865678 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ace032-f737-47a1-9ac1-ab414e93fadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b46c81f0>]}
21:07:56.866037 [info ] [Thread-8  ]: 6 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
21:07:56.866476 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
21:07:56.866561 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
21:07:56.867648 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
21:07:56.867736 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
21:07:56.868759 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
21:07:56.869476 [debug] [Thread-6  ]: finished collecting timing info
21:07:56.869615 [debug] [Thread-6  ]: On model.first_project.customers2: Close
21:07:56.869882 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ace032-f737-47a1-9ac1-ab414e93fadb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b46d3dc0>]}
21:07:56.870073 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.05s]
21:07:56.870282 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
21:07:56.872361 [debug] [MainThread]: Acquiring new postgres connection "master"
21:07:56.872473 [debug] [MainThread]: Using postgres connection "master"
21:07:56.872537 [debug] [MainThread]: On master: BEGIN
21:07:56.872594 [debug] [MainThread]: Opening a new connection, currently in state closed
21:07:56.878395 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
21:07:56.878614 [debug] [MainThread]: On master: COMMIT
21:07:56.878686 [debug] [MainThread]: Using postgres connection "master"
21:07:56.878748 [debug] [MainThread]: On master: COMMIT
21:07:56.878893 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:07:56.879148 [debug] [MainThread]: On master: Close
21:07:56.879623 [info ] [MainThread]: 
21:07:56.879799 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0.21s.
21:07:56.879913 [debug] [MainThread]: Connection 'master' was properly closed.
21:07:56.879971 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
21:07:56.880076 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
21:07:56.880153 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
21:07:56.880228 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
21:07:56.880303 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
21:07:56.880376 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
21:07:56.880459 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
21:07:56.887168 [info ] [MainThread]: 
21:07:56.887385 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
21:07:56.887521 [info ] [MainThread]: 
21:07:56.887620 [error] [MainThread]: [33mDatabase Error in model customers (models/erp/customers.sql)[0m
21:07:56.887719 [error] [MainThread]:   column "?column?" specified more than once
21:07:56.887827 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/customers.sql
21:07:56.887932 [info ] [MainThread]: 
21:07:56.888030 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
21:07:56.888203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b50d3df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b509b1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b4f6eb50>]}


============================== 2022-06-10 21:08:39.774795 | a3d441fd-dd3a-42eb-96b2-5b37a461c634 ==============================
21:08:39.774806 [info ] [MainThread]: Running with dbt=1.1.0
21:08:39.775151 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
21:08:39.775235 [debug] [MainThread]: Tracking: tracking
21:08:39.777556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d43933c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d43933be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d43933d00>]}
21:08:39.795996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
21:08:39.796354 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
21:08:39.805138 [debug] [MainThread]: 1603: static parser failed on erp/customers.sql
21:08:39.814528 [debug] [MainThread]: 1602: parser fallback to jinja rendering on erp/customers.sql
21:08:39.875703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3d441fd-dd3a-42eb-96b2-5b37a461c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4572af70>]}
21:08:39.879130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3d441fd-dd3a-42eb-96b2-5b37a461c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d43800490>]}
21:08:39.879372 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
21:08:39.879516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3d441fd-dd3a-42eb-96b2-5b37a461c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4382b220>]}
21:08:39.880511 [info ] [MainThread]: 
21:08:39.880816 [debug] [MainThread]: Acquiring new postgres connection "master"
21:08:39.881585 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
21:08:39.887560 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
21:08:39.887665 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
21:08:39.887730 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:08:39.894886 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
21:08:39.895765 [debug] [ThreadPool]: On list_erp_oltp: Close
21:08:39.896988 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
21:08:39.900463 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
21:08:39.900572 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
21:08:39.900761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:08:39.905289 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
21:08:39.905439 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
21:08:39.905530 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
21:08:39.907787 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
21:08:39.909156 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
21:08:39.909592 [debug] [ThreadPool]: On list_erp_oltp_public: Close
21:08:39.913044 [debug] [MainThread]: Using postgres connection "master"
21:08:39.913175 [debug] [MainThread]: On master: BEGIN
21:08:39.913251 [debug] [MainThread]: Opening a new connection, currently in state init
21:08:39.917361 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:08:39.917652 [debug] [MainThread]: Using postgres connection "master"
21:08:39.917795 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
21:08:39.927526 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
21:08:39.928572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3d441fd-dd3a-42eb-96b2-5b37a461c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d43863eb0>]}
21:08:39.928837 [debug] [MainThread]: On master: ROLLBACK
21:08:39.929086 [debug] [MainThread]: Using postgres connection "master"
21:08:39.929172 [debug] [MainThread]: On master: BEGIN
21:08:39.929367 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:08:39.929453 [debug] [MainThread]: On master: COMMIT
21:08:39.929511 [debug] [MainThread]: Using postgres connection "master"
21:08:39.929565 [debug] [MainThread]: On master: COMMIT
21:08:39.929713 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:08:39.929794 [debug] [MainThread]: On master: Close
21:08:39.930133 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
21:08:39.930287 [info ] [MainThread]: 
21:08:39.937194 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
21:08:39.937444 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
21:08:39.937737 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
21:08:39.937839 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
21:08:39.937915 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
21:08:39.939302 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
21:08:39.939553 [debug] [Thread-1  ]: finished collecting timing info
21:08:39.939678 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
21:08:39.946280 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
21:08:39.946551 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
21:08:39.960018 [info ] [Thread-3  ]: 3 of 7 START table model public.stg_customers .................................. [RUN]
21:08:39.952495 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
21:08:39.960721 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
21:08:39.960806 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
21:08:39.960370 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
21:08:39.961106 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
21:08:39.961194 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
21:08:39.946654 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
21:08:39.962086 [info ] [Thread-4  ]: 4 of 7 START table model public.stg_orders ..................................... [RUN]
21:08:39.961843 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
21:08:39.959798 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
21:08:39.962323 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
21:08:39.962655 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
21:08:39.962734 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
21:08:39.963457 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
21:08:39.963665 [debug] [Thread-4  ]: finished collecting timing info
21:08:39.963774 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
21:08:39.960874 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
21:08:39.966649 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
21:08:39.966834 [debug] [Thread-2  ]: finished collecting timing info
21:08:39.965417 [debug] [Thread-3  ]: finished collecting timing info
21:08:39.967689 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
21:08:39.967012 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
21:08:39.965251 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
21:08:39.981549 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
21:08:39.981111 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
21:08:39.971011 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
21:08:39.982163 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
21:08:39.982275 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
21:08:39.982341 [debug] [Thread-3  ]: Opening a new connection, currently in state init
21:08:39.981693 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
21:08:39.984494 [debug] [Thread-4  ]: Opening a new connection, currently in state init
21:08:39.984141 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
21:08:39.985014 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
21:08:39.985765 [debug] [Thread-2  ]: Opening a new connection, currently in state init
21:08:39.981774 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
21:08:39.989634 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
21:08:39.990036 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
21:08:39.990217 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
21:08:39.990781 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:08:39.990898 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
21:08:39.993806 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
21:08:39.993953 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
21:08:39.994026 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)
select * from customers
  );
21:08:39.994570 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
21:08:39.994704 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
21:08:39.994797 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */


  create  table "erp_oltp"."public"."stg_orders__dbt_tmp"
  as (
    with orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
)
select * from orders
  );
21:08:39.995605 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.0 seconds
21:08:39.999517 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
21:08:39.999650 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
21:08:39.999985 [debug] [Thread-4  ]: SQL status: SELECT 295 in 0.01 seconds
21:08:40.004468 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
21:08:40.002918 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
21:08:40.004602 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
21:08:39.999892 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
21:08:40.004795 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
21:08:40.005300 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
21:08:40.006412 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
21:08:40.006492 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
21:08:40.006660 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
21:08:40.007692 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
21:08:40.007776 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
21:08:40.007869 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
21:08:40.008056 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
21:08:40.008199 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
21:08:40.009273 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
21:08:40.015650 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
21:08:40.014712 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
21:08:40.015766 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
21:08:40.014597 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
21:08:40.015514 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
21:08:40.016551 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
21:08:40.016779 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
21:08:40.017054 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
21:08:40.019044 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
21:08:40.017304 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
21:08:40.017179 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
21:08:40.019615 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
21:08:40.019174 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
21:08:40.019262 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
21:08:40.019856 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
21:08:40.021722 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
21:08:40.022017 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
21:08:40.021895 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
21:08:40.024882 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
21:08:40.025064 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
21:08:40.025165 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
21:08:40.026469 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
21:08:40.026680 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
21:08:40.025243 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
21:08:40.026591 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
21:08:40.027489 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
21:08:40.028397 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
21:08:40.028190 [debug] [Thread-3  ]: finished collecting timing info
21:08:40.028527 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
21:08:40.028304 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
21:08:40.029685 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
21:08:40.029768 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
21:08:40.029828 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
21:08:40.025294 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
21:08:40.030080 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d441fd-dd3a-42eb-96b2-5b37a461c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d406c5a60>]}
21:08:40.031037 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
21:08:40.031627 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop table if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
21:08:40.031406 [info ] [Thread-3  ]: 3 of 7 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.07s]
21:08:40.031543 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
21:08:40.033081 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
21:08:40.033164 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
21:08:40.031134 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
21:08:40.033344 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
21:08:40.034037 [debug] [Thread-2  ]: finished collecting timing info
21:08:40.035209 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
21:08:40.035108 [debug] [Thread-6  ]: Began running node model.first_project.customers2
21:08:40.035391 [info ] [Thread-6  ]: 5 of 7 START table model public.customers2 ..................................... [RUN]
21:08:40.035670 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
21:08:40.035756 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
21:08:40.035828 [debug] [Thread-6  ]: Compiling model.first_project.customers2
21:08:40.034661 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
21:08:40.038049 [debug] [Thread-4  ]: finished collecting timing info
21:08:40.038376 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
21:08:40.037360 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
21:08:40.038672 [debug] [Thread-6  ]: finished collecting timing info
21:08:40.038783 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
21:08:40.038296 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d441fd-dd3a-42eb-96b2-5b37a461c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4068bd60>]}
21:08:40.040210 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
21:08:40.041116 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
21:08:40.040634 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.08s]
21:08:40.040903 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d441fd-dd3a-42eb-96b2-5b37a461c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d43728e80>]}
21:08:40.041231 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
21:08:40.041795 [debug] [Thread-6  ]: Opening a new connection, currently in state init
21:08:40.041557 [info ] [Thread-4  ]: 4 of 7 OK created table model public.stg_orders ................................ [[32mSELECT 295[0m in 0.08s]
21:08:40.041725 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
21:08:40.040412 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
21:08:40.043015 [debug] [Thread-1  ]: finished collecting timing info
21:08:40.043128 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
21:08:40.043374 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d441fd-dd3a-42eb-96b2-5b37a461c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d43863970>]}
21:08:40.043542 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
21:08:40.046261 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
21:08:40.046748 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
21:08:40.047288 [debug] [Thread-8  ]: Began running node model.first_project.customers
21:08:40.047674 [info ] [Thread-8  ]: 6 of 7 START table model public.customers ...................................... [RUN]
21:08:40.047977 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
21:08:40.048213 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
21:08:40.048301 [debug] [Thread-8  ]: Compiling model.first_project.customers
21:08:40.051673 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
21:08:40.052087 [debug] [Thread-8  ]: finished collecting timing info
21:08:40.052243 [debug] [Thread-8  ]: Began executing node model.first_project.customers
21:08:40.047484 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
21:08:40.053990 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
21:08:40.054256 [info ] [Thread-10 ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
21:08:40.054771 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
21:08:40.054886 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
21:08:40.055023 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
21:08:40.055148 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
21:08:40.055402 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
21:08:40.055312 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
21:08:40.055464 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
21:08:40.055221 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
21:08:40.056621 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
21:08:40.056843 [debug] [Thread-8  ]: Opening a new connection, currently in state init
21:08:40.057132 [debug] [Thread-10 ]: finished collecting timing info
21:08:40.057274 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
21:08:40.061043 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
21:08:40.061327 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
21:08:40.061472 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: BEGIN
21:08:40.061538 [debug] [Thread-10 ]: Opening a new connection, currently in state init
21:08:40.062145 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
21:08:40.062251 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
21:08:40.062316 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    



with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
   select
     customer_id,
     min(order_date) as first_order_date,
     max(order_date) as most_recent_order_date,
     count(order_id) as number_of_orders
   from orders
   group by 1
),
final as (
   select
     customers.customer_id,
     
     customers.customers.first_name,
     
     customers.customers.last_name,
     
     customer_orders.first_order_date,
     customer_orders.most_recent_order_date,
     coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
     customers.state
   from customers
     left join customer_orders using (customer_id)
     WHERE customers.customer_id != 63
)
select * from final
  );
21:08:40.062813 [debug] [Thread-8  ]: Postgres adapter: Postgres error: invalid reference to FROM-clause entry for table "customers"
LINE 29:      customers.customers.first_name,
              ^
HINT:  There is an entry for table "customers", but it cannot be referenced from this part of the query.

21:08:40.062912 [debug] [Thread-8  ]: On model.first_project.customers: ROLLBACK
21:08:40.063087 [debug] [Thread-8  ]: finished collecting timing info
21:08:40.063171 [debug] [Thread-8  ]: On model.first_project.customers: Close
21:08:40.063380 [debug] [Thread-8  ]: Database Error in model customers (models/erp/customers.sql)
  invalid reference to FROM-clause entry for table "customers"
  LINE 29:      customers.customers.first_name,
                ^
  HINT:  There is an entry for table "customers", but it cannot be referenced from this part of the query.
  compiled SQL at target/run/first_project/models/erp/customers.sql
21:08:40.063542 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d441fd-dd3a-42eb-96b2-5b37a461c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d457160a0>]}
21:08:40.063668 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.01 seconds
21:08:40.065203 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
21:08:40.065294 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
21:08:40.065531 [error] [Thread-8  ]: 6 of 7 ERROR creating table model public.customers ............................. [[31mERROR[0m in 0.02s]
21:08:40.066826 [debug] [Thread-8  ]: Finished running node model.first_project.customers
21:08:40.067292 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
21:08:40.069262 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
21:08:40.069423 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
21:08:40.069915 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
21:08:40.070953 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
21:08:40.071047 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
21:08:40.071104 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
21:08:40.072919 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
21:08:40.073938 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
21:08:40.074029 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
21:08:40.076451 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
21:08:40.077157 [debug] [Thread-6  ]: finished collecting timing info
21:08:40.077267 [debug] [Thread-6  ]: On model.first_project.customers2: Close
21:08:40.077638 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d441fd-dd3a-42eb-96b2-5b37a461c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d45716790>]}
21:08:40.077867 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.04s]
21:08:40.078096 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
21:08:40.078813 [debug] [Thread-10 ]: SQL status: BEGIN in 0.02 seconds
21:08:40.078976 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
21:08:40.079045 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
21:08:40.079814 [debug] [Thread-10 ]: SQL status: CREATE VIEW in 0.0 seconds
21:08:40.081075 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
21:08:40.081167 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
21:08:40.081458 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
21:08:40.082205 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
21:08:40.082296 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
21:08:40.082356 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
21:08:40.082870 [debug] [Thread-10 ]: SQL status: COMMIT in 0.0 seconds
21:08:40.083681 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
21:08:40.083796 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
21:08:40.084009 [debug] [Thread-10 ]: SQL status: DROP VIEW in 0.0 seconds
21:08:40.084985 [debug] [Thread-10 ]: finished collecting timing info
21:08:40.085155 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: Close
21:08:40.085568 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3d441fd-dd3a-42eb-96b2-5b37a461c634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d405eed30>]}
21:08:40.085827 [info ] [Thread-10 ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
21:08:40.086114 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
21:08:40.087234 [debug] [MainThread]: Acquiring new postgres connection "master"
21:08:40.087339 [debug] [MainThread]: Using postgres connection "master"
21:08:40.087395 [debug] [MainThread]: On master: BEGIN
21:08:40.087446 [debug] [MainThread]: Opening a new connection, currently in state closed
21:08:40.094150 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
21:08:40.094359 [debug] [MainThread]: On master: COMMIT
21:08:40.094429 [debug] [MainThread]: Using postgres connection "master"
21:08:40.094490 [debug] [MainThread]: On master: COMMIT
21:08:40.094711 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:08:40.094842 [debug] [MainThread]: On master: Close
21:08:40.095174 [info ] [MainThread]: 
21:08:40.095336 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0.21s.
21:08:40.095450 [debug] [MainThread]: Connection 'master' was properly closed.
21:08:40.095503 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
21:08:40.095571 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
21:08:40.095622 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
21:08:40.095670 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
21:08:40.095718 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
21:08:40.095766 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
21:08:40.095814 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
21:08:40.104361 [info ] [MainThread]: 
21:08:40.104773 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
21:08:40.104988 [info ] [MainThread]: 
21:08:40.105154 [error] [MainThread]: [33mDatabase Error in model customers (models/erp/customers.sql)[0m
21:08:40.105273 [error] [MainThread]:   invalid reference to FROM-clause entry for table "customers"
21:08:40.105394 [error] [MainThread]:   LINE 29:      customers.customers.first_name,
21:08:40.105513 [error] [MainThread]:                 ^
21:08:40.105630 [error] [MainThread]:   HINT:  There is an entry for table "customers", but it cannot be referenced from this part of the query.
21:08:40.105746 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/customers.sql
21:08:40.105897 [info ] [MainThread]: 
21:08:40.106023 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
21:08:40.106264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d43838c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d438003d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d40694b80>]}


============================== 2022-06-10 21:09:09.528991 | 61cea421-6c20-4b33-b07d-bfd82698d68a ==============================
21:09:09.529002 [info ] [MainThread]: Running with dbt=1.1.0
21:09:09.529331 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
21:09:09.529436 [debug] [MainThread]: Tracking: tracking
21:09:09.531745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f34b81f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f34b8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f34b8640>]}
21:09:09.548881 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
21:09:09.549279 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
21:09:09.556243 [debug] [MainThread]: 1603: static parser failed on erp/customers.sql
21:09:09.565922 [debug] [MainThread]: 1602: parser fallback to jinja rendering on erp/customers.sql
21:09:09.621066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61cea421-6c20-4b33-b07d-bfd82698d68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f4d17910>]}
21:09:09.624469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61cea421-6c20-4b33-b07d-bfd82698d68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f33824c0>]}
21:09:09.624718 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
21:09:09.624877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61cea421-6c20-4b33-b07d-bfd82698d68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f33ad250>]}
21:09:09.626106 [info ] [MainThread]: 
21:09:09.626460 [debug] [MainThread]: Acquiring new postgres connection "master"
21:09:09.627168 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
21:09:09.632866 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
21:09:09.632976 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
21:09:09.633040 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:09:09.639078 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
21:09:09.639896 [debug] [ThreadPool]: On list_erp_oltp: Close
21:09:09.640887 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
21:09:09.644121 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
21:09:09.644216 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
21:09:09.644274 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:09:09.661140 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
21:09:09.661492 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
21:09:09.661603 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
21:09:09.663164 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
21:09:09.664420 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
21:09:09.665152 [debug] [ThreadPool]: On list_erp_oltp_public: Close
21:09:09.668154 [debug] [MainThread]: Using postgres connection "master"
21:09:09.668255 [debug] [MainThread]: On master: BEGIN
21:09:09.668325 [debug] [MainThread]: Opening a new connection, currently in state init
21:09:09.671840 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:09:09.671949 [debug] [MainThread]: Using postgres connection "master"
21:09:09.672009 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
21:09:09.681000 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
21:09:09.682176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61cea421-6c20-4b33-b07d-bfd82698d68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f3382310>]}
21:09:09.682516 [debug] [MainThread]: On master: ROLLBACK
21:09:09.682923 [debug] [MainThread]: Using postgres connection "master"
21:09:09.683030 [debug] [MainThread]: On master: BEGIN
21:09:09.683517 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:09:09.683622 [debug] [MainThread]: On master: COMMIT
21:09:09.683689 [debug] [MainThread]: Using postgres connection "master"
21:09:09.683742 [debug] [MainThread]: On master: COMMIT
21:09:09.683986 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:09:09.684095 [debug] [MainThread]: On master: Close
21:09:09.684408 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
21:09:09.684584 [info ] [MainThread]: 
21:09:09.688098 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
21:09:09.688305 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
21:09:09.688582 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
21:09:09.688664 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
21:09:09.688795 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
21:09:09.688905 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
21:09:09.690683 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
21:09:09.689041 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
21:09:09.689194 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
21:09:09.688982 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
21:09:09.691309 [info ] [Thread-3  ]: 3 of 7 START table model public.stg_customers .................................. [RUN]
21:09:09.691146 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
21:09:09.691532 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
21:09:09.691763 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
21:09:09.691660 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
21:09:09.690870 [info ] [Thread-4  ]: 4 of 7 START table model public.stg_orders ..................................... [RUN]
21:09:09.692332 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
21:09:09.692409 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
21:09:09.691925 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
21:09:09.691837 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
21:09:09.694520 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
21:09:09.694748 [debug] [Thread-3  ]: finished collecting timing info
21:09:09.693803 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
21:09:09.694834 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
21:09:09.692469 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
21:09:09.692541 [debug] [Thread-1  ]: finished collecting timing info
21:09:09.712758 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
21:09:09.705615 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
21:09:09.718784 [debug] [Thread-4  ]: finished collecting timing info
21:09:09.719029 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
21:09:09.711222 [debug] [Thread-2  ]: finished collecting timing info
21:09:09.727637 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
21:09:09.727401 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
21:09:09.728857 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
21:09:09.739405 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
21:09:09.740912 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
21:09:09.741172 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
21:09:09.741457 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
21:09:09.742248 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
21:09:09.741876 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
21:09:09.742449 [debug] [Thread-3  ]: Opening a new connection, currently in state init
21:09:09.742167 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
21:09:09.742339 [debug] [Thread-4  ]: Opening a new connection, currently in state init
21:09:09.743272 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
21:09:09.743476 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:09:09.741683 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
21:09:09.744647 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
21:09:09.744770 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:09:09.747742 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
21:09:09.747890 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
21:09:09.747985 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */


  create  table "erp_oltp"."public"."stg_customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)
select * from customers
  );
21:09:09.749093 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
21:09:09.749289 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
21:09:09.749353 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
21:09:09.749457 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.0 seconds
21:09:09.753503 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
21:09:09.753785 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
21:09:09.755593 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
21:09:09.755685 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
21:09:09.755790 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
21:09:09.755893 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
21:09:09.753904 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
21:09:09.755969 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */


  create  table "erp_oltp"."public"."stg_orders__dbt_tmp"
  as (
    with orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
)
select * from orders
  );
21:09:09.756856 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
21:09:09.758162 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
21:09:09.758244 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
21:09:09.759416 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
21:09:09.759503 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
21:09:09.759787 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
21:09:09.759589 [debug] [Thread-4  ]: SQL status: SELECT 295 in 0.0 seconds
21:09:09.759876 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
21:09:09.761179 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
21:09:09.761016 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
21:09:09.761340 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
21:09:09.758364 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
21:09:09.767791 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
21:09:09.761461 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
21:09:09.769017 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
21:09:09.769545 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
21:09:09.769143 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
21:09:09.770361 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
21:09:09.770445 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
21:09:09.770500 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
21:09:09.769306 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
21:09:09.770589 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
21:09:09.770644 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
21:09:09.770782 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
21:09:09.771968 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
21:09:09.772069 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
21:09:09.772338 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
21:09:09.773831 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
21:09:09.773940 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
21:09:09.774050 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
21:09:09.777889 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
21:09:09.776930 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
21:09:09.777050 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
21:09:09.777991 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
21:09:09.779039 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
21:09:09.778900 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
21:09:09.779159 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
21:09:09.774144 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
21:09:09.778089 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop table if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
21:09:09.779793 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
21:09:09.780860 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
21:09:09.780953 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
21:09:09.781487 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop table if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
21:09:09.782245 [debug] [Thread-3  ]: finished collecting timing info
21:09:09.782381 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
21:09:09.782461 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
21:09:09.783212 [debug] [Thread-1  ]: finished collecting timing info
21:09:09.784083 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
21:09:09.783931 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
21:09:09.784435 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61cea421-6c20-4b33-b07d-bfd82698d68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f0229040>]}
21:09:09.785684 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.10s]
21:09:09.785344 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
21:09:09.786039 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
21:09:09.785942 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
21:09:09.782596 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
21:09:09.786433 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
21:09:09.786608 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
21:09:09.786842 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
21:09:09.786914 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
21:09:09.786980 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
21:09:09.785426 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
21:09:09.788392 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
21:09:09.789770 [debug] [Thread-6  ]: finished collecting timing info
21:09:09.788812 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
21:09:09.790740 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
21:09:09.789901 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
21:09:09.792144 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
21:09:09.789488 [debug] [Thread-4  ]: finished collecting timing info
21:09:09.792350 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
21:09:09.792570 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
21:09:09.792655 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
21:09:09.792731 [debug] [Thread-6  ]: Opening a new connection, currently in state init
21:09:09.788691 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61cea421-6c20-4b33-b07d-bfd82698d68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f336ee20>]}
21:09:09.790845 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
21:09:09.793610 [info ] [Thread-3  ]: 3 of 7 OK created table model public.stg_customers ............................. [[32mSELECT 100[0m in 0.10s]
21:09:09.793841 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61cea421-6c20-4b33-b07d-bfd82698d68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f0228220>]}
21:09:09.794264 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
21:09:09.794721 [info ] [Thread-4  ]: 4 of 7 OK created table model public.stg_orders ................................ [[32mSELECT 295[0m in 0.10s]
21:09:09.795160 [debug] [Thread-8  ]: Began running node model.first_project.customers2
21:09:09.795283 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
21:09:09.795439 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
21:09:09.795568 [info ] [Thread-8  ]: 6 of 7 START table model public.customers2 ..................................... [RUN]
21:09:09.797399 [debug] [Thread-2  ]: finished collecting timing info
21:09:09.798183 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
21:09:09.798489 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61cea421-6c20-4b33-b07d-bfd82698d68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f336e2e0>]}
21:09:09.798693 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.11s]
21:09:09.798922 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
21:09:09.800846 [debug] [Thread-10 ]: Began running node model.first_project.customers
21:09:09.800999 [info ] [Thread-10 ]: 7 of 7 START table model public.customers ...................................... [RUN]
21:09:09.801222 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
21:09:09.801301 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
21:09:09.801365 [debug] [Thread-10 ]: Compiling model.first_project.customers
21:09:09.804427 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
21:09:09.797944 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers2"
21:09:09.807445 [debug] [Thread-8  ]: Began compiling node model.first_project.customers2
21:09:09.807544 [debug] [Thread-8  ]: Compiling model.first_project.customers2
21:09:09.804672 [debug] [Thread-10 ]: finished collecting timing info
21:09:09.809525 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers2"
21:09:09.809881 [debug] [Thread-10 ]: Began executing node model.first_project.customers
21:09:09.811650 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.customers"
21:09:09.811953 [debug] [Thread-8  ]: finished collecting timing info
21:09:09.812106 [debug] [Thread-8  ]: Began executing node model.first_project.customers2
21:09:09.813670 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers2"
21:09:09.813990 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
21:09:09.814154 [debug] [Thread-8  ]: On model.first_project.customers2: BEGIN
21:09:09.814250 [debug] [Thread-8  ]: Opening a new connection, currently in state init
21:09:09.816607 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
21:09:09.821072 [debug] [Thread-10 ]: On model.first_project.customers: BEGIN
21:09:09.821224 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
21:09:09.821392 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
21:09:09.821446 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
21:09:09.822424 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
21:09:09.824015 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
21:09:09.824118 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
21:09:09.821311 [debug] [Thread-10 ]: Opening a new connection, currently in state init
21:09:09.824717 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
21:09:09.825606 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
21:09:09.825698 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
21:09:09.825759 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
21:09:09.825986 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
21:09:09.826103 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
21:09:09.826185 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    
with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
 numero_pedidos as order_id,
 codigo_cliente as customer_id,
 data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
 customer_id,
 min(order_date) as first_order_date,
 max(order_date) as most_recent_order_date,
 count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
 select
 customers.customer_id,
 customers.first_name,
 customers.last_name,
 customer_orders.first_order_date,
 customer_orders.most_recent_order_date,
 coalesce(customer_orders.number_of_orders, 0) as number_of_orders
 from customers
 left join customer_orders using (customer_id)
)
select * from final
  );
21:09:09.827663 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
21:09:09.829090 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
21:09:09.829217 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
21:09:09.829391 [debug] [Thread-8  ]: SQL status: SELECT 100 in 0.0 seconds
21:09:09.830974 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
21:09:09.831172 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
21:09:09.831284 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
21:09:09.832514 [debug] [Thread-6  ]: finished collecting timing info
21:09:09.833143 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
21:09:09.833374 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
21:09:09.834821 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
21:09:09.835067 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
21:09:09.835402 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61cea421-6c20-4b33-b07d-bfd82698d68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f336ec10>]}
21:09:09.835539 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
21:09:09.836337 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
21:09:09.837397 [debug] [Thread-8  ]: On model.first_project.customers2: COMMIT
21:09:09.837599 [debug] [Thread-10 ]: SQL status: BEGIN in 0.02 seconds
21:09:09.838224 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
21:09:09.838095 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
21:09:09.838313 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    



with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
   select
     customer_id,
     min(order_date) as first_order_date,
     max(order_date) as most_recent_order_date,
     count(order_id) as number_of_orders
   from orders
   group by 1
),
final as (
   select
     customers.customer_id,
     
     customers.first_name,
     
     customers.last_name,
     
     customer_orders.first_order_date,
     customer_orders.most_recent_order_date,
     coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
     customers.state
   from customers
     left join customer_orders using (customer_id)
     WHERE customers.customer_id != 63
)
select * from final
  );
21:09:09.837934 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
21:09:09.838401 [debug] [Thread-8  ]: On model.first_project.customers2: COMMIT
21:09:09.839792 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
21:09:09.840973 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
21:09:09.841056 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
21:09:09.842109 [debug] [Thread-10 ]: SQL status: SELECT 98 in 0.0 seconds
21:09:09.842216 [debug] [Thread-8  ]: SQL status: DROP TABLE in 0.0 seconds
21:09:09.845575 [debug] [Thread-8  ]: finished collecting timing info
21:09:09.845697 [debug] [Thread-8  ]: On model.first_project.customers2: Close
21:09:09.852709 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61cea421-6c20-4b33-b07d-bfd82698d68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f3445100>]}
21:09:09.853212 [info ] [Thread-8  ]: 6 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.05s]
21:09:09.844819 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
21:09:09.853434 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
21:09:09.853746 [debug] [Thread-8  ]: Finished running node model.first_project.customers2
21:09:09.854038 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
21:09:09.855614 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
21:09:09.855729 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
21:09:09.856222 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
21:09:09.857299 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
21:09:09.857393 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
21:09:09.857455 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
21:09:09.858159 [debug] [Thread-10 ]: SQL status: COMMIT in 0.0 seconds
21:09:09.859073 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
21:09:09.859160 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
21:09:09.860044 [debug] [Thread-10 ]: SQL status: DROP TABLE in 0.0 seconds
21:09:09.860696 [debug] [Thread-10 ]: finished collecting timing info
21:09:09.860800 [debug] [Thread-10 ]: On model.first_project.customers: Close
21:09:09.861081 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61cea421-6c20-4b33-b07d-bfd82698d68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f01823d0>]}
21:09:09.861289 [info ] [Thread-10 ]: 7 of 7 OK created table model public.customers ................................. [[32mSELECT 98[0m in 0.06s]
21:09:09.861528 [debug] [Thread-10 ]: Finished running node model.first_project.customers
21:09:09.862685 [debug] [MainThread]: Acquiring new postgres connection "master"
21:09:09.862813 [debug] [MainThread]: Using postgres connection "master"
21:09:09.862877 [debug] [MainThread]: On master: BEGIN
21:09:09.862933 [debug] [MainThread]: Opening a new connection, currently in state closed
21:09:09.866813 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:09:09.867019 [debug] [MainThread]: On master: COMMIT
21:09:09.867089 [debug] [MainThread]: Using postgres connection "master"
21:09:09.867148 [debug] [MainThread]: On master: COMMIT
21:09:09.867286 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
21:09:09.867386 [debug] [MainThread]: On master: Close
21:09:09.867745 [info ] [MainThread]: 
21:09:09.867927 [info ] [MainThread]: Finished running 5 table models, 2 view models in 0.24s.
21:09:09.868037 [debug] [MainThread]: Connection 'master' was properly closed.
21:09:09.868093 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
21:09:09.868143 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
21:09:09.868191 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
21:09:09.868238 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
21:09:09.868285 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
21:09:09.868333 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
21:09:09.868381 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
21:09:09.871431 [info ] [MainThread]: 
21:09:09.871588 [info ] [MainThread]: [32mCompleted successfully[0m
21:09:09.871736 [info ] [MainThread]: 
21:09:09.871834 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
21:09:09.871995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f33ba550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f33823d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f33713a0>]}


============================== 2022-06-10 21:09:16.195975 | 5a859cc6-77d5-4b0d-bf24-94d48862049b ==============================
21:09:16.195987 [info ] [MainThread]: Running with dbt=1.1.0
21:09:16.196291 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
21:09:16.196372 [debug] [MainThread]: Tracking: tracking
21:09:16.198513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d42537f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d4253a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d4253f70>]}
21:09:16.215388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:09:16.215563 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:09:16.219913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a859cc6-77d5-4b0d-bf24-94d48862049b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d41110d0>]}
21:09:16.223903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a859cc6-77d5-4b0d-bf24-94d48862049b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d4185f10>]}
21:09:16.224188 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
21:09:16.224334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a859cc6-77d5-4b0d-bf24-94d48862049b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d4164070>]}
21:09:16.225719 [info ] [MainThread]: 
21:09:16.226083 [debug] [MainThread]: Acquiring new postgres connection "master"
21:09:16.226871 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
21:09:16.234267 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
21:09:16.234402 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
21:09:16.234472 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:09:16.242415 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
21:09:16.242602 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
21:09:16.242668 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
21:09:16.243937 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
21:09:16.245048 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
21:09:16.245394 [debug] [ThreadPool]: On list_erp_oltp_public: Close
21:09:16.248206 [debug] [MainThread]: Using postgres connection "master"
21:09:16.248309 [debug] [MainThread]: On master: BEGIN
21:09:16.248371 [debug] [MainThread]: Opening a new connection, currently in state init
21:09:16.252413 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
21:09:16.252649 [debug] [MainThread]: Using postgres connection "master"
21:09:16.252809 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
21:09:16.271888 [debug] [MainThread]: SQL status: SELECT 2 in 0.02 seconds
21:09:16.273010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a859cc6-77d5-4b0d-bf24-94d48862049b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d4185ca0>]}
21:09:16.273249 [debug] [MainThread]: On master: ROLLBACK
21:09:16.273550 [debug] [MainThread]: On master: Close
21:09:16.273916 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
21:09:16.274084 [info ] [MainThread]: 
21:09:16.278569 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
21:09:16.278818 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
21:09:16.278908 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
21:09:16.278992 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
21:09:16.280508 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
21:09:16.280780 [debug] [Thread-1  ]: finished collecting timing info
21:09:16.280959 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
21:09:16.281075 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
21:09:16.281709 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
21:09:16.281794 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
21:09:16.281861 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
21:09:16.281500 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
21:09:16.282887 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
21:09:16.283261 [debug] [Thread-3  ]: finished collecting timing info
21:09:16.283350 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
21:09:16.283427 [debug] [Thread-3  ]: finished collecting timing info
21:09:16.283025 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
21:09:16.283630 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
21:09:16.281226 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
21:09:16.283928 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
21:09:16.284008 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
21:09:16.283724 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
21:09:16.284130 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
21:09:16.316854 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
21:09:16.316960 [debug] [Thread-5  ]: finished collecting timing info
21:09:16.315661 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
21:09:16.315965 [debug] [Thread-7  ]: Began running node model.first_project.customers2
21:09:16.317698 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers2"
21:09:16.317924 [debug] [Thread-7  ]: Began compiling node model.first_project.customers2
21:09:16.318359 [debug] [Thread-7  ]: Compiling model.first_project.customers2
21:09:16.320160 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers2"
21:09:16.281164 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
21:09:16.318172 [debug] [Thread-2  ]: finished collecting timing info
21:09:16.317059 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
21:09:16.321003 [debug] [Thread-5  ]: finished collecting timing info
21:09:16.321274 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
21:09:16.320746 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
21:09:16.320876 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
21:09:16.321387 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
21:09:16.321642 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
21:09:16.322363 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
21:09:16.321545 [debug] [Thread-2  ]: finished collecting timing info
21:09:16.281294 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
21:09:16.322941 [debug] [Thread-1  ]: finished collecting timing info
21:09:16.322695 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
21:09:16.322837 [debug] [Thread-4  ]: finished collecting timing info
21:09:16.323311 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
21:09:16.323382 [debug] [Thread-4  ]: finished collecting timing info
21:09:16.323562 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
21:09:16.323156 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
21:09:16.320466 [debug] [Thread-7  ]: finished collecting timing info
21:09:16.323679 [debug] [Thread-7  ]: Began executing node model.first_project.customers2
21:09:16.323745 [debug] [Thread-7  ]: finished collecting timing info
21:09:16.323910 [debug] [Thread-7  ]: Finished running node model.first_project.customers2
21:09:16.324333 [debug] [Thread-9  ]: Began running node model.first_project.customers
21:09:16.324494 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers"
21:09:16.324568 [debug] [Thread-9  ]: Began compiling node model.first_project.customers
21:09:16.324626 [debug] [Thread-9  ]: Compiling model.first_project.customers
21:09:16.326518 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers"
21:09:16.326662 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
21:09:16.326784 [debug] [Thread-6  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
21:09:16.327260 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
21:09:16.327057 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
21:09:16.326873 [debug] [Thread-3  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
21:09:16.327717 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
21:09:16.327458 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
21:09:16.327560 [debug] [Thread-9  ]: finished collecting timing info
21:09:16.327978 [debug] [Thread-9  ]: Began executing node model.first_project.customers
21:09:16.327342 [debug] [Thread-6  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
21:09:16.327872 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
21:09:16.327790 [debug] [Thread-3  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
21:09:16.329440 [debug] [Thread-3  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
21:09:16.328093 [debug] [Thread-9  ]: finished collecting timing info
21:09:16.335902 [debug] [Thread-9  ]: Finished running node model.first_project.customers
21:09:16.329285 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
21:09:16.334964 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
21:09:16.328166 [debug] [Thread-6  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
21:09:16.341257 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
21:09:16.341560 [debug] [Thread-5  ]: Began running node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
21:09:16.341693 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
21:09:16.341884 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a"
21:09:16.342822 [debug] [Thread-5  ]: Began compiling node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
21:09:16.342916 [debug] [Thread-5  ]: Compiling test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
21:09:16.342158 [debug] [Thread-10 ]: finished collecting timing info
21:09:16.342372 [debug] [Thread-6  ]: finished collecting timing info
21:09:16.342489 [debug] [Thread-3  ]: finished collecting timing info
21:09:16.351266 [debug] [Thread-3  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
21:09:16.341985 [debug] [Thread-4  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
21:09:16.342043 [debug] [Thread-1  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
21:09:16.348270 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
21:09:16.348467 [debug] [Thread-6  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
21:09:16.352104 [debug] [Thread-6  ]: finished collecting timing info
21:09:16.351615 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
21:09:16.352463 [debug] [Thread-4  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
21:09:16.352542 [debug] [Thread-4  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
21:09:16.351843 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
21:09:16.351974 [debug] [Thread-10 ]: finished collecting timing info
21:09:16.352353 [debug] [Thread-6  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
21:09:16.351004 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a"
21:09:16.351394 [debug] [Thread-3  ]: finished collecting timing info
21:09:16.359356 [debug] [Thread-3  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
21:09:16.342712 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
21:09:16.358255 [debug] [Thread-1  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
21:09:16.358787 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
21:09:16.358023 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
21:09:16.359640 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
21:09:16.359747 [debug] [Thread-1  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
21:09:16.360116 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
21:09:16.364047 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
21:09:16.360428 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
21:09:16.363681 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
21:09:16.360315 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
21:09:16.364182 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
21:09:16.367062 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
21:09:16.364470 [debug] [Thread-4  ]: finished collecting timing info
21:09:16.369438 [debug] [Thread-4  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
21:09:16.366952 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
21:09:16.369780 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
21:09:16.367195 [debug] [Thread-1  ]: finished collecting timing info
21:09:16.369261 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
21:09:16.369591 [debug] [Thread-4  ]: finished collecting timing info
21:09:16.370301 [debug] [Thread-4  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
21:09:16.369882 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
21:09:16.372221 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
21:09:16.369969 [debug] [Thread-1  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
21:09:16.372416 [debug] [Thread-1  ]: finished collecting timing info
21:09:16.370477 [debug] [Thread-8  ]: finished collecting timing info
21:09:16.372823 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
21:09:16.366645 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
21:09:16.372713 [debug] [Thread-1  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
21:09:16.372916 [debug] [Thread-8  ]: finished collecting timing info
21:09:16.373362 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
21:09:16.364308 [debug] [Thread-5  ]: finished collecting timing info
21:09:16.373608 [debug] [Thread-5  ]: Began executing node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
21:09:16.373446 [debug] [Thread-2  ]: finished collecting timing info
21:09:16.372974 [debug] [Thread-9  ]: finished collecting timing info
21:09:16.373875 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
21:09:16.373780 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
21:09:16.373950 [debug] [Thread-9  ]: finished collecting timing info
21:09:16.374247 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
21:09:16.374033 [debug] [Thread-2  ]: finished collecting timing info
21:09:16.373692 [debug] [Thread-5  ]: finished collecting timing info
21:09:16.374518 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
21:09:16.374737 [debug] [Thread-5  ]: Finished running node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
21:09:16.375624 [debug] [MainThread]: Connection 'master' was properly closed.
21:09:16.375706 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
21:09:16.375758 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
21:09:16.375805 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
21:09:16.375853 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a' was properly closed.
21:09:16.375900 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
21:09:16.375946 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
21:09:16.375992 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
21:09:16.376055 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
21:09:16.376101 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
21:09:16.376146 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
21:09:16.378891 [info ] [MainThread]: Done.
21:09:16.379154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d40740d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d4164070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d4111790>]}


============================== 2022-06-10 21:09:20.998639 | fe817ad0-be06-42d1-83fe-9f44c89d89d8 ==============================
21:09:20.998649 [info ] [MainThread]: Running with dbt=1.1.0
21:09:20.998970 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
21:09:20.999060 [debug] [MainThread]: Tracking: tracking
21:09:21.001380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02f0872760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02f0872df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02f0872fd0>]}
21:09:21.019205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:09:21.019433 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:09:21.026136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe817ad0-be06-42d1-83fe-9f44c89d89d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02f07290d0>]}
21:09:21.031269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe817ad0-be06-42d1-83fe-9f44c89d89d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02f079ee20>]}
21:09:21.031555 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
21:09:21.031722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe817ad0-be06-42d1-83fe-9f44c89d89d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02f077d040>]}
21:09:21.033109 [info ] [MainThread]: 
21:09:21.033430 [debug] [MainThread]: Acquiring new postgres connection "master"
21:09:21.034242 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
21:09:21.047214 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
21:09:21.047499 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
21:09:21.047576 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:09:21.051979 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
21:09:21.052131 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
21:09:21.052205 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
21:09:21.053888 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
21:09:21.055324 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
21:09:21.056032 [debug] [ThreadPool]: On list_erp_oltp_public: Close
21:09:21.061499 [debug] [MainThread]: Using postgres connection "master"
21:09:21.061657 [debug] [MainThread]: On master: BEGIN
21:09:21.061722 [debug] [MainThread]: Opening a new connection, currently in state init
21:09:21.072915 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
21:09:21.073149 [debug] [MainThread]: Using postgres connection "master"
21:09:21.073221 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
21:09:21.082720 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
21:09:21.083657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe817ad0-be06-42d1-83fe-9f44c89d89d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02f086d280>]}
21:09:21.083839 [debug] [MainThread]: On master: ROLLBACK
21:09:21.084105 [debug] [MainThread]: On master: Close
21:09:21.084502 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
21:09:21.084654 [info ] [MainThread]: 
21:09:21.097023 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
21:09:21.097537 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
21:09:21.097667 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
21:09:21.097753 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
21:09:21.099811 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
21:09:21.100115 [debug] [Thread-1  ]: finished collecting timing info
21:09:21.100246 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
21:09:21.100401 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
21:09:21.100883 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
21:09:21.100980 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
21:09:21.101064 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
21:09:21.100523 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
21:09:21.100464 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
21:09:21.100614 [debug] [Thread-1  ]: finished collecting timing info
21:09:21.127910 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
21:09:21.128305 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
21:09:21.129421 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
21:09:21.128741 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
21:09:21.129090 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
21:09:21.129593 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
21:09:21.130558 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
21:09:21.129744 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
21:09:21.131109 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
21:09:21.130735 [debug] [Thread-4  ]: finished collecting timing info
21:09:21.132264 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
21:09:21.129824 [debug] [Thread-2  ]: finished collecting timing info
21:09:21.131260 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
21:09:21.132747 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
21:09:21.132835 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
21:09:21.132898 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
21:09:21.134001 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
21:09:21.128405 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
21:09:21.132456 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
21:09:21.132022 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
21:09:21.132355 [debug] [Thread-4  ]: finished collecting timing info
21:09:21.134737 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
21:09:21.134230 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
21:09:21.134850 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
21:09:21.134404 [debug] [Thread-2  ]: finished collecting timing info
21:09:21.134917 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
21:09:21.136193 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
21:09:21.136303 [debug] [Thread-5  ]: finished collecting timing info
21:09:21.136396 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
21:09:21.135209 [debug] [Thread-3  ]: finished collecting timing info
21:09:21.136681 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
21:09:21.136479 [debug] [Thread-5  ]: finished collecting timing info
21:09:21.137041 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
21:09:21.135004 [debug] [Thread-7  ]: finished collecting timing info
21:09:21.137163 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
21:09:21.136798 [debug] [Thread-3  ]: finished collecting timing info
21:09:21.137498 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
21:09:21.137240 [debug] [Thread-7  ]: finished collecting timing info
21:09:21.137824 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
21:09:21.131389 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
21:09:21.135461 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
21:09:21.138025 [debug] [Thread-6  ]: Began running node model.first_project.customers
21:09:21.138757 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers"
21:09:21.138831 [debug] [Thread-6  ]: Began compiling node model.first_project.customers
21:09:21.138887 [debug] [Thread-6  ]: Compiling model.first_project.customers
21:09:21.138463 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
21:09:21.140955 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
21:09:21.141039 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
21:09:21.141099 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
21:09:21.138524 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
21:09:21.148052 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
21:09:21.148129 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
21:09:21.138101 [debug] [Thread-1  ]: Began running node model.first_project.customers2
21:09:21.148365 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers2"
21:09:21.148453 [debug] [Thread-1  ]: Began compiling node model.first_project.customers2
21:09:21.140771 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers"
21:09:21.148189 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
21:09:21.152094 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
21:09:21.148762 [debug] [Thread-6  ]: finished collecting timing info
21:09:21.152355 [debug] [Thread-6  ]: Began executing node model.first_project.customers
21:09:21.152469 [debug] [Thread-6  ]: finished collecting timing info
21:09:21.148519 [debug] [Thread-1  ]: Compiling model.first_project.customers2
21:09:21.147875 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
21:09:21.131455 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
21:09:21.154938 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
21:09:21.152810 [debug] [Thread-6  ]: Finished running node model.first_project.customers
21:09:21.153000 [debug] [Thread-5  ]: finished collecting timing info
21:09:21.155527 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
21:09:21.154710 [debug] [Thread-4  ]: finished collecting timing info
21:09:21.155029 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
21:09:21.138370 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
21:09:21.155434 [debug] [Thread-7  ]: Began running node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
21:09:21.156507 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a"
21:09:21.155631 [debug] [Thread-10 ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
21:09:21.155718 [debug] [Thread-3  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
21:09:21.155779 [debug] [Thread-2  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
21:09:21.155912 [debug] [Thread-5  ]: finished collecting timing info
21:09:21.156087 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
21:09:21.156205 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
21:09:21.156317 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
21:09:21.156607 [debug] [Thread-7  ]: Began compiling node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
21:09:21.159584 [debug] [Thread-7  ]: Compiling test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
21:09:21.156816 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
21:09:21.164942 [debug] [Thread-10 ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
21:09:21.156988 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
21:09:21.157379 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
21:09:21.157501 [debug] [Thread-4  ]: finished collecting timing info
21:09:21.159330 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
21:09:21.159482 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
21:09:21.154343 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers2"
21:09:21.170749 [debug] [Thread-1  ]: finished collecting timing info
21:09:21.170872 [debug] [Thread-1  ]: Began executing node model.first_project.customers2
21:09:21.165441 [debug] [Thread-3  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
21:09:21.167585 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a"
21:09:21.168023 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
21:09:21.170260 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
21:09:21.170524 [debug] [Thread-9  ]: finished collecting timing info
21:09:21.170950 [debug] [Thread-1  ]: finished collecting timing info
21:09:21.171703 [debug] [Thread-1  ]: Finished running node model.first_project.customers2
21:09:21.165142 [debug] [Thread-10 ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
21:09:21.171072 [debug] [Thread-3  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
21:09:21.171429 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
21:09:21.157157 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
21:09:21.178539 [debug] [Thread-2  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
21:09:21.178622 [debug] [Thread-2  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
21:09:21.178155 [debug] [Thread-9  ]: finished collecting timing info
21:09:21.180627 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
21:09:21.178285 [debug] [Thread-7  ]: finished collecting timing info
21:09:21.173497 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
21:09:21.180772 [debug] [Thread-7  ]: Began executing node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
21:09:21.177943 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
21:09:21.178386 [debug] [Thread-8  ]: finished collecting timing info
21:09:21.180274 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
21:09:21.181112 [debug] [Thread-10 ]: finished collecting timing info
21:09:21.181914 [debug] [Thread-10 ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
21:09:21.181984 [debug] [Thread-10 ]: finished collecting timing info
21:09:21.181636 [debug] [Thread-3  ]: finished collecting timing info
21:09:21.181812 [debug] [Thread-2  ]: finished collecting timing info
21:09:21.182445 [debug] [Thread-2  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
21:09:21.182517 [debug] [Thread-2  ]: finished collecting timing info
21:09:21.182687 [debug] [Thread-2  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
21:09:21.182335 [debug] [Thread-3  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
21:09:21.182160 [debug] [Thread-10 ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
21:09:21.181451 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
21:09:21.183017 [debug] [Thread-8  ]: finished collecting timing info
21:09:21.182860 [debug] [Thread-3  ]: finished collecting timing info
21:09:21.183195 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
21:09:21.181233 [debug] [Thread-7  ]: finished collecting timing info
21:09:21.183420 [debug] [Thread-3  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
21:09:21.183690 [debug] [Thread-7  ]: Finished running node test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a
21:09:21.184626 [debug] [MainThread]: Connection 'master' was properly closed.
21:09:21.184734 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
21:09:21.184791 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
21:09:21.184837 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
21:09:21.184884 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
21:09:21.184929 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__SP__GO__AL__PA__RO__MT__RS__SC__PR__BA__RJ__DF.9931d6943a' was properly closed.
21:09:21.184973 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
21:09:21.185018 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
21:09:21.185062 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
21:09:21.185106 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
21:09:21.185151 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
21:09:21.187888 [info ] [MainThread]: Done.
21:09:21.189451 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
21:09:21.189578 [info ] [MainThread]: Building catalog
21:09:21.192114 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
21:09:21.196243 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
21:09:21.196739 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
21:09:21.196866 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:09:21.201619 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
21:09:21.201815 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
21:09:21.201904 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
21:09:21.204190 [debug] [ThreadPool]: SQL status: SELECT 77 in 0.0 seconds
21:09:21.209637 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
21:09:21.209817 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
21:09:21.218570 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/dbt_first_project/target/catalog.json
21:09:21.218936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02f2073fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02f2073ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02f2073520>]}
21:09:21.827259 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
21:09:21.828218 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 21:09:26.820863 | 73ab4fc2-5f29-4423-b59e-bf9e41d5041b ==============================
21:09:26.820874 [info ] [MainThread]: Running with dbt=1.1.0
21:09:26.821291 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
21:09:26.821377 [debug] [MainThread]: Tracking: tracking
21:09:26.823870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb654465940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb654465e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb654465700>]}
21:09:26.825498 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
21:09:26.825723 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
21:09:26.825834 [info ] [MainThread]: 
21:09:26.825933 [info ] [MainThread]: 
21:09:26.826406 [info ] [MainThread]: Press Ctrl+C to exit.
